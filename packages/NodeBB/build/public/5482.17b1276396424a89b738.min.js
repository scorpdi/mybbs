/*! For license information please see 5482.17b1276396424a89b738.min.js.LICENSE.txt */
(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5482,2735,882,3034],{45482:(e,t,n)=>{"use strict";var i,o;i=[n(83713),n(38259),n(62023),n(10577)],void 0===(o=function(e,t,i,o){var a={},s={picture:function(){this.find("#files").click()},upload:function(){this.find("#files").click()},thumbs:function(){a.exitFullscreen();var e=this;Promise.all([n.e(4074),n.e(2143),n.e(1521),n.e(7913)]).then((function(){var t=[n(44541)];(function(t){const n=e.get(0).getAttribute("data-uuid"),o=t.posts[n];("topics.post"===o.action||"posts.edit"===o.action&&o.isMain)&&i.modal.open({id:n,pid:o.pid}).then((()=>{e.trigger("thumb.uploaded"),t.updateThumbCount(n,e)}))}).apply(null,t)})).catch(n.oe)},tags:function(){this.find(".tags-container").toggleClass("hidden")},zen:function(){var e=this;$(window).one("resize",(function(){o.isFullscreen&&(app.toggleNavbar(!1),$("html").addClass("zen-mode"),e.find(".write").focus(),$(window).on("resize",(function n(){o.isFullscreen||(app.toggleNavbar(!0),$("html").removeClass("zen-mode"),t.reposition(e),$(window).off("resize",n))})),$(window).one("action:composer.topics.post action:composer.posts.reply action:composer.posts.edit action:composer.discard",o.exit))})),o.toggle(e.get(0)),$(window).trigger("action:composer.fullscreen",{postContainer:e})}},r=[];return a.exitFullscreen=function(){o.isEnabled&&o.isFullscreen&&o.exit()},a.addComposerButtons=function(){for(var e=0,t=r.length;e<t;e++)$(".formatting-bar .formatting-group #fileForm").before('<li tabindex="-1" data-format="'+r[e].name+'" title="'+(r[e].title||"")+'"><i class="'+r[e].iconClass+'"></i></li>')},a.addButton=function(e,t,n,i){i=i||e.replace("fa fa-",""),s[i]=t,r.push({name:i,iconClass:e,title:n})},a.getDispatchTable=function(){return s},a.addButtonDispatch=function(e,t){s[e]=t},a.addHandler=function(t){t.on("click",".formatting-bar li",(function(n){var i=$(this).attr("data-format"),o=$(this).parents('[component="composer"]').find("textarea")[0];s.hasOwnProperty(i)&&(s[i].call(t,o,o.selectionStart,o.selectionEnd,n),e.render(t))}))},a}.apply(t,i))||(e.exports=o)},83713:(e,t,n)=>{"use strict";var i,o;i=[n(85233)],void 0===(o=function(e){var t={render:function(t,n){if(n=n||function(){},!t.find(".preview-container").is(":visible"))return n();var i=t.find("textarea");socket.emit("plugins.composer.renderPreview",i.val(),(function(i,o){i||((o=$("<div>"+o+"</div>")).find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(o),e.fire("action:composer.preview"),n())}))},matchScroll:function(e){if(e.find(".preview-container").is(":visible")){var t=e.find("textarea"),n=e.find(".preview");if(t.length&&n.length){var i=t[0].scrollHeight-t.height();if(0===i)return;var o=t.scrollTop()/i;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*o)}}},handleToggler:function(e){t.env=utils.findBootstrapEnvironment();var n=e.find(".write-container .toggle-preview"),i=e.find(".preview-container .toggle-preview"),o=$(".preview-container"),a=$(".write-container");function s(){l(!1),"xs"!==t.env&&"sm"!==t.env&&localStorage.setItem("composer:previewToggled",!0)}function r(){l(!0),"xs"!==t.env&&"sm"!==t.env&&localStorage.removeItem("composer:previewToggled")}function l(i){"xs"===t.env||"sm"===t.env?(o.toggleClass("hide",!1),a.toggleClass("maximized",!1),n.toggleClass("hide",!0),o.toggleClass("hidden-xs hidden-sm",!i),a.toggleClass("hidden-xs hidden-sm",i),i&&t.render(e)):(o.toggleClass("hide",!i),a.toggleClass("maximized",!i),n.toggleClass("hide",i)),t.matchScroll(e)}t.toggle=l,i.on("click",(function(){s(),e.find(".write").focus()})),n.on("click",(function(){r(),e.find(".write").focus()})),localStorage.getItem("composer:previewToggled")||"xs"===t.env||"sm"===t.env?s():r()}};return t}.apply(t,i))||(e.exports=o)},38259:(e,t,n)=>{"use strict";var i,o;i=[n(27145)],void 0===(o=function(e){var t={},n=0,i=$("body"),o=$(window),a=$('[component="navbar"]'),s=document.body,r=a[0];function l(){var e;e=r?r.getBoundingClientRect():{bottom:0};var t=Math.max(e.bottom,0),n={top:0,left:0,right:window.innerWidth,bottom:window.innerHeight};return n.width=n.right,n.height=n.bottom,n.boundedTop=t,n.boundedHeight=n.bottom-t,n}function c(t,n){var i=l(),o=t[0],a=window.getComputedStyle(o),r=parseInt(a.getPropertyValue("min-height"),10),c=Math.max(r/window.innerHeight,.3);if(i.width>=992){const e=(i.height-i.boundedHeight)/i.height;var u=(n=Math.min(Math.max(n,c+e),1))*i.boundedHeight/i.height;o.style.top=(100*(1-u)).toString()+"%";var d=o.getBoundingClientRect();s.style.paddingBottom=(d.bottom-d.top).toString()+"px"}else t.removeAttr("style"),s.style.paddingBottom=0;t.ratio=n,o.style.visibility="visible",e.updateActive(t.attr("data-uuid"))}var u=c,d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return d&&(u=function(e,t){d((function(){c(e,t),setTimeout((function(){o.trigger("action:composer.resize"),e.trigger("action:composer.resize")}),0)}))}),t.reposition=function(e){var t=localStorage.getItem("composer:resizeRatio")||.5;t>=.95&&(t=1,e.addClass("maximized")),u(e,t)},t.maximize=function(e,n){n?u(e,1):t.reposition(e)},t.handleResize=function(e){var t=0,a=0,s=0,r=e.find(".resizer"),c=r[0];function d(e){var n=c.getBoundingClientRect(),s=(n.top+n.bottom)/2;t=(s-e.clientY)/2,a=e.clientY,o.on("mousemove",f),o.on("mouseup",m),i.on("touchmove",g)}function f(n){var i=n.clientY-t,o=l(),a=(o.height-i)/o.boundedHeight;u(e,a)}function m(r){r.preventDefault(),s=r.clientY,e.find("textarea").focus(),o.off("mousemove",f),o.off("mouseup",m),i.off("touchmove",g);var c=s-t,d=l(),p=(d.height-c)/d.boundedHeight;s-a==0&&e.hasClass("maximized")?(e.removeClass("maximized"),u(e,p=!n||n>=.95?.5:n)):s-a==0||p>=.95?(u(e,1),e.addClass("maximized"),n=p):e.removeClass("maximized"),function(e){localStorage.setItem("composer:resizeRatio",Math.min(e,1))}(p)}function g(e){e.preventDefault(),f(e.touches[0])}r.on("mousedown",(function(e){e.preventDefault(),d(e)})).on("touchstart",(function(e){e.preventDefault(),d(e.touches[0])})).on("touchend",m)},t}.apply(t,i))||(e.exports=o)},27145:(e,t,n)=>{"use strict";var i,o;e=n.nmd(e),i=[n(59006),n(32230),n(85233)],o=function(t,n,i){const o={};function a(){o.tasklist.find("li").length>0?o.taskbar.attr("data-active","1"):o.taskbar.removeAttr("data-active")}function s(){o.tasklist.find(".active").removeClass("active")}return o.init=function(){const e=this;t.render("modules/taskbar",{}).then((function(t){e.taskbar=$(t),e.tasklist=e.taskbar.find("ul"),$(document.body).append(e.taskbar),e.taskbar.on("click","li",(async function(){const e=$(this),t=e.attr("data-module"),n=e.attr("data-uuid"),i=await app.require(t);return e.hasClass("active")?i.minimize(n):(s(),i.load(n),o.toggleNew(n,!1),o.tasklist.removeClass("active"),e.addClass("active")),!1}))})),$(window).on("action:app.loggedOut",(function(){o.closeAll()}))},o.close=async function(t,n){let i="close";if("chat"===t&&(i="closeByUUID"),o.tasklist.find('[data-module="'+e+'"][data-uuid="'+n+'"]').length){const e=await app.require(t);e&&"function"==typeof e[i]&&e[i](n)}},o.closeAll=function(e){let t="[data-uuid]";e&&(t='[data-module="'+e+'"]'+t),o.tasklist.find(t).each((function(t,n){o.close(e||n.getAttribute("data-module"),n.getAttribute("data-uuid"))}))},o.discard=function(e,t){o.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').remove(),a()},o.push=function(e,t,r,l){l=l||function(){};const c=o.tasklist.find('li[data-uuid="'+t+'"]'),u={module:e,uuid:t,options:r,element:c};i.fire("filter:taskbar.push",u),!c.length&&u.module?function(e,t){n.translate(e.options.title,(function(n){const r=$("<div></div>").text(n||"NodeBB Task").html(),l=$("<li></li>").addClass(e.options.className).html('<a href="#"'+(e.options.image?" style=\"background-image: url('"+e.options.image.replace(/&#x2F;/g,"/")+"'); background-size: cover;\"":"")+">"+(e.options.icon?'<i class="fa '+e.options.icon+'"></i> ':"")+'<span aria-label="'+r+'" component="taskbar/title">'+r+"</span></a>").attr({title:r,"data-module":e.module,"data-uuid":e.uuid}).addClass(void 0!==e.options.state?e.options.state:"active");e.options.state&&"active"!==e.options.state||s(),o.tasklist.append(l),a(),e.element=l,l.data(e),i.fire("action:taskbar.pushed",e),t(l)}))}(u,l):l(c)},o.get=function(e){return $('[data-module="'+e+'"]').map((function(e,t){return $(t).data()}))},o.minimize=function(e,t){o.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]').toggleClass("active",!1)},o.toggleNew=function(e,t,n){o.tasklist.find('[data-uuid="'+e+'"]').toggleClass("new",t),n||i.fire("action:taskbar.toggleNew",e)},o.updateActive=function(e){const t=o.tasklist.find("li");t.removeClass("active"),t.filter('[data-uuid="'+e+'"]').addClass("active"),$("[data-uuid]:not([data-module])").toggleClass("modal-unfocused",!0),$('[data-uuid="'+e+'"]:not([data-module])').toggleClass("modal-unfocused",!1)},o.isActive=function(e){return o.tasklist.find('li[data-uuid="'+e+'"]').hasClass("active")},o.update=function(e,t,n){const i=o.tasklist.find('[data-module="'+e+'"][data-uuid="'+t+'"]');if(!i.length)return;const a=i.data();Object.keys(n).forEach((function(e){a[e]=n[e],function(e,t,n){switch(t){case"title":e.find('[component="taskbar/title"]').text(n);break;case"icon":e.find("i").attr("class","fa fa-"+n);break;case"image":e.find("a").css("background-image",n?'url("'+n.replace(/&#x2F;/g,"/")+'")':"");break;case"background-color":e.find("a").css("background-color",n)}}(i,e,n[e])})),i.data(a)},o}.apply(t,i),void 0===o||(e.exports=o)},10577:e=>{!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,i=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,o=n.length,a={};i<o;i++)if((e=n[i])&&e[1]in t){for(i=0;i<e.length;i++)a[n[0][i]]=e[i];return a}return!1}(),o={change:i.fullscreenchange,error:i.fullscreenerror},a={request:function(e,n){return new Promise(function(o,a){var s=function(){this.off("change",s),o()}.bind(this);this.on("change",s);var r=(e=e||t.documentElement)[i.requestFullscreen](n);r instanceof Promise&&r.then(s).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var o=function(){this.off("change",o),e()}.bind(this);this.on("change",o);var a=t[i.exitFullscreen]();a instanceof Promise&&a.then(o).catch(n)}else e()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var i=o[e];i&&t.addEventListener(i,n,!1)},off:function(e,n){var i=o[e];i&&t.removeEventListener(i,n,!1)},raw:i};i?(Object.defineProperties(a,{isFullscreen:{get:function(){return Boolean(t[i.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[i.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[i.fullscreenEnabled])}}}),n?e.exports=a:window.screenfull=a):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()}}]);