"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9764,3564],{99764:(e,t,a)=>{var n,s;n=[a(50431),a(42441),a(85233),a(7927)],void 0===(s=function(e,t,a,n){const s={populateTOC:function(){const e=$(".settings-header");if(e.length>1){e.each((function(){const e=$(this).text(),t=e.toLowerCase().replace(/ /g,"-").trim();$(this).prepend('<a name="'+t+'"></a>'),$(".section-content ul").append('<li><a href="#'+t+'">'+e+"</a></li>")}));const t=$('a[name="'+window.location.hash.replace("#","")+'"]');t.length&&$("html, body").animate({scrollTop:t.offset().top+"px"},400)}else $(".content-header").parents(".row").remove()},prepare:function(s){const i=$("#content [data-field]"),o=i.length,r=$("#save"),c=$("#revert");let l,d,p,u;i.on("change",(function(){app.flags=app.flags||{},app.flags._unsaved=!0}));const f=["text","hidden","password","textarea","number"];for(l=0;l<o;l+=1)if(u=i.eq(l),d=u.attr("data-field"),p=u.attr("type"),app.config.hasOwnProperty(d))if(u.is("input")&&"checkbox"===p){const e=1===parseInt(app.config[d],10);u.prop("checked",e),u.parents(".mdl-switch").toggleClass("is-checked",e)}else(u.is("textarea")||u.is("select")||u.is("input")&&-1!==f.indexOf(p))&&u.val(app.config[d]);c.off("click").on("click",(function(){ajaxify.refresh()})),r.off("click").on("click",(function(e){e.preventDefault(),function(e,t){const a={};e.each((function(){const e=$(this),t=e.attr("data-field");let n,s;if(e.is("input"))switch(s=e.attr("type"),s){case"text":case"password":case"hidden":case"textarea":case"number":n=e.val();break;case"checkbox":n=e.prop("checked")?"1":"0"}else(e.is("textarea")||e.is("select"))&&(n=e.val());a[t]=n})),socket.emit("admin.config.setMultiple",a,(function(e){if(e)return t(e);for(const e in a)a.hasOwnProperty(e)&&(app.config[e]=a[e]);t()}))}(i,(function(e){if(e)return n.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${e.message}]]`,type:"danger"});app.flags._unsaved=!1,n.alert({alert_id:"config_status",timeout:2500,title:"[[admin/admin:changes-saved]]",message:"[[admin/admin:changes-saved-message]]",type:"success"}),a.fire("action:admin.settingsSaved")}))})),t.bind("ctrl+s",(function(e){r.click(),e.preventDefault()})),$('#content input[data-action="upload"]').each((function(){const t=$(this);t.on("click",(function(){e.show({title:t.attr("data-title"),description:t.attr("data-description"),route:t.attr("data-route"),params:{},showHelp:t.attr("data-help")?1===t.attr("data-help"):void 0,accept:t.attr("data-accept")},(function(e){$("#"+t.attr("data-target")).val(e)}))}))})),$('[data-field-type="tagsinput"]').tagsinput({confirmKeys:[13,44],trimValue:!0}),app.flags._unsaved=!1,$("#clear-sitemap-cache").off("click").on("click",(function(){return socket.emit("admin.settings.clearSitemapCache",(function(){n.success("Sitemap Cache Cleared!")})),!1})),"function"==typeof s&&s(),setTimeout((function(){a.fire("action:admin.settingsLoaded")}),0)},remove:function(e){socket.emit("admin.config.remove",e)}};return s}.apply(t,n))||(e.exports=s)},50431:(e,t,a)=>{var n,s;n=[a(86569)],s=function(){const e={};function t(t,a,n){e.hideAlerts(t),"error"===a&&t.find("#fileUploadSubmitBtn").removeClass("disabled"),t.find("#alert-"+a).translateText(n).removeClass("hide")}function a(e){if("string"==typeof e)try{return $.parseJSON(e)}catch(e){return{error:"[[error:parse-error]]"}}return e}return e.show=function(a,n){const s=!(!a.hasOwnProperty("fileSize")||void 0===a.fileSize)&&parseInt(a.fileSize,10);app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:!a.hasOwnProperty("showHelp")||void 0===a.showHelp||a.showHelp,fileSize:s,title:a.title||"[[global:upload_file]]",description:a.description||"",button:a.button||"[[global:upload]]",accept:a.accept?a.accept.replace(/,/g,"&#44; "):""},(function(i){i.modal("show"),i.on("hidden.bs.modal",(function(){i.remove()}));const o=i.find("#uploadForm");o.attr("action",a.route),o.find("#params").val(JSON.stringify(a.params)),i.find("#fileUploadSubmitBtn").on("click",(function(){$(this).addClass("disabled"),o.submit()})),o.submit((function(){return function(a,n,s){t(a,"status","[[uploads:uploading-file]]"),a.find("#upload-progress-bar").css("width","0%"),a.find("#upload-progress-box").show().removeClass("hide");const i=a.find("#fileInput");return i.val()?(o=i[0],r=n,!window.FileReader||!r||o.files[0].size<=1e3*r?void e.ajaxSubmit(a,s):t(a,"error","[[error:file-too-big, "+n+"]]")):t(a,"error","[[uploads:select-file-to-upload]]");var o,r}(i,s,n),!1}))}))},e.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")},e.ajaxSubmit=function(n,s){n.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=a(e),t(n,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,t,a,s){n.find("#upload-progress-bar").css("width",s+"%")},success:function(i){let o=a(i);i.hasOwnProperty("response")&&i.hasOwnProperty("status")&&"ok"===i.status.code&&(o=i.response.images),s(o[0].url),t(n,"success","[[uploads:upload-success]]"),setTimeout((function(){e.hideAlerts(n),n.modal("hide")}),750)}})},e}.apply(t,n),void 0===s||(e.exports=s)}}]);