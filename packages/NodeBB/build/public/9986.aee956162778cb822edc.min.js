/*! For license information please see 9986.aee956162778cb822edc.min.js.LICENSE.txt */
(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9986,2344],{78989:(t,o,n)=>{"use strict";var e,i;e=[n(31369)],void 0===(i=function(t){const o={init:function(){$("body").on("click",'[component="pagination/select-page"]',(function(){return t.prompt("[[global:enter_page_number]]",(function(t){o.loadPage(t)})),!1}))},loadPage:function(t,o){if(o=o||function(){},t=parseInt(t,10),!utils.isNumber(t)||t<1||t>ajaxify.data.pagination.pageCount)return;const n=utils.params();n.page=t;const e=window.location.pathname+"?"+$.param(n);ajaxify.go(e,o)},nextPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage+1,t)},previousPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage-1,t)}};return o}.apply(o,e))||(t.exports=i)},42840:(t,o,n)=>{"use strict";var e,i;e=[n(78989),n(7237),n(85233),n(7927)],void 0===(i=function(t,o,n,e){const i={};let a,c,r,l,s,f=0,d=0,u=!1,p=!0;i.scrollActive=!1;let g,h,m,w,x,y=$(".pagination-block"),b=y.find(".pagination-text"),v=y.find("meter"),T=y.find(".progress-bar");$(window).on("action:ajaxify.start",(function(){$(window).off("keydown",B)})),i.init=function(t,o,e,a,d){f=0,i.selector=t,i.callback=d,i.toTop=e||function(){},i.toBottom=a||function(){},y=$(".pagination-block"),b=y.find(".pagination-text"),v=y.find("meter"),T=y.find(".progress-bar"),m=$(".scroller-thumb-icon"),w=m.height(),x=w/2,g=$(".scroller-thumb"),h=g.find(".thumb-text"),$(window).off("scroll",i.delayedUpdate).on("scroll",i.delayedUpdate),y.find(".dropdown-menu").off("click").on("click",(function(t){t.stopPropagation()})),y.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",(function(){setTimeout((async function(){"lg"===utils.findBootstrapEnvironment()&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&y.find("#myNextPostBtn").removeAttr("disabled")}),100)})),y.find(".pageup").off("click").on("click",i.scrollUp),y.find(".pagedown").off("click").on("click",i.scrollDown),y.find(".pagetop").off("click").on("click",i.toTop),y.find(".pagebottom").off("click").on("click",i.toBottom),y.find("#myNextPostBtn").off("click").on("click",P),y.find("input").on("keydown",(function(t){if(13===t.which){const t=$(this);if(!utils.isNumber(t.val()))return void t.val("");const o=M(parseInt(t.val(),10));t.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(o)}})),ajaxify.data.template.topic&&function(){if(!g.length)return;const t=g.parent();function o(o){const n=(C(o-x)-t.offset().top)/(t.height()-w);return f=Math.max(1,Math.ceil(ajaxify.data.postcount*n)),f>ajaxify.data.postcount?ajaxify.data.count:f}t.on("click",(function(t){if($(t.target).hasClass("scroller-container")){const n=o(t.pageY);return i.scrollToIndex(n-1,!0,0),!1}}));let e=!1;function a(){$(window).off("mousemove",d),e&&(i.scrollToIndex(f-1,!0,0),y.find('[data-toggle="dropdown"]').trigger("click")),j(),e=!1,p=!1}function d(t){const n=C(t.pageY-x);g.offset({top:n,left:g.offset().left});const e=o(t.pageY);return i.updateTextAndProgressBar(),h.text(e+"/"+ajaxify.data.postcount),p&&m(),p=!1,t.stopPropagation(),!1}function m(){j(),c=setInterval((function(){A(f)}),250)}n.on("action:ajaxify.end",(function(){s=null})),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",(function(){I(f)})),g.on("mousedown",(function(){e=!0,$(window).on("mousemove",d),p=!0})),$(window).off("mousemove",d),$(window).off("mouseup",a).on("mouseup",a),g.on("touchstart",(function(t){u=!0,r=Math.min($(window).width(),Math.max(0,t.touches[0].clientX)),l=Math.min($(window).height(),Math.max(0,t.touches[0].clientY)),p=!0})),g.on("touchmove",(function(t){const n=$(window).width(),e=$(window).height(),a=Math.abs(r-Math.min(n,Math.max(0,t.touches[0].clientX))),c=Math.abs(l-Math.min(e,Math.max(0,t.touches[0].clientY)));if(r=Math.min(n,Math.max(0,t.touches[0].clientX)),l=Math.min(e,Math.max(0,t.touches[0].clientY)),c>=a&&p&&(u=!0,m()),u&&t.cancelable){t.preventDefault(),t.stopPropagation();const n=C(l+$(window).scrollTop()-x);g.offset({top:n,left:g.offset().left});const e=o(l+$(window).scrollTop());i.updateTextAndProgressBar(),h.text(e+"/"+ajaxify.data.postcount),p&&A(e)}p=!1})),g.on("touchend",(function(){j(),u&&(i.scrollToIndex(f-1,!0,0),u=!1,y.find('[data-toggle="dropdown"]').trigger("click"))}))}(),config.usePagination||$(window).off("keydown",B).on("keydown",B),i.setCount(o),i.update(0)};let k=0;async function P(){async function t(t){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,t),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let o=await t(f);k===o&&(o=await t(o)),o&&f!==o+1?(k=o,$(window).one("action:ajaxify.end",(function(){y.find(".dropdown-menu").is(":hidden")&&y.find(".dropdown-toggle").dropdown("toggle")})),i.scrollToIndex(o,!0,0)):(e.alert({message:"[[topic:no-more-next-post]]",type:"info"}),k=1)}}function C(t){const o=g.parent(),n=o.offset();return t<n.top?t=n.top:t>n.top+o.height()-w&&(t=n.top+o.height()-w),t}function I(t){if(!g.length||g.is(":hidden"))return;const o=g.parent(),n=o.offset();let e=(t-1)/ajaxify.data.postcount;t===d&&(e=1);const i={top:C(n.top+(o.height()-w)*e),left:g.offset().left};g.offset(i),h.text(t+"/"+ajaxify.data.postcount),A(t)}function j(){c&&(clearInterval(c),c=0)}function A(t,o){o=o||function(){},s===t||y.find(".post-content").is(":hidden")||(s=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},(function(t,n){if(t)return e.error(t);app.parseAndTranslate("partials/topic/navigation-post",{post:n},(function(t){y.find(".post-content").html(t).find(".timeago").timeago()})),o()})))}function B(t){if("BODY"===t.target.nodeName){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(36===t.which&&i.toTop)return i.toTop(),!1;if(35===t.which&&i.toBottom)return i.toBottom(),!1}}function M(t){const o=window.location.pathname.replace(config.relative_path,"").split("/");return o[1]+"/"+o[2]+"/"+o[3]+(t?"/"+t:"")}function N(t){const o=ajaxify.removeRelativePath(window.location.pathname.slice(1));(!t||o.startsWith("topic")||o.startsWith("category"))&&y.toggleClass("ready",t)}return i.setCount=function(t){(t=parseInt(t,10))!==d&&(d=t,i.updateTextAndProgressBar())},i.show=function(){N(!0)},i.disable=function(){d=0,f=1,i.callback=null,i.selector=null,$(window).off("scroll",i.delayedUpdate),N(!1)},i.delayedUpdate=function(){a||(a=setTimeout((function(){i.update(),a=void 0}),100))},i.update=function(t){t="number"==typeof t?t:void 0;let n=f;const e=$(i.selector);e.length&&(n=parseInt(e.first().attr("data-index"),10)+1);const a=$(window).scrollTop(),c=$(window).height(),r=$(document).height(),l=a+c/2;let s=Number.MAX_VALUE;e.each((function(){const t=$(this),o=parseInt(t.attr("data-index"),10);if(o>=0){const e=Math.abs(l-(t.offset().top+t.outerHeight(!0)/2));if(e>s)return!1;e<s&&(n=o+1,s=e)}}));const u=0===a&&0===parseInt(e.first().attr("data-index"),10),p=a+c>r-100&&parseInt(e.last().attr("data-index"),10)===d-1;if(u?n=1:p&&(n=d),void 0===t&&ajaxify.data.template.topic)if(u)t=0;else{const n=o.get("post/anchor",f-1);n.length&&(t=n.get(0).getBoundingClientRect().top)}"function"==typeof i.callback&&i.callback(n,d,t),n!==f&&(f=n,i.updateTextAndProgressBar(),I(f)),N(!!d)},i.updateTextAndProgressBar=function(){if(!utils.isNumber(f))return;f=f>d?d:f,b.translateHtml("[[global:pagination.out_of, "+f+", "+d+"]]");const t=(f-1)/(d-1||1);v.val(t),T.width(100*t+"%")},i.scrollUp=function(){const o=$(window);if(config.usePagination&&o.scrollTop()<=0)return t.previousPage((function(){$("body,html").scrollTop($(document).height()-o.height())}));$("body,html").animate({scrollTop:o.scrollTop()-o.height()})},i.scrollDown=function(){const o=$(window);if(config.usePagination&&o.scrollTop()>=$(document).height()-o.height())return t.nextPage();$("body,html").animate({scrollTop:o.scrollTop()+o.height()})},i.scrollTop=function(t){$(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):ajaxify.go(M())},i.scrollBottom=function(t){parseInt(t,10)<0||($(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(M(t))))},i.scrollToIndex=function(n,e,a){const c=!!o.get("topic").length,r=!!o.get("category").length;if(!utils.isNumber(n)||!c&&!r)return;if(a=void 0!==a?a:400,i.scrollActive=!0,c&&o.get("post/anchor",n).length)return i.scrollToPostIndex(n,e,a);if(r&&$('[component="category/topic"][data-index="'+n+'"]').length)return i.scrollToTopicIndex(n,e,a);if(!config.usePagination)return i.scrollActive=!1,n=parseInt(n,10)+1,void ajaxify.go(M(n));const l=c?i.scrollToPostIndex:i.scrollToTopicIndex,s=1+Math.floor(n/config.postsPerPage);parseInt(s,10)!==ajaxify.data.pagination.currentPage?t.loadPage(s,(function(){l(n,e,a)})):l(n,e,a)},i.scrollToPostIndex=function(t,n,e){const a=o.get("post","index",t);i.scrollToElement(a,n,e)},i.scrollToTopicIndex=function(t,o,n){const e=$('[component="category/topic"][data-index="'+t+'"]');i.scrollToElement(e,o,n)},i.scrollToElement=function(t,n,e){if(!t.length)return void(i.scrollActive=!1);const a=t.outerHeight(!0),c=o.get("navbar").outerHeight(!0),r=$(".topic-header").outerHeight(!0)||0,l=$(window).height();$(window).off("scroll",i.delayedUpdate),e=void 0!==e?e:400,i.scrollActive=!0;let s=!1;!function(){function o(){$(window).on("scroll",i.delayedUpdate);const o=t.get(0).getBoundingClientRect();i.update(o.top)}function f(){s?o():(s=!0,i.scrollActive=!1,n&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout((function(){t.removeClass("highlight")}),1e4)),$("body").scrollTop($("body").scrollTop()-1),$("html").scrollTop($("html").scrollTop()-1))}let d=0;if(d=a<l-c-r?t.offset().top-l/2+a/2:t.offset().top-c-r,0===e)return $(window).scrollTop(d),f(),void o();$("html, body").animate({scrollTop:d+"px"},e,f)}()},i}.apply(o,e))||(t.exports=i)},69986:(t,o,n)=>{"use strict";var e,i;e=[n(32230),n(7237),n(42840),n(16943),n(85233),n(7927)],void 0===(i=function(t,o,n,e,i,a){const c={};let r={};function l(t,o,n){socket.emit("notifications.mark"+(o?"Read":"Unread"),t,(function(e){if(e)return a.error(e);o&&r[t]&&delete r[t],n&&n()}))}return i.on("filter:notifications.load",(({notifications:o})=>new Promise((n=>{t.toggleTimeagoShorthand((function(){for(let t=0;t<o.length;t+=1)o[t].timeago=$.timeago(new Date(parseInt(o[t].datetime,10)));t.toggleTimeagoShorthand(),n({notifications:o})}))})))),c.loadNotifications=function(t,e){e=e||function(){},socket.emit("notifications.get",null,(function(r,s){if(r)return a.error(r);const f=s.unread.concat(s.read).sort((function(t,o){return parseInt(t.datetime,10)>parseInt(o.datetime,10)?-1:1}));i.fire("filter:notifications.load",{notifications:f}).then((({notifications:a})=>{app.parseAndTranslate("partials/notifications_list",{notifications:a},(function(a){t.html(a),t.off("click").on("click","[data-nid]",(function(t){const e=$(this);(function(t){const e=t.attr("data-pid"),i=t.attr("data-path"),a=o.get("post","pid",e);return!!(i.startsWith(config.relative_path+"/post/")&&e&&a.length&&ajaxify.data.template.topic)&&(n.scrollToIndex(a.attr("data-index"),!0),!0)})(e)&&(t.stopPropagation(),t.preventDefault(),o.get("notifications/list").dropdown("toggle")),e.hasClass("unread")&&l(e.attr("data-nid"),!0)})),o.get("notifications").on("click",".mark-all-read",c.markAllRead),t.on("click",".mark-read",(function(){const t=$(this).parents("li"),o=t.hasClass("unread");return l(t.attr("data-nid"),o,(function(){t.toggleClass("unread")})),!1})),i.fire("action:notifications.loaded",{notifications:f,list:t}),e()}))}))}))},c.onNewNotification=function(t){"notifications"===ajaxify.currentPage&&ajaxify.refresh(),socket.emit("notifications.getCount",(function(t,o){if(t)return a.error(t);c.updateNotifCount(o)})),r[t.nid]||(r[t.nid]=!0)},c.updateNotifCount=function(t){const a=o.get("notifications/icon");(t=Math.max(0,t))>0?a.removeClass("fa-bell-o").addClass("fa-bell"):a.removeClass("fa-bell").addClass("fa-bell-o"),a.toggleClass("unread-count",t>0),a.attr("data-content",t>99?"99+":t);const c={count:t,updateFavicon:!0};i.fire("action:notification.updateCount",c),c.updateFavicon&&e.setBubble(t>99?"99+":t),n.setAppBadge&&n.setAppBadge(t)},c.markAllRead=function(){socket.emit("notifications.markAllRead",(function(t){t&&a.error(t),r={}}))},c}.apply(o,e))||(t.exports=i)},16943:(t,o,n)=>{var e,i,a,c,r,l,s,f,d,u,p,g,h,m,w,x,y,b,v,T,k,$,P,C,I;c={},r=null,l=null,s=null,f=null,d={},u=Math.ceil(window.devicePixelRatio)||1,p=16*u,g={width:7,height:9,font:10*u+"px arial",color:"#ffffff",background:"#F03D25",fallback:!0,crossOrigin:!0,abbreviate:!0},a=navigator.userAgent.toLowerCase(),m=(h=function(t){return-1!==a.indexOf(t)})("trident"),h("chrome"),w=h("chrome")||h("safari"),x=h("safari")&&!h("chrome"),y=h("mozilla")&&!h("chrome")&&!h("safari"),b=function(){if(!l||!r){var t=function(){for(var t=document.getElementsByTagName("link"),o=0,n=t.length;o<n;o++)if((t[o].getAttribute("rel")||"").match(/\bicon\b/i))return t[o];return!1}();r=t?t.getAttribute("href"):"/favicon.ico",l||(l=r)}return r},v=function(){return f||((f=document.createElement("canvas")).width=p,f.height=p),f},T=function(t){if(t){!function(){for(var t=document.getElementsByTagName("link"),o=0,n=t.length;o<n;o++)void 0!==t[o]&&(t[o].getAttribute("rel")||"").match(/\bicon\b/i)&&t[o].parentNode.removeChild(t[o])}();var o=document.createElement("link");o.type="image/x-icon",o.rel="icon",o.href=t,document.getElementsByTagName("head")[0].appendChild(o)}},k=function(t){if(d.fallback){var o=document.title;"("===o[0]&&(o=o.slice(o.indexOf(" "))),document.title=(t+"").length>0?"("+t+") "+o:o}},$=function(t,o,n){"number"==typeof o&&o>99&&d.abbreviate&&(o=C(o));var e=(o+"").length-1,i=d.width*u+6*u*e,a=d.height*u,c=p-a,r=p-i-u,l=16*u,s=16*u,f=2*u;t.font=(w?"bold ":"")+d.font,t.fillStyle=d.background,t.strokeStyle=d.background,t.lineWidth=u,t.beginPath(),t.moveTo(r+f,c),t.quadraticCurveTo(r,c,r,c+f),t.lineTo(r,l-f),t.quadraticCurveTo(r,l,r+f,l),t.lineTo(s-f,l),t.quadraticCurveTo(s,l,s,l-f),t.lineTo(s,c+f),t.quadraticCurveTo(s,c,s-f,c),t.closePath(),t.fill(),t.beginPath(),t.strokeStyle="rgba(0,0,0,0.3)",t.moveTo(r+f/2,l),t.lineTo(s-f/2,l),t.stroke(),t.fillStyle=d.color,t.textAlign="right",t.textBaseline="top",t.fillText(o,2===u?29:15,y?7*u:6*u)},P=function(){v().getContext&&T(v().toDataURL())},C=function(t){for(var o=[["G",1e9],["M",1e6],["k",1e3]],n=0;n<o.length;++n)if(t>=o[n][1]){t=I(t/o[n][1])+o[n][0];break}return t},I=function(t,o){return new Number(t).toFixed(o)},c.setOptions=function(t){for(var o in d={},t.colour&&(t.color=t.colour),g)d[o]=t.hasOwnProperty(o)?t[o]:g[o];return this},c.setImage=function(t){return r=t,P(),this},c.setBubble=function(t,o){return function(t,o){if(!v().getContext||m||x||"force"===d.fallback)return k(t);var n=v().getContext("2d"),e=(o=o||"#000000",b());(s=document.createElement("img")).onload=function(){n.clearRect(0,0,p,p),n.drawImage(s,0,0,s.width,s.height,0,0,p,p),(t+"").length>0&&$(n,t),P()},!e.match(/^data/)&&d.crossOrigin&&(s.crossOrigin="anonymous"),s.src=e}(t=t||"",o),this},c.reset=function(){r=l,T(l)},c.setOptions(g),void 0===(i="function"==typeof(e=c)?e.call(o,n,o,t):e)||(t.exports=i)}}]);