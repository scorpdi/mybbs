(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[5400,7986,2735,2160],{99398:(e,t,n)=>{"use strict";var i,o;i=[n(83713)],void 0===(o=function(e){return{insertIntoTextarea:function(t,n){var i={context:this,textarea:t,value:n,preventDefault:!1};if($(window).trigger("action:composer.insertIntoTextarea",i),!i.preventDefault){var o=$(i.textarea),r=o.val(),a=o.parents('[component="composer"]');o.val(r.slice(0,i.textarea.selectionStart)+i.value+r.slice(i.textarea.selectionStart)),e.render(a)}},wrapSelectionInTextareaWith:function(e,t,n){var i={context:this,textarea:e,leading:t,trailing:n,preventDefault:!1};if($(window).trigger("action:composer.wrapSelectionInTextareaWith",i),!i.preventDefault){void 0===n&&(n=t);var o=$(e),r=o.val(),a=/^(\s*)([\s\S]*?)(\s*)$/.exec(r.slice(e.selectionStart,e.selectionEnd));return a[2]||(a=[null,"",r.slice(e.selectionStart,e.selectionEnd),""]),o.val(r.slice(0,e.selectionStart)+a[1]+t+a[2]+n+a[3]+r.slice(e.selectionEnd)),[a[1].length,a[3].length]}},updateTextareaSelection:function(e,t,n){var i={context:this,textarea:e,start:t,end:n,preventDefault:!1};$(window).trigger("action:composer.updateTextareaSelection",i),i.preventDefault||(e.setSelectionRange(i.start,i.end),$(i.textarea).focus())},getBlockData:function(e,t,n){var i=e.value;t=t.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");var o,r,a=new RegExp(t,"g"),l=[];for(i=i.split("\n").reduce((function(e,t){return null!==e||null===(e=n<=t.length?t:null)&&(n-=t.length+1),e}),null);null!==(o=a.exec(i));)l.push(o.index);return(r={in:!!(l.reduce((function(e,t){return n>=t+2&&(e+=1),e}),0)%2),atEnd:l.reduce((function(e,t){return e||n===t}),!1)}).atEnd=!!r.in&&r.atEnd,r}}}.apply(t,i))||(e.exports=o)},83713:(e,t,n)=>{"use strict";var i,o;i=[n(85233)],void 0===(o=function(e){var t={render:function(t,n){if(n=n||function(){},!t.find(".preview-container").is(":visible"))return n();var i=t.find("textarea");socket.emit("plugins.composer.renderPreview",i.val(),(function(i,o){i||((o=$("<div>"+o+"</div>")).find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(o),e.fire("action:composer.preview"),n())}))},matchScroll:function(e){if(e.find(".preview-container").is(":visible")){var t=e.find("textarea"),n=e.find(".preview");if(t.length&&n.length){var i=t[0].scrollHeight-t.height();if(0===i)return;var o=t.scrollTop()/i;n.scrollTop(Math.max(n[0].scrollHeight-n.height(),0)*o)}}},handleToggler:function(e){t.env=utils.findBootstrapEnvironment();var n=e.find(".write-container .toggle-preview"),i=e.find(".preview-container .toggle-preview"),o=$(".preview-container"),r=$(".write-container");function a(){s(!1),"xs"!==t.env&&"sm"!==t.env&&localStorage.setItem("composer:previewToggled",!0)}function l(){s(!0),"xs"!==t.env&&"sm"!==t.env&&localStorage.removeItem("composer:previewToggled")}function s(i){"xs"===t.env||"sm"===t.env?(o.toggleClass("hide",!1),r.toggleClass("maximized",!1),n.toggleClass("hide",!0),o.toggleClass("hidden-xs hidden-sm",!i),r.toggleClass("hidden-xs hidden-sm",i),i&&t.render(e)):(o.toggleClass("hide",!i),r.toggleClass("maximized",!i),n.toggleClass("hide",i)),t.matchScroll(e)}t.toggle=s,i.on("click",(function(){a(),e.find(".write").focus()})),n.on("click",(function(){l(),e.find(".write").focus()})),localStorage.getItem("composer:previewToggled")||"xs"===t.env||"sm"===t.env?a():l()}};return t}.apply(t,i))||(e.exports=o)},6721:(e,t,n)=>{var i,o;i=[n,t,n(32230),n(59006),n(99398),n(75203),n(40646)],o=function(e,t,n,i,o,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toggleForInsert=t.toggle=t.init=t.dialogActions=void 0;var l=$("html");function s(e){var n=$("#emoji-dialog");!$(e.target).is(".emoji-dialog *")&&n.length&&t.dialogActions.close(n)}t.dialogActions={open:function(e){return l.addClass("emoji-insert"),e.addClass("open"),e.appendTo(document.fullscreenElement||"body"),e.find(".emoji-dialog-search").focus(),setTimeout((function(){$(document).off("click",s).on("click",s)}),0),e},close:function(e){return $(document).off("click",s),l.removeClass("emoji-insert"),e.removeClass("open")}};var c={people:10,nature:9,food:8,activity:7,travel:6,objects:5,symbols:4,flags:3,regional:2,modifier:1,other:0};config.emojiCustomFirst&&(c.custom=100);var u=n.Translator.create();function d(e){Promise.all([$.getJSON(a.base+"/emoji/categories.json?"+a.buster),$.getJSON(a.base+"/emoji/packs.json?"+a.buster),new Promise((function(e){return a.init(e)}))]).then((function(e){var t=e[0],n=e[1],o=Object.keys(t).map((function(e){return{name:e,emojis:t[e].map((function(e){return a.table[e]})).map((function(e){return{name:e.name,html:a.buildEmoji(e,!0)}})).sort((function(e,t){return function(e,t){return e<t?-1:e>t?1:0}(e.name,t.name)}))}})).sort((function(e,t){var n=c[e.name]||0;return(c[t.name]||0)-n}));return i.render("partials/emoji-dialog",{categories:o,packs:n})})).then((function(e){return u.translate(e)})).then((function(n){var i=$(n).appendTo(document.fullscreenElement||"body");i.find(".emoji-dialog-search").on("input",(function(e){var t=e.target.value;if(!t)return i.find(".emoji-dialog-search-results").addClass("hidden"),void i.find(".nav-tabs .emoji-dialog-search-results").next().find("a").tab("show");var n=a.search(t).slice(0,100).map((function(e){return'<a class="emoji-link" name="'+e.name+'" href="#">'+a.buildEmoji(e,!1)+"</a>"})).join("\n");i.find(".tab-pane.emoji-dialog-search-results").html(n),i.find(".emoji-dialog-search-results").removeClass("hidden"),i.find(".nav-tabs .emoji-dialog-search-results a").tab("show")}));var o=i.find(".emoji-tabs .tab-content");function l(e){var t=o[0].getBoundingClientRect(),n=Math.ceil(t.width*t.height/1600);e.find(".emoji-link img.defer").filter((function(e,i){if(e<=n)return!0;var o=i.getBoundingClientRect();return o.right>t.left&&o.left<t.right&&o.bottom>t.top&&o.top<t.bottom})).removeClass("defer").each((function(e,t){var n=t.getAttribute("data-src");t.setAttribute("src",n)}))}var s=i.find(".emoji-tabs .nav-tabs a").click((function(e){e.preventDefault(),$(e.target).tab("show")})).on("show.bs.tab",(function(e){l($(e.target.getAttribute("href")))})).eq(1);setTimeout((function(){return s.trigger("show.bs.tab")}),10),o.on("scroll",(function(){l(o.find(".tab-pane.active"))})),r.apply(o[0]);var c=function(){return t.dialogActions.close(i)};$(window).on(["action:composer.discard","action:composer.submit","action:composer.minimize","action:chat.minimize","action:chat.closed"].join(" "),c),i.find(".close").on("click",c),i.draggable&&i.draggable({handle:".top-bar"}),e(i)})).catch((function(e){console.error("Failed to initialize emoji dialog",e)}))}function f(e,n){function i(i){if(i.hasClass("open"))t.dialogActions.close(i);else{i.off("click").on("click",".emoji-link",(function(e){e.preventDefault();var t=e.currentTarget.name;n(e,t,i)}));var o=e?e.getBoundingClientRect():{top:window.innerHeight/3,left:window.innerWidth/3},r={bottom:"auto",top:"auto",right:"auto",left:"auto"};o.top>440?r.top=o.top-400+"px":r.top=o.top+40+"px",o.left<window.innerWidth/2?r.left=o.left+40+"px":r.left=o.left-400+"px",i.css(r),t.dialogActions.open(i)}}var o=$("#emoji-dialog");o.length?i(o):d(i)}t.init=d,t.toggle=f,t.toggleForInsert=function(e,t,n,i){f((i&&i.target?$(i.target):$(e).parents(".composer-container").find('[data-format="emoji-add-emoji"]'))[0],(function(t,n){var i=":"+n+": ",r=e.selectionStart,a=e.selectionEnd,l=a+i.length,s=r===a?l:r;o.insertIntoTextarea(e,i),o.updateTextareaSelection(e,s,l),$(e).trigger("input")}))}}.apply(t,i),void 0===o||(e.exports=o)},75203:(e,t,n)=>{"use strict";var i;void 0===(i=function(){return{apply:function(e){$(e).on("mousewheel",(function(e){const t=this.scrollTop,n=this.scrollHeight,i=Math.round(this.getBoundingClientRect().height);if(e.originalEvent.deltaY<0&&0===t||e.originalEvent.deltaY>0&&i+t>=n)return!1}))}}}.call(t,n,t,e))||(e.exports=i)}}]);