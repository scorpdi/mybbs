"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9517,7214,6503,3014,9743,3230,588,560,3382,71,999,9191,3564,831,7927,7913,6918,2023],{7927:(e,t,a)=>{var n,o;n=[a(32230),a(7237),a(85233)],o=function(e,t,a){const n={};function o(e,t){e.find("strong").translateHtml(t.title),e.find("p").translateHtml(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&s(e,t),a.fire("action:alert.update",{alert:e,params:t}),e.off("click").removeClass("pointer"),"function"==typeof t.clickfn&&e.addClass("pointer").on("click",(function(a){$(a.target).is(".close")||t.clickfn(),r(e)}))}function r(e){e.fadeOut(500,(function(){$(this).remove()}))}function s(e,t){const n=t.timeout,o=setTimeout((function(){r(e),"function"==typeof t.timeoutfn&&t.timeoutfn(e,t)}),n);e.attr("timeoutId",o),e.css("transition-property","none"),e.removeClass("animate"),setTimeout((function(){e.css("transition-property",""),e.css("transition","width "+(n+450)+"ms linear, background-color "+(n+450)+"ms ease-in"),e.addClass("animate"),a.fire("action:alert.animate",{alert:e,params:t})}),50),e.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return n.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:(new Date).getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?o(n,e):function(e){app.parseAndTranslate("alert",e,(function(n){let i=$("#"+e.alert_id);if(i.length)return o(i,e);i=n,i.fadeIn(200),t.get("toaster/tray").prepend(i),"function"==typeof e.closefn&&i.find("button").on("click",(function(){return e.closefn(),r(i),!1})),e.timeout&&s(i,e),"function"==typeof e.clickfn&&i.addClass("pointer").on("click",(function(t){$(t.target).is(".close")||e.clickfn(i,e),r(i)})),a.fire("action:alert.new",{alert:i,params:e})}))}(e)},n.success=function(e,t){n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:t||5e3})},n.error=function(e,t){if("[[error:revalidate-failure]]"===(e=e&&e.message||e))return socket.disconnect(),void app.reconnect();n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:t||1e4})},n.remove=function(e){$("#alert_button_"+e).remove()},n}.apply(t,n),void 0===o||(e.exports=o)},74344:(e,t,a)=>{var n,o;n=[a(85233)],void 0===(o=(e=>{const t={},a=config.relative_path+"/api/v3";function n(t,n){async function o(a){({options:t}=await e.fire("filter:api.options",{options:t})),$.ajax(t).done((e=>{a(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})})).fail((e=>{let t;e.responseJSON&&(t=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),a(new Error(t||e.statusText))}))}if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:a+t.url,"function"!=typeof n)return new Promise(((e,t)=>{o((function(a,n){a?t(a):e(n)}))}));o(n)}return t.get=(e,t,a)=>n({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},a),t.head=(e,t,a)=>n({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},a),t.post=(e,t,a)=>n({url:e,method:"post",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),t.patch=(e,t,a)=>n({url:e,method:"patch",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),t.put=(e,t,a)=>n({url:e,method:"put",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),t.del=(e,t,a)=>n({url:e,method:"delete",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},a),t.delete=t.del,t}).apply(t,n))||(e.exports=o)},7237:(e,t,a)=>{var n;void 0===(n=function(){const e={};return e.core={"topic/teaser":function(e){return e?$('[component="category/topic"][data-tid="'+e+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(e,t){return $('[component="topic"][data-'+e+'="'+t+'"]')},post:function(e,t){return $('[component="post"][data-'+e+'="'+t+'"]')},"post/content":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/content"]')},"post/header":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/header"]')},"post/anchor":function(e){return $('[component="post"][data-index="'+e+'"] [component="post/anchor"]')},"post/vote-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/vote-count"]')},"post/bookmark-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/bookmark-count"]')},"user/postcount":function(e){return $('[component="user/postcount"][data-uid="'+e+'"]')},"user/reputation":function(e){return $('[component="user/reputation"][data-uid="'+e+'"]')},"category/topic":function(e,t){return $('[component="category/topic"][data-'+e+'="'+t+'"]')},"categories/category":function(e,t){return $('[component="categories/category"][data-'+e+'="'+t+'"]')},"chat/message":function(e){return $('[component="chat/message"][data-mid="'+e+'"]')},"chat/message/body":function(e){return $('[component="chat/message"][data-mid="'+e+'"] [component="chat/message/body"]')},"chat/recent/room":function(e){return $('[component="chat/recent/room"][data-roomid="'+e+'"]')}},e.get=function(){const t=Array.prototype.slice.call(arguments,1);return e.core[arguments[0]]&&t.length?e.core[arguments[0]].apply(this,t):$('[component="'+arguments[0]+'"]')},e}.call(t,a,t,e))||(e.exports=n)},47913:(e,t,a)=>{var n,o;n=[a(74344),a(7927)],void 0===(o=function(e,t){var n,o={};function r(){n&&(clearTimeout(n),n=0)}function s(e){return parseInt(e,10)>0?localStorage:sessionStorage}function i(e,t,a){if(c(app.user.uid?"localStorage":"sessionStorage")&&a&&a.save_id&&e.length){const c=e.find("input.title"),l=c&&c.val();var n=e.find("textarea").val(),r=s(app.user.uid);if(a.hasOwnProperty("cid")&&!a.save_id.endsWith(":cid:"+a.cid)&&(o.removeDraft(a.save_id),a.save_id=a.save_id.replace(/cid:\d+$/,"cid:"+a.cid)),n.length||l&&l.length){if(r.setItem(a.save_id,n),r.setItem(`${a.save_id}:uuid`,e.attr("data-uuid")),a.hasOwnProperty("cid")){const t=e.find("input.tags").val();r.setItem(a.save_id+":tags",t),r.setItem(a.save_id+":title",l)}if(!app.user.uid){var i=e.find("input.handle").val();r.setItem(a.save_id+":handle",i)}$(window).trigger("action:composer.drafts.save",{storage:r,postData:a,postContainer:e}),t.toggleClass("active",!0)}else o.removeDraft(a.save_id)}}function c(e){var t;try{t=window[e];var a="__storage_test__";return t.setItem(a,a),t.removeItem(a),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}return o.init=function(e,t){var a=e.find(".draft-icon");function s(){r(),n=setTimeout((function(){i(e,a,t)}),1e3)}e.on("keyup","textarea, input.handle, input.title",s),e.on("click",'input[type="checkbox"]',s),e.on("thumb.uploaded",s),a.on("animationend",(function(){$(this).toggleClass("active",!1)})),$(window).on("unload",(function(){var e=[];try{e=localStorage.getItem("drafts:open"),e=JSON.parse(e)||[]}catch(t){console.warn("[composer/drafts] Could not read list of open/available drafts"),e=[]}e.length&&e.forEach((function(e){o.updateVisibility("open",e)}))})),o.migrateGuest(),o.migrateThumbs(...arguments)},o.getDraft=function(e){return console.warn("[composer/drafts] drafts.getDraft is deprecated! Use drafts.get() instead."),localStorage.getItem(e)},o.get=function(e){var t=e.split(":")[1],a=s(t),n={text:a.getItem(e)};return["cid","title","tags","uuid"].forEach((function(t){const o=a.getItem(e+":"+t);o&&(n[t]=o)})),parseInt(t,10)||(n.handle=a.getItem(e+":handle")),$(window).trigger("action:composer.drafts.get",{save_id:e,draft:n,storage:a}),n},o.removeDraft=function(e){if(e){r(),o.updateVisibility("available",e),o.updateVisibility("open",e);var t=s(e.split(":")[1]);Object.keys(t).filter((t=>t.startsWith(e))).forEach((e=>t.removeItem(e)))}},o.updateVisibility=function(e,t,a){if(c(app.user.uid?"localStorage":"sessionStorage")&&t){var n=[];try{n=(n=localStorage.getItem("drafts:"+e))?JSON.parse(n):[]}catch(e){console.warn("[composer/drafts] Could not read list of open drafts"),n=[]}var o=n.indexOf(t);a&&-1===o?n.push(t):a||-1===o||n.splice(o,1),localStorage.setItem("drafts:"+e,JSON.stringify(n))}},o.migrateGuest=function(){if(c("localStorage")&&app.user.uid){var e=/^composer:\d+:\w+:\d+(:\w+)?$/,t=Object.keys(sessionStorage).filter((function(t){return e.test(t)})),a=new Set([]),n=t.map((function(e){var t=e.split(":");return t[1]=app.user.uid,a.add(t.slice(0,4).join(":")),t.join(":")}));return t.forEach((function(e,t){localStorage.setItem(n[t],sessionStorage.getItem(e)),sessionStorage.removeItem(e)})),a.forEach((function(e){o.updateVisibility("available",e,1)})),a}},o.migrateThumbs=function(t,n){const r=t.attr("data-uuid"),s=o.get(n.save_id);s&&s.uuid&&e.put(`/topics/${s.uuid}/thumbs`,{tid:r}).then((()=>{Promise.all([a.e(6177),a.e(2526),a.e(4074),a.e(2143),a.e(5482),a.e(1521),a.e(2023)]).then((function(){var e=[a(44541)];(function(e){e.updateThumbCount(r,t)}).apply(null,e)})).catch(a.oe)}))},o.loadOpen=function(){if(!ajaxify.data.template.login&&!ajaxify.data.template.register){var n,r=[];try{n=localStorage.getItem("drafts:available"),r=localStorage.getItem("drafts:open"),n=JSON.parse(n)||[],r=JSON.parse(r)||[]}catch(e){console.warn("[composer/drafts] Could not read list of open/available drafts"),n=[],r=[]}n.length&&app.user&&0!==app.user.uid&&n.forEach((function(n){if(n){var s=n.split(":"),i=s[1],c=s[2],l=s[3],u=o.get(n);if(-1===r.indexOf(n)&&parseInt(app.user.uid,10)===parseInt(i,10))return!u||u.text&&u.title&&!u.text.title&&!u.text.length?(o.updateVisibility("available",n),void o.updateVisibility("open",n)):void Promise.all([a.e(6177),a.e(2526),a.e(4074),a.e(2143),a.e(5482),a.e(1521),a.e(2023)]).then((function(){var n=[a(44541)];(function(a){"cid"===c?a.newTopic({cid:l,title:utils.escapeHTML(u.title),body:u.text,tags:[]}):"tid"===c?e.get("/topics/"+l,{},(function(e,n){if(e)return t.error(e);a.newReply(l,void 0,n.title,u.text)})):"pid"===c&&a.editPost(l)}).apply(null,n)})).catch(a.oe)}}))}},o}.apply(t,n))||(e.exports=o)},11120:e=>{e.exports=function(e,t,a){t.setGlobal("true",!0),t.setGlobal("false",!1);const n={displayMenuItem:function(e,t){const a=e.navigation[t];return!!a&&(!(a.route.match("/users")&&e.user&&!e.user.privileges["view:users"])&&(!(a.route.match("/tags")&&e.user&&!e.user.privileges["view:tags"])&&!(a.route.match("/groups")&&e.user&&!e.user.privileges["view:groups"])))},buildMetaTag:function(e){return"<meta "+(e.name?'name="'+e.name+'" ':"")+(e.property?'property="'+e.property+'" ':"")+(e.content?'content="'+e.content.replace(/\n/g," ")+'" ':"")+"/>\n\t"},buildLinkTag:function(e){const[t,a,n,o,r,s,i,c]=["link","rel","as","type","href","sizes","title","crossorigin"].map((t=>e[t]?`${t}="${e[t]}" `:""));return"<link "+t+a+n+o+s+i+r+c+"/>\n\t"},stringify:function(e){return JSON.stringify(e).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/g,"&quot;")},escape:function(t){return e.escapeHTML(t)},stripTags:function(t){return e.stripHTMLTags(t)},generateCategoryBackground:o,generateChildrenCategories:function(e){let t="";return e&&e.children&&e.children.length?(e.children.forEach((function(e){if(e&&!e.isSection){const n=e.link?e.link:a+"/category/"+e.slug;t+='<span class="category-children-item pull-left"><div role="presentation" class="icon pull-left" style="'+o(e)+'"><i class="fa fa-fw '+e.icon+'"></i></div><a href="'+n+'"><small>'+e.name+"</small></a></span>"}})),t=t?'<span class="category-children">'+t+"</span>":t,t):t},generateTopicClass:function(e){return["locked","pinned","deleted","unread","scheduled"].filter((t=>!!e[t])).join(" ")},membershipBtn:function(e){return e.isMember&&"administrators"!==e.name?'<button class="btn btn-danger" data-action="leave" data-group="'+e.displayName+'"'+(e.disableLeave?" disabled":"")+'><i class="fa fa-times"></i> [[groups:membership.leave-group]]</button>':e.isPending&&"administrators"!==e.name?'<button class="btn btn-warning disabled"><i class="fa fa-clock-o"></i> [[groups:membership.invitation-pending]]</button>':e.isInvited?'<button class="btn btn-link" data-action="rejectInvite" data-group="'+e.displayName+'">[[groups:membership.reject]]</button><button class="btn btn-success" data-action="acceptInvite" data-group="'+e.name+'"><i class="fa fa-plus"></i> [[groups:membership.accept-invitation]]</button>':e.disableJoinRequests||"administrators"===e.name?"":'<button class="btn btn-success" data-action="join" data-group="'+e.displayName+'"><i class="fa fa-plus"></i> [[groups:membership.join-group]]</button>'},spawnPrivilegeStates:function(e,t){const a=[];for(const e in t)t.hasOwnProperty(e)&&a.push({name:e,state:t[e]});return a.map((function(t){const a="guests"===e&&(["groups:moderate","groups:posts:upvote","groups:posts:downvote","groups:local:login","groups:group:create"].includes(t.name)||t.name.startsWith("groups:admin:"))||"spiders"===e&&!["groups:find","groups:read","groups:topics:read","groups:view:users","groups:view:tags","groups:view:groups"].includes(t.name)||"Global Moderators"===e&&["groups:moderate"].includes(t.name);return'<td class="text-center" data-privilege="'+t.name+'" data-value="'+t.state+'"><input autocomplete="off" type="checkbox"'+(t.state?" checked":"")+(a?' disabled="disabled"':"")+" /></td>"})).join("")},localeToHTML:function(e,t){return(e=e||t||"en-GB").replace("_","-")},renderTopicImage:function(e){return e.thumb?'<img src="'+e.thumb+'" class="img-circle user-img" title="'+e.user.username+'" />':'<img component="user/picture" data-uid="'+e.user.uid+'" src="'+e.user.picture+'" class="user-img" title="'+e.user.username+'" />'},renderTopicEvents:function(e,t){if("most_votes"===t)return"";const a=this.posts[e].eventStart,n=this.posts[e].eventEnd,o=this.events.filter((e=>e.timestamp>=a&&e.timestamp<n));return o.length?r.call(this,o):""},renderEvents:r,renderDigestAvatar:function(e){return e.teaser?e.teaser.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.teaser.user.picture+'" title="'+e.teaser.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.teaser.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.teaser.user["icon:text"]+"</div>":e.user.picture?'<img style="vertical-align: middle; width: 32px; height: 32px; border-radius: 50%;" src="'+e.user.picture+'" title="'+e.user.username+'" />':'<div style="vertical-align: middle; width: 32px; height: 32px; line-height: 32px; font-size: 16px; background-color: '+e.user["icon:bgColor"]+'; color: white; text-align: center; display: inline-block; border-radius: 50%;">'+e.user["icon:text"]+"</div>"},userAgentIcons:function(e){let t="";switch(e.platform){case"Linux":t+='<i class="fa fa-fw fa-linux"></i>';break;case"Microsoft Windows":t+='<i class="fa fa-fw fa-windows"></i>';break;case"Apple Mac":t+='<i class="fa fa-fw fa-apple"></i>';break;case"Android":t+='<i class="fa fa-fw fa-android"></i>';break;case"iPad":t+='<i class="fa fa-fw fa-tablet"></i>';break;case"iPod":case"iPhone":t+='<i class="fa fa-fw fa-mobile"></i>';break;default:t+='<i class="fa fa-fw fa-question-circle"></i>'}switch(e.browser){case"Chrome":t+='<i class="fa fa-fw fa-chrome"></i>';break;case"Firefox":t+='<i class="fa fa-fw fa-firefox"></i>';break;case"Safari":t+='<i class="fa fa-fw fa-safari"></i>';break;case"IE":t+='<i class="fa fa-fw fa-internet-explorer"></i>';break;case"Edge":t+='<i class="fa fa-fw fa-edge"></i>';break;default:t+='<i class="fa fa-fw fa-question-circle"></i>'}return t},buildAvatar:s,register:function(){Object.keys(n).forEach((function(e){t.registerHelper(e,n[e])}))},__escape:function(e){return e}};function o(e){if(!e)return"";const t=[];return e.bgColor&&t.push("background-color: "+e.bgColor),e.color&&t.push("color: "+e.color),e.backgroundImage&&(t.push("background-image: url("+e.backgroundImage+")"),e.imageClass&&t.push("background-size: "+e.imageClass)),t.join("; ")+";"}function r(e){return e.reduce(((e,t)=>(e+=`<li component="topic/event" class="timeline-event" data-topic-event-id="${t.id}" data-topic-event-type="${t.type}">\n\t\t\t\t<div class="timeline-badge">\n\t\t\t\t\t<i class="fa ${t.icon||"fa-circle"}"></i>\n\t\t\t\t</div>\n\t\t\t\t<span class="timeline-text">\n\t\t\t\t\t${t.href?`<a href="${a}${t.href}">${t.text}</a>`:t.text}&nbsp;\n\t\t\t\t</span>\n\t\t\t`,t.user&&(t.user.system?e+='<span class="timeline-text">[[global:system-user]]</span>&nbsp;':e+=`<span><a href="${a}/user/${t.user.userslug}">${s(t.user,"xs",!0)}&nbsp;${t.user.username}</a></span>&nbsp;`),e+=`<span class="timeago timeline-text" title="${t.timestampISO}"></span>`,this.privileges.isAdminOrMod&&(e+=`&nbsp;<span component="topic/event/delete" data-topic-event-id="${t.id}" data-topic-event-type="${t.type} class="timeline-text pointer" title="[[topic:delete-event]]"><i class="fa fa-trash"></i></span>`),e)),"")}function s(e,t,a,n,o){e||(e=this);const r=['alt="'+e.username+'"','title="'+e.username+'"','data-uid="'+e.uid+'"','loading="lazy"'],s=[];return n=n||"",["xs","sm","sm2x","md","lg","xl"].includes(t)?n+=" avatar-"+t:isNaN(parseInt(t,10))?n+=" avatar-sm":s.push("width: "+t+"px;","height: "+t+"px;","line-height: "+t+"px;","font-size: "+parseInt(t,10)/16+"rem;"),r.unshift('class="avatar '+n+(a?" avatar-rounded":"")+'"'),o?r.push('component="'+o+'"'):r.push('component="avatar/'+(e.picture?"picture":"icon")+'"'),e.picture?"<img "+r.join(" ")+' src="'+e.picture+'" style="'+s.join(" ")+'" />':(s.push("background-color: "+e["icon:bgColor"]+";"),"<span "+r.join(" ")+' style="'+s.join(" ")+'">'+e["icon:text"]+"</span>")}return n}},59265:(e,t,a)=>{var n,o;const r=a(11120);n=[a(96795),a(59006)],void 0===(o=function(e,t){return r(e,t,config.relative_path)}.apply(t,n))||(e.exports=o)},22568:(e,t,a)=>{var n,o,r;o=[a(20648)],void 0===(r="function"==typeof(n=function(e){const t=e("[^\\p{L}\\s\\d\\-_]","g"),a=/[^\w\s\d\-_]/g,n=/^\s+|\s+$/g,o=/\s+/g,r=/-+/g,s=/-$/g,i=/^-/g,c=/^[\w\d\s.,\-@]+$/;return function(l,u){return l?(l=String(l).replace(n,""),l=c.test(l)?l.replace(a,"-"):e.replace(l,t,"-"),l=(l=(l=(l=(l=u?l:l.toLocaleLowerCase()).replace(o,"-")).replace(r,"-")).replace(s,"")).replace(i,"")):""}})?n.apply(t,o):n)||(e.exports=r)},62023:(e,t,a)=>{var n,o;n=[a(74344),a(31369),a(7927),a(50431),a(59006),a(32230),a(62526)],void 0===(o=function(e,t,n,o,r,s){const i={get:t=>e.get(`/topics/${t}/thumbs`,{}),getByPid:t=>e.get(`/posts/${t}`,{}).then((e=>i.get(e.tid))),delete:(t,a)=>e.del(`/topics/${t}/thumbs`,{path:a}),deleteAll:e=>{i.get(e).then((t=>{Promise.all(t.map((t=>i.delete(e,t.url))))}))},upload:e=>new Promise((t=>{o.show({title:"[[topic:composer.thumb_title]]",method:"put",route:config.relative_path+`/api/v3/topics/${e}/thumbs`},(function(e){t(e)}))})),modal:{}};return i.modal.open=function(e){const{id:n,pid:o}=e;let c,{modal:l}=e;return new Promise((u=>{Promise.all([i.get(n),o?i.getByPid(o):[]]).then((e=>new Promise((t=>{const a=e.reduce(((e,t)=>e.concat(t)));c=a.length,t(a)})))).then((e=>r.render("modals/topic-thumbs",{thumbs:e}))).then((o=>{l?s.translate(o,(function(e){l.find(".bootbox-body").html(e),i.modal.handleSort({modal:l,numThumbs:c})})):(l=t.dialog({title:"[[modules:thumbs.modal.title]]",message:o,buttons:{add:{label:'<i class="fa fa-plus"></i> [[modules:thumbs.modal.add]]',className:"btn-success",callback:()=>(i.upload(n).then((()=>{i.modal.open({...e,modal:l}),Promise.all([a.e(4074),a.e(2143),a.e(5482),a.e(1521),a.e(6918)]).then((function(){var e=[a(44541)];(e=>{e.updateThumbCount(n,$(`[component="composer"][data-uuid="${n}"]`)),u()}).apply(null,e)})).catch(a.oe)})),!1)},close:{label:"[[global:close]]",className:"btn-primary"}}}),i.modal.handleDelete({...e,modal:l}),i.modal.handleSort({modal:l,numThumbs:c}))}))}))},i.modal.handleDelete=a=>{a.modal.get(0).addEventListener("click",(o=>{o.target.closest('button[data-action="remove"]')&&t.confirm("[[modules:thumbs.modal.confirm-remove]]",(t=>{if(!t)return;const r=o.target.closest(".media[data-id]").getAttribute("data-id"),s=o.target.closest(".media[data-path]").getAttribute("data-path");e.del(`/topics/${r}/thumbs`,{path:s}).then((()=>{i.modal.open(a)})).catch(n.error)}))}))},i.modal.handleSort=({modal:e,numThumbs:t})=>{if(t>1){const t=e.find(".topic-thumbs-modal");t.sortable({items:"[data-id]"}),t.on("sortupdate",i.modal.handleSortChange)}},i.modal.handleSortChange=(t,a)=>{const o=a.item.get(0).parentNode.querySelectorAll("[data-id]");Array.from(o).forEach(((t,a)=>{const o=t.getAttribute("data-id");let r=t.getAttribute("data-path");r=r.replace(new RegExp(`^${config.upload_url}`),""),e.put(`/topics/${o}/thumbs/order`,{path:r,order:a}).catch(n.error)}))},i}.apply(t,n))||(e.exports=o)},50431:(e,t,a)=>{var n,o;n=[a(86569)],o=function(){const e={};function t(t,a,n){e.hideAlerts(t),"error"===a&&t.find("#fileUploadSubmitBtn").removeClass("disabled"),t.find("#alert-"+a).translateText(n).removeClass("hide")}function a(e){if("string"==typeof e)try{return $.parseJSON(e)}catch(e){return{error:"[[error:parse-error]]"}}return e}return e.show=function(a,n){const o=!(!a.hasOwnProperty("fileSize")||void 0===a.fileSize)&&parseInt(a.fileSize,10);app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:!a.hasOwnProperty("showHelp")||void 0===a.showHelp||a.showHelp,fileSize:o,title:a.title||"[[global:upload_file]]",description:a.description||"",button:a.button||"[[global:upload]]",accept:a.accept?a.accept.replace(/,/g,"&#44; "):""},(function(r){r.modal("show"),r.on("hidden.bs.modal",(function(){r.remove()}));const s=r.find("#uploadForm");s.attr("action",a.route),s.find("#params").val(JSON.stringify(a.params)),r.find("#fileUploadSubmitBtn").on("click",(function(){$(this).addClass("disabled"),s.submit()})),s.submit((function(){return function(a,n,o){t(a,"status","[[uploads:uploading-file]]"),a.find("#upload-progress-bar").css("width","0%"),a.find("#upload-progress-box").show().removeClass("hide");const r=a.find("#fileInput");return r.val()?(s=r[0],i=n,!window.FileReader||!i||s.files[0].size<=1e3*i?void e.ajaxSubmit(a,o):t(a,"error","[[error:file-too-big, "+n+"]]")):t(a,"error","[[uploads:select-file-to-upload]]");var s,i}(r,o,n),!1}))}))},e.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")},e.ajaxSubmit=function(n,o){n.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=a(e),t(n,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,t,a,o){n.find("#upload-progress-bar").css("width",o+"%")},success:function(r){let s=a(r);r.hasOwnProperty("response")&&r.hasOwnProperty("status")&&"ok"===r.status.code&&(s=r.response.images),o(s[0].url),t(n,"success","[[uploads:upload-success]]"),setTimeout((function(){e.hideAlerts(n),n.modal("hide")}),750)}})},e}.apply(t,n),void 0===o||(e.exports=o)}}]);