"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4400,7214,6503,71,7927],{29721:(t,e,n)=>{var i,a;i=[n(32230),n(59006),n(31369),n(7927),n(62526)],void 0===(a=function(t,e,i,a){const o={};function r(e,n){i.confirm(t.compile("admin/extend/plugins:alert.possibly-incompatible",e),(function(t){n(t)}))}function s(t,e,i){e.attr("disabled",!0).find("i").attr("class","fa fa-refresh fa-spin"),socket.emit("admin.plugins.upgrade",{id:t,version:i},(function(t,o){if(t)return a.error(t);const r=e.parents("li");r.find(".fa-exclamation-triangle").remove(),r.find(".currentVersion").text(i),e.remove(),o&&a.alert({alert_id:"plugin_upgraded",title:"[[admin/extend/plugins:alert.upgraded]]",message:"[[admin/extend/plugins:alert.upgrade-success]]",type:"warning",timeout:5e3,clickfn:function(){n.e(4117).then((function(){var t=[n(64117)];(function(t){t.rebuildAndRestart()}).apply(null,t)})).catch(n.oe)}})}))}return o.init=function(){const c=$(".plugins");let l;if(!c[0].querySelectorAll("li").length)return void t.translate("<li><p><i>[[admin/extend/plugins:none-found]]</i></p></li>",(function(t){c.append(t)}));const u=document.querySelector("#plugin-search");u.value="",c.on("click",'button[data-action="toggleActive"]',(function(){const o=$(this).parents("li");l=o.attr("data-plugin-id");const r=$('[id="'+l+'"] [data-action="toggleActive"]'),s=ajaxify.data.installed[o.attr("data-plugin-index")];function c(){socket.emit("admin.plugins.toggleActive",l,(function(e,i){if(e)return a.error(e);t.translate('<i class="fa fa-power-off"></i> [[admin/extend/plugins:plugin-item.'+(i.active?"deactivate":"activate")+"]]",(function(t){r.html(t),r.toggleClass("btn-warning",i.active).toggleClass("btn-success",!i.active),i.active&&!$('#active [id="'+l+'"]').length&&$("#active ul").prepend(o.clone(!0)),s.active=!s.active,a.alert({alert_id:"plugin_toggled",title:"[[admin/extend/plugins:alert."+(i.active?"enabled":"disabled")+"]]",message:"[[admin/extend/plugins:alert."+(i.active?"activate-success":"deactivate-success")+"]]",type:i.active?"warning":"success",timeout:5e3,clickfn:function(){n.e(4117).then((function(){var t=[n(64117)];(function(t){t.rebuildAndRestart()}).apply(null,t)})).catch(n.oe)}})}))}))}s.license&&!0!==s.active?e.render("admin/partials/plugins/license",s).then((function(t){i.dialog({title:"[[admin/extend/plugins:license.title]]",message:t,size:"large",buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[modules:bootbox.confirm]]",className:"btn-primary",callback:c}},onShown:function(){const t=this.querySelector("button.btn-primary");t&&t.focus()}})})):c()})),c.on("click",'button[data-action="toggleInstall"]',(function(){const e=$(this);if(e.attr("disabled",!0),l=$(this).parents("li").attr("data-plugin-id"),"1"===$(this).attr("data-installed"))return o.toggleInstall(l,$(this).parents("li").attr("data-version"));o.suggest(l,(function(n,a){n?i.confirm(t.compile("admin/extend/plugins:alert.suggest-error",n.status,n.responseText),(function(t){t?o.toggleInstall(l,"latest"):e.removeAttr("disabled")})):"latest"!==a.version?o.toggleInstall(l,a.version):"latest"===a.version?r(l,(function(t){t?o.toggleInstall(l,"latest"):e.removeAttr("disabled")})):e.removeAttr("disabled")}))})),c.on("click",'button[data-action="upgrade"]',(function(){const e=$(this),a=e.parents("li");l=a.attr("data-plugin-id"),o.suggest(l,(function(o,c){if(o)return i.alert("[[admin/extend/plugins:alert.package-manager-unreachable]]");n.e(3731).then((function(){var o=[n(53731)];(function(n){const o=a.find(".currentVersion").text();"latest"!==c.version&&n.compare(c.version,o,">")?s(l,e,c.version):"latest"===c.version?r(l,(function(){s(l,e,c.version)})):i.alert(t.compile("admin/extend/plugins:alert.incompatible",app.config.version,c.version))}).apply(null,o)})).catch(n.oe)}))})),$(u).on("input propertychange",(function(){const t=$(this).val();$(".plugins li").each((function(){const e=$(this).attr("data-plugin-id");$(this).toggleClass("hide",e&&-1===e.indexOf(t))})),document.querySelectorAll(".plugins .tab-pane").forEach((t=>{const e=t.querySelectorAll("li:not(.hide)").length,n=t.querySelector(".no-plugins");n&&n.classList.toggle("hide",0!==e)}))})),$("#plugin-submit-usage").on("click",(function(){socket.emit("admin.config.setMultiple",{submitPluginUsage:$(this).prop("checked")?"1":"0"},(function(t){if(t)return a.error(t)}))})),$("#plugin-order").on("click",(function(){$("#order-active-plugins-modal").modal("show"),socket.emit("admin.plugins.getActive",(function(e,n){if(e)return a.error(e);let i="";if(n.forEach((function(t){i+='<li class="">'+t+'<span class="pull-right"><i class="fa fa-chevron-up"></i><i class="fa fa-chevron-down"></i></span></li>'})),!n.length)return void t.translate("[[admin/extend/plugins:none-active]]",(function(t){$("#order-active-plugins-modal .plugin-list").html(t).sortable()}));const o=$("#order-active-plugins-modal .plugin-list");o.html(i).sortable(),o.find(".fa-chevron-up").on("click",(function(){const t=$(this).parents("li");t.prev().before(t)})),o.find(".fa-chevron-down").on("click",(function(){const t=$(this).parents("li");t.next().after(t)}))}))})),$("#save-plugin-order").on("click",(function(){const t=$("#order-active-plugins-modal .plugin-list").children(),e=[];t.each((function(t,n){e.push({name:$(n).text(),order:t})})),socket.emit("admin.plugins.orderActivePlugins",e,(function(t){if(t)return a.error(t);$("#order-active-plugins-modal").modal("hide"),a.alert({alert_id:"plugin_reordered",title:"[[admin/extend/plugins:alert.reorder]]",message:"[[admin/extend/plugins:alert.reorder-success]]",type:"success",timeout:5e3,clickfn:function(){n.e(4117).then((function(){var t=[n(64117)];(function(t){t.rebuildAndRestart()}).apply(null,t)})).catch(n.oe)}})}))})),$("#installed ul li").each((function(){$(this).children('[data-action="upgrade"]').length&&$("#upgrade ul").append($(this).clone(!0))})),$("#installed ul li").each((function(){$(this).hasClass("active")?$("#active ul").append($(this).clone(!0)):$("#deactive ul").append($(this).clone(!0))})),u.focus()},o.toggleInstall=function(t,e,n){const i=$('li[data-plugin-id="'+t+'"] button[data-action="toggleInstall"]');i.find("i").attr("class","fa fa-refresh fa-spin"),socket.emit("admin.plugins.toggleInstall",{id:t,version:e},(function(t,e){if(t)return i.removeAttr("disabled"),a.error(t);ajaxify.refresh(),a.alert({alert_id:"plugin_toggled",title:"[[admin/extend/plugins:alert."+(e.installed?"installed":"uninstalled")+"]]",message:"[[admin/extend/plugins:alert."+(e.installed?"install-success":"uninstall-success")+"]]",type:"info",timeout:5e3}),"function"==typeof n&&n.apply(this,arguments)}))},o.suggest=function(t,e){const n=app.config.version.match(/^\d+\.\d+\.\d+/);$.ajax((app.config.registry||"https://packages.nodebb.org")+"/api/v1/suggest",{type:"GET",data:{package:t,version:n[0]},dataType:"json"}).done((function(t){e(void 0,t)})).fail(e)},o}.apply(e,i))||(t.exports=a)},7927:(t,e,n)=>{var i,a;i=[n(32230),n(7237),n(85233)],a=function(t,e,n){const i={};function a(t,e){t.find("strong").translateHtml(e.title),t.find("p").translateHtml(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&r(t,e),n.fire("action:alert.update",{alert:t,params:e}),t.off("click").removeClass("pointer"),"function"==typeof e.clickfn&&t.addClass("pointer").on("click",(function(n){$(n.target).is(".close")||e.clickfn(),o(t)}))}function o(t){t.fadeOut(500,(function(){$(this).remove()}))}function r(t,e){const i=e.timeout,a=setTimeout((function(){o(t),"function"==typeof e.timeoutfn&&e.timeoutfn(t,e)}),i);t.attr("timeoutId",a),t.css("transition-property","none"),t.removeClass("animate"),setTimeout((function(){t.css("transition-property",""),t.css("transition","width "+(i+450)+"ms linear, background-color "+(i+450)+"ms ease-in"),t.addClass("animate"),n.fire("action:alert.animate",{alert:t,params:e})}),50),t.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return i.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const i=$("#"+t.alert_id);i.length?a(i,t):function(t){app.parseAndTranslate("alert",t,(function(i){let s=$("#"+t.alert_id);if(s.length)return a(s,t);s=i,s.fadeIn(200),e.get("toaster/tray").prepend(s),"function"==typeof t.closefn&&s.find("button").on("click",(function(){return t.closefn(),o(s),!1})),t.timeout&&r(s,t),"function"==typeof t.clickfn&&s.addClass("pointer").on("click",(function(e){$(e.target).is(".close")||t.clickfn(s,t),o(s)})),n.fire("action:alert.new",{alert:s,params:t})}))}(t)},i.success=function(t,e){i.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:e||5e3})},i.error=function(t,e){if("[[error:revalidate-failure]]"===(t=t&&t.message||t))return socket.disconnect(),void app.reconnect();i.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:e||1e4})},i.remove=function(t){$("#alert_button_"+t).remove()},i}.apply(e,i),void 0===a||(t.exports=a)},7237:(t,e,n)=>{var i;void 0===(i=function(){const t={};return t.core={"topic/teaser":function(t){return t?$('[component="category/topic"][data-tid="'+t+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(t,e){return $('[component="topic"][data-'+t+'="'+e+'"]')},post:function(t,e){return $('[component="post"][data-'+t+'="'+e+'"]')},"post/content":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/content"]')},"post/header":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/header"]')},"post/anchor":function(t){return $('[component="post"][data-index="'+t+'"] [component="post/anchor"]')},"post/vote-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/vote-count"]')},"post/bookmark-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/bookmark-count"]')},"user/postcount":function(t){return $('[component="user/postcount"][data-uid="'+t+'"]')},"user/reputation":function(t){return $('[component="user/reputation"][data-uid="'+t+'"]')},"category/topic":function(t,e){return $('[component="category/topic"][data-'+t+'="'+e+'"]')},"categories/category":function(t,e){return $('[component="categories/category"][data-'+t+'="'+e+'"]')},"chat/message":function(t){return $('[component="chat/message"][data-mid="'+t+'"]')},"chat/message/body":function(t){return $('[component="chat/message"][data-mid="'+t+'"] [component="chat/message/body"]')},"chat/recent/room":function(t){return $('[component="chat/recent/room"][data-roomid="'+t+'"]')}},t.get=function(){const e=Array.prototype.slice.call(arguments,1);return t.core[arguments[0]]&&e.length?t.core[arguments[0]].apply(this,e):$('[component="'+arguments[0]+'"]')},t}.call(e,n,e,t))||(t.exports=i)}}]);