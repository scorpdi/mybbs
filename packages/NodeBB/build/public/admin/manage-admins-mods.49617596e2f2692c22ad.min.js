"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[7129,7214,6503,3014,8253,6623,9286,71,831,7927,6193],{38618:(e,t,n)=>{var o,a;o=[n(86193),n(74344),n(31369),n(7927),n(50548)],void 0===(a=function(e,t,n,o,a){return{init:function(){e.user($("#admin-search"),(function(e,t){socket.emit("admin.user.makeAdmins",[t.item.user.uid],(function(e){if(e)return o.error(e);o.success("[[admin/manage/users:alerts.make-admin-success]]"),$("#admin-search").val(""),$('.administrator-area [data-uid="'+t.item.user.uid+'"]').length||app.parseAndTranslate("admin/manage/admins-mods","admins.members",{admins:{members:[t.item.user]}},(function(e){$(".administrator-area").prepend(e)}))}))})),$(".administrator-area").on("click",".remove-user-icon",(function(){const e=$(this).parents("[data-uid]"),t=e.attr("data-uid");if(parseInt(t,10)===parseInt(app.user.uid,10))return o.error("[[admin/manage/users:alerts.no-remove-yourself-admin]]");n.confirm("[[admin/manage/users:alerts.confirm-remove-admin]]",(function(n){n&&socket.emit("admin.user.removeAdmins",[t],(function(t){if(t)return o.error(t.message);o.success("[[admin/manage/users:alerts.remove-admin-success]]"),e.remove()}))}))})),e.user($("#global-mod-search"),(function(e,n){t.put("/groups/global-moderators/membership/"+n.item.user.uid).then((()=>{o.success("[[admin/manage/users:alerts.make-global-mod-success]]"),$("#global-mod-search").val(""),$('.global-moderator-area [data-uid="'+n.item.user.uid+'"]').length||app.parseAndTranslate("admin/manage/admins-mods","globalMods.members",{globalMods:{members:[n.item.user]}},(function(e){$(".global-moderator-area").prepend(e),$("#no-global-mods-warning").addClass("hidden")}))})).catch(o.error)})),$(".global-moderator-area").on("click",".remove-user-icon",(function(){const e=$(this).parents("[data-uid]"),a=e.attr("data-uid");n.confirm("[[admin/manage/users:alerts.confirm-remove-global-mod]]",(function(n){n&&t.del("/groups/global-moderators/membership/"+a).then((()=>{o.success("[[admin/manage/users:alerts.remove-global-mod-success]]"),e.remove(),$(".global-moderator-area").children().length||$("#no-global-mods-warning").removeClass("hidden")})).catch(o.error)}))})),a.init($('[component="category-selector"]'),{parentCid:ajaxify.data.selectedCategory?ajaxify.data.selectedCategory.cid:0,onSelect:function(e){ajaxify.go("admin/manage/admins-mods"+(e.cid?"?cid="+e.cid:""))},localCategories:[]}),e.user($(".moderator-search"),(function(e,n){const a=$(e.target),r=$(e.target).attr("data-cid");t.put(`/categories/${r}/moderator/${n.item.user.uid}`,{},(function(e){if(e)return o.error(e);o.success("[[admin/manage/users:alerts.make-moderator-success]]"),a.val(""),$('.moderator-area[data-cid="'+r+'"] [data-uid="'+n.item.user.uid+'"]').length||app.parseAndTranslate("admin/manage/admins-mods","globalMods.members",{globalMods:{members:[n.item.user]}},(function(e){$('.moderator-area[data-cid="'+r+'"]').prepend(e),$('.no-moderator-warning[data-cid="'+r+'"]').addClass("hidden")}))}))})),$(".moderator-area").on("click",".remove-user-icon",(function(){const e=$(this).parents("[data-cid]"),a=e.attr("data-cid"),r=$(this).parents("[data-uid]"),s=r.attr("data-uid");n.confirm("[[admin/manage/users:alerts.confirm-remove-moderator]]",(function(n){n&&t.delete(`/categories/${a}/moderator/${s}`,{},(function(t){if(t)return o.error(t);o.success("[[admin/manage/users:alerts.remove-moderator-success]]"),r.remove(),e.children().length||$('.no-moderator-warning[data-cid="'+a+'"]').removeClass("hidden")}))}))}))}}}.apply(t,o))||(e.exports=a)},7927:(e,t,n)=>{var o,a;o=[n(32230),n(7237),n(85233)],a=function(e,t,n){const o={};function a(e,t){e.find("strong").translateHtml(t.title),e.find("p").translateHtml(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&s(e,t),n.fire("action:alert.update",{alert:e,params:t}),e.off("click").removeClass("pointer"),"function"==typeof t.clickfn&&e.addClass("pointer").on("click",(function(n){$(n.target).is(".close")||t.clickfn(),r(e)}))}function r(e){e.fadeOut(500,(function(){$(this).remove()}))}function s(e,t){const o=t.timeout,a=setTimeout((function(){r(e),"function"==typeof t.timeoutfn&&t.timeoutfn(e,t)}),o);e.attr("timeoutId",a),e.css("transition-property","none"),e.removeClass("animate"),setTimeout((function(){e.css("transition-property",""),e.css("transition","width "+(o+450)+"ms linear, background-color "+(o+450)+"ms ease-in"),e.addClass("animate"),n.fire("action:alert.animate",{alert:e,params:t})}),50),e.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return o.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:(new Date).getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const o=$("#"+e.alert_id);o.length?a(o,e):function(e){app.parseAndTranslate("alert",e,(function(o){let i=$("#"+e.alert_id);if(i.length)return a(i,e);i=o,i.fadeIn(200),t.get("toaster/tray").prepend(i),"function"==typeof e.closefn&&i.find("button").on("click",(function(){return e.closefn(),r(i),!1})),e.timeout&&s(i,e),"function"==typeof e.clickfn&&i.addClass("pointer").on("click",(function(t){$(t.target).is(".close")||e.clickfn(i,e),r(i)})),n.fire("action:alert.new",{alert:i,params:e})}))}(e)},o.success=function(e,t){o.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:t||5e3})},o.error=function(e,t){if("[[error:revalidate-failure]]"===(e=e&&e.message||e))return socket.disconnect(),void app.reconnect();o.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:t||1e4})},o.remove=function(e){$("#alert_button_"+e).remove()},o}.apply(t,o),void 0===a||(e.exports=a)},74344:(e,t,n)=>{var o,a;o=[n(85233)],void 0===(a=(e=>{const t={},n=config.relative_path+"/api/v3";function o(t,o){async function a(n){({options:t}=await e.fire("filter:api.options",{options:t})),$.ajax(t).done((e=>{n(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})})).fail((e=>{let t;e.responseJSON&&(t=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),n(new Error(t||e.statusText))}))}if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:n+t.url,"function"!=typeof o)return new Promise(((e,t)=>{a((function(n,o){n?t(n):e(o)}))}));a(o)}return t.get=(e,t,n)=>o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},n),t.head=(e,t,n)=>o({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},n),t.post=(e,t,n)=>o({url:e,method:"post",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.patch=(e,t,n)=>o({url:e,method:"patch",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.put=(e,t,n)=>o({url:e,method:"put",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.del=(e,t,n)=>o({url:e,method:"delete",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.delete=t.del,t}).apply(t,o))||(e.exports=a)},86193:(e,t,n)=>{var o,a;o=[n(74344),n(7927)],a=function(e,t){const n={},o={delay:200};return n.init=e=>{const{input:t,source:n,onSelect:a,delay:r}={...o,...e};app.loadJQueryUI((function(){t.autocomplete({delay:r,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(e,n){!function(e,t,n,o){t=t||function(){};const a=jQuery.Event("keypress");a.which=13,a.keyCode=13,setTimeout((function(){e.trigger(a)}),100),t(n,o)}(t,a,e,n)},source:n})}))},n.user=function(o,a,r){"function"==typeof a&&(r=a,a={}),a=a||{},n.init({input:o,onSelect:r,source:(n,o)=>{a.query=n.term,e.get("/api/users",a,(function(e,n){if(e)return t.error(e);if(n&&n.users){const e=n.users.map((function(e){const t=$("<div></div>").html(e.username).text();return e&&{label:t,value:t,user:{uid:e.uid,name:e.username,slug:e.userslug,username:e.username,userslug:e.userslug,picture:e.picture,banned:e.banned,"icon:text":e["icon:text"],"icon:bgColor":e["icon:bgColor"]}}}));o(e)}$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n.group=function(e,o){n.init({input:e,onSelect:o,source:(e,n)=>{socket.emit("groups.search",{query:e.term},(function(e,o){if(e)return t.error(e);if(o&&o.length){const e=o.map((function(e){return e&&{label:e.name,value:e.name,group:e}}));n(e)}$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n.tag=function(e,o){n.init({input:e,onSelect:o,delay:100,source:(e,n)=>{socket.emit("topics.autocompleteTags",{query:e.term,cid:ajaxify.data.cid||0},(function(e,o){if(e)return t.error(e);o&&n(o),$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n}.apply(t,o),void 0===a||(e.exports=a)},22905:(e,t,n)=>{var o,a;o=[n(7927)],void 0===(a=function(e){const t={init:function(t,n){let o=null;(n=n||{}).privilege=n.privilege||"topics:read",n.states=n.states||["watching","notwatching","ignoring"];let a=[];Array.isArray(n.localCategories)&&(a=n.localCategories.map((e=>({...e})))),n.selectedCids=n.selectedCids||ajaxify.data.selectedCids||[];const r=t.find('[component="category-selector-search"]');if(!r.length)return;const s=r.parent('[component="category/dropdown"]').length>0||r.parent('[component="category-selector"]').length>0;function i(e){app.parseAndTranslate(n.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},(function(n){t.find('[component="category/list"]').replaceWith(n.find('[component="category/list"]')),t.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length)}))}t.on("show.bs.dropdown",(function(){function c(){const t=r.find("input").val();var s,c;t.length>1||!t&&!o?(s=t,c=function(e){o=o||e,i(e)},socket.emit("categories.categorySearch",{search:s,query:utils.params(),parentCid:n.parentCid||0,selectedCids:n.selectedCids,privilege:n.privilege,states:n.states,showLinks:n.showLinks},(function(t,n){if(t)return e.error(t);c(a.concat(n))}))):!t&&o&&(o.forEach((function(e){e.selected=n.selectedCids.includes(e.cid)})),i(o))}s&&(t.find(".dropdown-toggle").addClass("hidden"),r.removeClass("hidden")),r.on("click",(function(e){e.preventDefault(),e.stopPropagation()})),r.find("input").val("").on("keyup",utils.debounce(c,300)),c()})),t.on("shown.bs.dropdown",(function(){r.find("input").focus()})),t.on("hide.bs.dropdown",(function(){s&&(t.find(".dropdown-toggle").removeClass("hidden"),r.addClass("hidden")),r.off("click"),r.find("input").off("keyup")}))}};return t}.apply(t,o))||(e.exports=a)},50548:(e,t,n)=>{var o,a;o=[n(22905),n(31369),n(85233)],void 0===(a=function(e,t,n){const o={init:function(t,o){if(!t||!t.length)return;const a=(o=o||{}).onSelect||function(){};o.states=o.states||["watching","notwatching","ignoring"],o.template="partials/category-selector",n.fire("action:category.selector.options",{el:t,options:o}),e.init(t,o);const r={el:t,selectedCategory:null};t.on("click","[data-cid]",(function(){const e=$(this);if(e.hasClass("disabled"))return!1;r.selectCategory(e.attr("data-cid")),a(r.selectedCategory)}));const s=r.el.find('[component="category-selector-selected"]').html();return r.selectCategory=function(e){const t=r.el.find('[data-cid="'+e+'"]');r.selectedCategory={cid:e,name:t.attr("data-name")},t.length?r.el.find('[component="category-selector-selected"]').html(t.find('[component="category-markup"]').html()):r.el.find('[component="category-selector-selected"]').html(s)},r.getSelectedCategory=function(){return r.selectedCategory},r.getSelectedCid=function(){return r.selectedCategory?r.selectedCategory.cid:0},r},modal:function(e){(e=e||{}).onSelect=e.onSelect||function(){},e.onSubmit=e.onSubmit||function(){},app.parseAndTranslate("admin/partials/categories/select-category",{message:e.message},(function(n){const a=t.dialog({title:e.title||"[[modules:composer.select_category]]",message:n,buttons:{save:{label:"[[global:select]]",className:"btn-primary",callback:s}}}),r=o.init(a.find('[component="category-selector"]'),e);function s(t){return t.preventDefault(),r.selectedCategory&&(e.onSubmit(r.selectedCategory),a.modal("hide")),!1}e.openOnLoad&&a.on("shown.bs.modal",(function(){a.find(".dropdown-toggle").dropdown("toggle")})),a.find("form").on("submit",s)}))}};return o}.apply(t,o))||(e.exports=a)},7237:(e,t,n)=>{var o;void 0===(o=function(){const e={};return e.core={"topic/teaser":function(e){return e?$('[component="category/topic"][data-tid="'+e+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(e,t){return $('[component="topic"][data-'+e+'="'+t+'"]')},post:function(e,t){return $('[component="post"][data-'+e+'="'+t+'"]')},"post/content":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/content"]')},"post/header":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/header"]')},"post/anchor":function(e){return $('[component="post"][data-index="'+e+'"] [component="post/anchor"]')},"post/vote-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/vote-count"]')},"post/bookmark-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/bookmark-count"]')},"user/postcount":function(e){return $('[component="user/postcount"][data-uid="'+e+'"]')},"user/reputation":function(e){return $('[component="user/reputation"][data-uid="'+e+'"]')},"category/topic":function(e,t){return $('[component="category/topic"][data-'+e+'="'+t+'"]')},"categories/category":function(e,t){return $('[component="categories/category"][data-'+e+'="'+t+'"]')},"chat/message":function(e){return $('[component="chat/message"][data-mid="'+e+'"]')},"chat/message/body":function(e){return $('[component="chat/message"][data-mid="'+e+'"] [component="chat/message/body"]')},"chat/recent/room":function(e){return $('[component="chat/recent/room"][data-roomid="'+e+'"]')}},e.get=function(){const t=Array.prototype.slice.call(arguments,1);return e.core[arguments[0]]&&t.length?e.core[arguments[0]].apply(this,t):$('[component="'+arguments[0]+'"]')},e}.call(t,n,t,e))||(e.exports=o)}}]);