/*! For license information please see extend-widgets.1623b5f89d908c87d3d9.min.js.LICENSE.txt */
(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4834,7214,6503,71,7927],{8196:(t,e,n)=>{"use strict";var a,i;a=[n(31369),n(7927),n(62526),n(87285),n(66709),n(84414)],void 0===(i=function(t,e){const n={};function a(t){const e=(new Date).getFullYear();t.find(".date-selector").datepicker({changeMonth:!0,changeYear:!0,yearRange:e+":"+(e+100)})}function i(t){t.hasClass("block")||t.addClass("block").css("width","").css("height","").droppable({accept:"[data-container-html]",drop:function(t,e){const n=$(this);n.find(".panel-body .container-html").val(e.draggable.attr("data-container-html")),n.find(".panel-body").removeClass("hidden")},hoverClass:"panel-info"}).children(".panel-heading").append('<div class="pull-right pointer"><span class="delete-widget"><i class="fa fa-times-circle"></i></span></div><div class="pull-left pointer"><span class="toggle-widget"><i class="fa fa-chevron-circle-down"></i></span>&nbsp;</div>').children("small").html("")}return n.init=function(){$("#widgets .nav-pills .dropdown-menu a").on("click",(function(t){const e=$(this);$("#widgets .tab-pane").removeClass("active");const n=e.attr("data-template");return $('#widgets .tab-pane[data-template="'+n+'"]').addClass("active"),$("#widgets .selected-template").text(n),$("#widgets .nav-pills .dropdown").trigger("click"),t.preventDefault(),!1})),$("#widget-selector").on("change",(function(){$(".available-widgets [data-widget]").addClass("hide"),$('.available-widgets [data-widget="'+$(this).val()+'"]').removeClass("hide")})),$("#widget-selector").trigger("change"),function(){function n(t,e){if(e.title){const n=t.find(".panel-heading strong");n.text(n.text()+" - "+e.title)}return t.find("input, textarea, select").each((function(){const t=$(this),n=e[t.attr("name")];"checkbox"===t.attr("type")?t.prop("checked",!!n).trigger("change"):t.val(n)})),t}$.get(config.relative_path+"/api/admin/extend/widgets",(function(o){const s=o.areas;for(let t=0;t<s.length;t+=1){const e=s[t],o=$('#widgets .area[data-template="'+e.template+'"][data-location="'+e.location+'"]').find(".widget-area");o.html("");for(let t=0;t<e.data.length;t+=1){const s=e.data[t],r=$('.available-widgets [data-widget="'+s.widget+'"]').clone(!0).removeClass("hide");o.append(n(r,s.data)),i(r),a(r)}}$('[data-location="drafts"]').insertAfter($('[data-location="drafts"]').closest(".tab-content")),$("#widgets .available-widgets .widget-panel").draggable({helper:function(t){return $(t.target).parents(".widget-panel").clone()},distance:10,connectToSortable:".widget-area"}),$("#widgets .available-containers .containers > [data-container-html]").draggable({helper:function(t){let e=$(t.target);return e=e.attr("data-container-html")?e:e.parents("[data-container-html]"),e.clone().addClass("block").width(e.width()).css("opacity","0.5")},distance:10}).each((function(){$(this).attr("data-container-html",$(this).attr("data-container-html").replace(/\\\{([\s\S]*?)\\\}/g,"{$1}"))})),$("#widgets .widget-area").sortable({update:function(t,e){a(e.item),i(e.item)},connectWith:"div"}).on("click",".delete-widget",(function(){const e=$(this).parents(".widget-panel");t.confirm("[[admin/extend/widgets:alert.confirm-delete]]",(function(t){t&&e.remove()}))})).on("mouseup","> .panel > .panel-heading",(function(t){$(this).parent().is(".ui-sortable-helper")||$(t.target).closest(".delete-widget").length||$(this).parent().children(".panel-body").toggleClass("hidden")})),$("#save").on("click",(function(){const t=[];$("#widgets [data-template][data-location]").each((function(e,n){const a=(n=$(n)).attr("data-template"),i=n.attr("data-location"),o=n.children(".widget-area"),s=[];o.find(".widget-panel[data-widget]").each((function(){const t={},e=$(this).find("form").serializeArray();for(const n in e)e.hasOwnProperty(n)&&e[n].name&&(t[e[n].name]?(Array.isArray(t[e[n].name])||(t[e[n].name]=[t[e[n].name]]),t[e[n].name].push(e[n].value)):t[e[n].name]=e[n].value);s.push({widget:$(this).attr("data-widget"),data:t})})),t.push({template:a,location:i,widgets:s})})),socket.emit("admin.widgets.set",t,(function(t){t&&e.error(t),e.alert({alert_id:"admin:widgets",type:"success",title:"[[admin/extend/widgets:alert.updated]]",message:"[[admin/extend/widgets:alert.update-success]]",timeout:2500})}))})),$(".color-selector").on("click",".btn",(function(){const t=$(this),e=t.parents(".color-selector"),n=e.parents("[data-container-html]"),a=[];e.children().each((function(){a.push($(this).attr("data-class"))})),n.removeClass(a.join(" ")).addClass(t.attr("data-class")),n.attr("data-container-html",n.attr("data-container-html").replace(/class="[a-zA-Z0-9-\s]+"/,'class="'+n[0].className.replace(" pointer ui-draggable ui-draggable-handle","")+'"'))}))}))}(),function(){const t=$('[component="clone"]'),n=$('[component="clone/button"]');t.find(".dropdown-menu li").on("click",(function(){const t=$(this).find("a").text();n.translateHtml("[[admin/extend/widgets:clone-from]] <strong>"+t+"</strong>"),n.attr("data-template",t)})),n.on("click",(function(){const t=n.attr("data-template");if(!t)return e.error("[[admin/extend/widgets:error.select-clone]]");const a=$("#active-widgets .active.tab-pane[data-template] .area"),i=$('#active-widgets .tab-pane[data-template="'+t+'"] .area'),o=a.map((function(){return $(this).attr("data-location")})).get(),s=i.map((function(){const t=$(this).attr("data-location");return-1!==o.indexOf(t)?t:void 0})).get().filter((function(t){return t}));function r(e){$('#active-widgets .tab-pane[data-template="'+t+'"] [data-location="'+e+'"]').each((function(){$(this).find("[data-widget]").each((function(){const t=$(this).clone(!0);$('#active-widgets .active.tab-pane[data-template]:not([data-template="global"]) [data-location="'+e+'"] .widget-area').append(t)}))}))}for(let t=0,e=s.length;t<e;t++)r(s[t]);e.success("[[admin/extend/widgets:alert.clone-success]]")}))}()},n}.apply(e,a))||(t.exports=i)},7927:(t,e,n)=>{"use strict";var a,i;a=[n(32230),n(7237),n(85233)],i=function(t,e,n){const a={};function i(t,e){t.find("strong").translateHtml(e.title),t.find("p").translateHtml(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&s(t,e),n.fire("action:alert.update",{alert:t,params:e}),t.off("click").removeClass("pointer"),"function"==typeof e.clickfn&&t.addClass("pointer").on("click",(function(n){$(n.target).is(".close")||e.clickfn(),o(t)}))}function o(t){t.fadeOut(500,(function(){$(this).remove()}))}function s(t,e){const a=e.timeout,i=setTimeout((function(){o(t),"function"==typeof e.timeoutfn&&e.timeoutfn(t,e)}),a);t.attr("timeoutId",i),t.css("transition-property","none"),t.removeClass("animate"),setTimeout((function(){t.css("transition-property",""),t.css("transition","width "+(a+450)+"ms linear, background-color "+(a+450)+"ms ease-in"),t.addClass("animate"),n.fire("action:alert.animate",{alert:t,params:e})}),50),t.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return a.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const a=$("#"+t.alert_id);a.length?i(a,t):function(t){app.parseAndTranslate("alert",t,(function(a){let r=$("#"+t.alert_id);if(r.length)return i(r,t);r=a,r.fadeIn(200),e.get("toaster/tray").prepend(r),"function"==typeof t.closefn&&r.find("button").on("click",(function(){return t.closefn(),o(r),!1})),t.timeout&&s(r,t),"function"==typeof t.clickfn&&r.addClass("pointer").on("click",(function(e){$(e.target).is(".close")||t.clickfn(r,t),o(r)})),n.fire("action:alert.new",{alert:r,params:t})}))}(t)},a.success=function(t,e){a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:e||5e3})},a.error=function(t,e){if("[[error:revalidate-failure]]"===(t=t&&t.message||t))return socket.disconnect(),void app.reconnect();a.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:e||1e4})},a.remove=function(t){$("#alert_button_"+t).remove()},a}.apply(e,a),void 0===i||(t.exports=i)},7237:(t,e,n)=>{"use strict";var a;void 0===(a=function(){const t={};return t.core={"topic/teaser":function(t){return t?$('[component="category/topic"][data-tid="'+t+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(t,e){return $('[component="topic"][data-'+t+'="'+e+'"]')},post:function(t,e){return $('[component="post"][data-'+t+'="'+e+'"]')},"post/content":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/content"]')},"post/header":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/header"]')},"post/anchor":function(t){return $('[component="post"][data-index="'+t+'"] [component="post/anchor"]')},"post/vote-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/vote-count"]')},"post/bookmark-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/bookmark-count"]')},"user/postcount":function(t){return $('[component="user/postcount"][data-uid="'+t+'"]')},"user/reputation":function(t){return $('[component="user/reputation"][data-uid="'+t+'"]')},"category/topic":function(t,e){return $('[component="category/topic"][data-'+t+'="'+e+'"]')},"categories/category":function(t,e){return $('[component="categories/category"][data-'+t+'="'+e+'"]')},"chat/message":function(t){return $('[component="chat/message"][data-mid="'+t+'"]')},"chat/message/body":function(t){return $('[component="chat/message"][data-mid="'+t+'"] [component="chat/message/body"]')},"chat/recent/room":function(t){return $('[component="chat/recent/room"][data-roomid="'+t+'"]')}},t.get=function(){const e=Array.prototype.slice.call(arguments,1);return t.core[arguments[0]]&&e.length?t.core[arguments[0]].apply(this,e):$('[component="'+arguments[0]+'"]')},t}.call(e,n,e,t))||(t.exports=a)},66709:(t,e,n)=>{var a,i,o;!function(s){"use strict";i=[n(19755),n(87285),n(66177),n(85592),n(26891)],a=function(t){return t.widget("ui.droppable",{version:"1.13.2",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,e=this.options,n=e.accept;this.isover=!1,this.isout=!0,this.accept="function"==typeof n?n:function(t){return t.is(n)},this.proportions=function(){if(!arguments.length)return t||(t={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight});t=arguments[0]},this._addToManager(e.scope),e.addClasses&&this._addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e)},_setOption:function(e,n){if("accept"===e)this.accept="function"==typeof n?n:function(t){return t.is(n)};else if("scope"===e){var a=t.ui.ddmanager.droppables[this.options.scope];this._splice(a),this._addToManager(n)}this._super(e,n)},_activate:function(e){var n=t.ui.ddmanager.current;this._addActiveClass(),n&&this._trigger("activate",e,this.ui(n))},_deactivate:function(e){var n=t.ui.ddmanager.current;this._removeActiveClass(),n&&this._trigger("deactivate",e,this.ui(n))},_over:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._addHoverClass(),this._trigger("over",e,this.ui(n)))},_out:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this._removeHoverClass(),this._trigger("out",e,this.ui(n)))},_drop:function(e,n){var a=n||t.ui.ddmanager.current,i=!1;return!(!a||(a.currentItem||a.element)[0]===this.element[0])&&(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each((function(){var n=t(this).droppable("instance");if(n.options.greedy&&!n.options.disabled&&n.options.scope===a.options.scope&&n.accept.call(n.element[0],a.currentItem||a.element)&&t.ui.intersect(a,t.extend(n,{offset:n.element.offset()}),n.options.tolerance,e))return i=!0,!1})),!i&&!!this.accept.call(this.element[0],a.currentItem||a.element)&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(a)),this.element))},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),t.ui.intersect=function(){function t(t,e,n){return t>=e&&t<e+n}return function(e,n,a,i){if(!n.offset)return!1;var o=(e.positionAbs||e.position.absolute).left+e.margins.left,s=(e.positionAbs||e.position.absolute).top+e.margins.top,r=o+e.helperProportions.width,c=s+e.helperProportions.height,l=n.offset.left,d=n.offset.top,p=l+n.proportions().width,u=d+n.proportions().height;switch(a){case"fit":return l<=o&&r<=p&&d<=s&&c<=u;case"intersect":return l<o+e.helperProportions.width/2&&r-e.helperProportions.width/2<p&&d<s+e.helperProportions.height/2&&c-e.helperProportions.height/2<u;case"pointer":return t(i.pageY,d,n.proportions().height)&&t(i.pageX,l,n.proportions().width);case"touch":return(s>=d&&s<=u||c>=d&&c<=u||s<d&&c>u)&&(o>=l&&o<=p||r>=l&&r<=p||o<l&&r>p);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(e,n){var a,i,o=t.ui.ddmanager.droppables[e.options.scope]||[],s=n?n.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(a=0;a<o.length;a++)if(!(o[a].options.disabled||e&&!o[a].accept.call(o[a].element[0],e.currentItem||e.element))){for(i=0;i<r.length;i++)if(r[i]===o[a].element[0]){o[a].proportions().height=0;continue t}o[a].visible="none"!==o[a].element.css("display"),o[a].visible&&("mousedown"===s&&o[a]._activate.call(o[a],n),o[a].offset=o[a].element.offset(),o[a].proportions({width:o[a].element[0].offsetWidth,height:o[a].element[0].offsetHeight}))}},drop:function(e,n){var a=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),(function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,n)&&(a=this._drop.call(this,n)||a),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))})),a},dragStart:function(e,n){e.element.parentsUntil("body").on("scroll.droppable",(function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}))},drag:function(e,n){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,n),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],(function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var a,i,o,s=t.ui.intersect(e,this,this.options.tolerance,n),r=!s&&this.isover?"isout":s&&!this.isover?"isover":null;r&&(this.options.greedy&&(i=this.options.scope,(o=this.element.parents(":data(ui-droppable)").filter((function(){return t(this).droppable("instance").options.scope===i}))).length&&((a=t(o[0]).droppable("instance")).greedyChild="isover"===r)),a&&"isover"===r&&(a.isover=!1,a.isout=!0,a._out.call(a,n)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,n),a&&"isout"===r&&(a.isout=!1,a.isover=!0,a._over.call(a,n)))}}))},dragStop:function(e,n){e.element.parentsUntil("body").off("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}},!1!==t.uiBackCompat&&t.widget("ui.droppable",t.ui.droppable,{options:{hoverClass:!1,activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}}),t.ui.droppable},void 0===(o=a.apply(e,i))||(t.exports=o)}()}}]);