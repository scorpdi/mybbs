"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1677,7214,6503,3014,8894,2735,71,3684,831,7927],{7927:(e,t,o)=>{var n,r;n=[o(32230),o(7237),o(85233)],r=function(e,t,o){const n={};function r(e,t){e.find("strong").translateHtml(t.title),e.find("p").translateHtml(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&i(e,t),o.fire("action:alert.update",{alert:e,params:t}),e.off("click").removeClass("pointer"),"function"==typeof t.clickfn&&e.addClass("pointer").on("click",(function(o){$(o.target).is(".close")||t.clickfn(),a(e)}))}function a(e){e.fadeOut(500,(function(){$(this).remove()}))}function i(e,t){const n=t.timeout,r=setTimeout((function(){a(e),"function"==typeof t.timeoutfn&&t.timeoutfn(e,t)}),n);e.attr("timeoutId",r),e.css("transition-property","none"),e.removeClass("animate"),setTimeout((function(){e.css("transition-property",""),e.css("transition","width "+(n+450)+"ms linear, background-color "+(n+450)+"ms ease-in"),e.addClass("animate"),o.fire("action:alert.animate",{alert:e,params:t})}),50),e.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return n.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:(new Date).getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const n=$("#"+e.alert_id);n.length?r(n,e):function(e){app.parseAndTranslate("alert",e,(function(n){let s=$("#"+e.alert_id);if(s.length)return r(s,e);s=n,s.fadeIn(200),t.get("toaster/tray").prepend(s),"function"==typeof e.closefn&&s.find("button").on("click",(function(){return e.closefn(),a(s),!1})),e.timeout&&i(s,e),"function"==typeof e.clickfn&&s.addClass("pointer").on("click",(function(t){$(t.target).is(".close")||e.clickfn(s,e),a(s)})),o.fire("action:alert.new",{alert:s,params:e})}))}(e)},n.success=function(e,t){n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:t||5e3})},n.error=function(e,t){if("[[error:revalidate-failure]]"===(e=e&&e.message||e))return socket.disconnect(),void app.reconnect();n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:t||1e4})},n.remove=function(e){$("#alert_button_"+e).remove()},n}.apply(t,n),void 0===r||(e.exports=r)},74344:(e,t,o)=>{var n,r;n=[o(85233)],void 0===(r=(e=>{const t={},o=config.relative_path+"/api/v3";function n(t,n){async function r(o){({options:t}=await e.fire("filter:api.options",{options:t})),$.ajax(t).done((e=>{o(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})})).fail((e=>{let t;e.responseJSON&&(t=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),o(new Error(t||e.statusText))}))}if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:o+t.url,"function"!=typeof n)return new Promise(((e,t)=>{r((function(o,n){o?t(o):e(n)}))}));r(n)}return t.get=(e,t,o)=>n({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},o),t.head=(e,t,o)=>n({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},o),t.post=(e,t,o)=>n({url:e,method:"post",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},o),t.patch=(e,t,o)=>n({url:e,method:"patch",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},o),t.put=(e,t,o)=>n({url:e,method:"put",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},o),t.del=(e,t,o)=>n({url:e,method:"delete",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},o),t.delete=t.del,t}).apply(t,n))||(e.exports=r)},7237:(e,t,o)=>{var n;void 0===(n=function(){const e={};return e.core={"topic/teaser":function(e){return e?$('[component="category/topic"][data-tid="'+e+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(e,t){return $('[component="topic"][data-'+e+'="'+t+'"]')},post:function(e,t){return $('[component="post"][data-'+e+'="'+t+'"]')},"post/content":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/content"]')},"post/header":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/header"]')},"post/anchor":function(e){return $('[component="post"][data-index="'+e+'"] [component="post/anchor"]')},"post/vote-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/vote-count"]')},"post/bookmark-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/bookmark-count"]')},"user/postcount":function(e){return $('[component="user/postcount"][data-uid="'+e+'"]')},"user/reputation":function(e){return $('[component="user/reputation"][data-uid="'+e+'"]')},"category/topic":function(e,t){return $('[component="category/topic"][data-'+e+'="'+t+'"]')},"categories/category":function(e,t){return $('[component="categories/category"][data-'+e+'="'+t+'"]')},"chat/message":function(e){return $('[component="chat/message"][data-mid="'+e+'"]')},"chat/message/body":function(e){return $('[component="chat/message"][data-mid="'+e+'"] [component="chat/message/body"]')},"chat/recent/room":function(e){return $('[component="chat/recent/room"][data-roomid="'+e+'"]')}},e.get=function(){const t=Array.prototype.slice.call(arguments,1);return e.core[arguments[0]]&&t.length?e.core[arguments[0]].apply(this,t):$('[component="'+arguments[0]+'"]')},e}.call(t,o,t,e))||(e.exports=n)},2585:(e,t,o)=>{var n,r;n=[o(83713),o(70675),o(88207),o(62336)],void 0===(r=function(e,{Textcomplete:t},{TextareaEditor:o},{ContenteditableEditor:n}){var r={_active:{}};return $(window).on("action:composer.discard",(function(e,t){r._active.hasOwnProperty(t.post_uuid)&&(r._active[t.post_uuid].destroy(),delete r._active[t.post_uuid])})),r.init=function(t,o){var n,a=t.find(".write"),i="composer-autocomplete-dropdown-"+o;if(a.length){var s={element:a,strategies:[],options:{style:{"z-index":2e4},className:i+" dropdown-menu textcomplete-dropdown"}};a.on("keyup",(function(){clearTimeout(n),n=setTimeout((function(){var e=document.querySelector("."+i);if(e){var t=e.getBoundingClientRect(),o=parseFloat(e.style.marginTop,10)||0,n=window.innerHeight+o-10-t.bottom;e.style.marginTop=Math.min(n,0)+"px"}}),0)})),$(window).trigger("composer:autocomplete:init",s),r._active[o]=r.setup(s),s.element.on("textComplete:select",(function(){e.render(t)}))}},r.setup=function({element:e,strategies:r,options:a}){const i=e.get(0);if(i){var s;"TEXTAREA"===i.nodeName?s=new o(i):"DIV"===i.nodeName&&"true"===i.getAttribute("contenteditable")&&(s=new n(i)),i.setAttribute("dir",document.querySelector("html").getAttribute("data-dir"));var c=new t(s,r,{dropdown:a});return c.on("rendered",(function(){c.dropdown.items.length&&c.dropdown.items[0].activate()})),c}},r}.apply(t,n))||(e.exports=r)},83713:(e,t,o)=>{var n,r;n=[o(85233)],void 0===(r=function(e){var t={render:function(t,o){if(o=o||function(){},!t.find(".preview-container").is(":visible"))return o();var n=t.find("textarea");socket.emit("plugins.composer.renderPreview",n.val(),(function(n,r){n||((r=$("<div>"+r+"</div>")).find("img:not(.not-responsive)").addClass("img-responsive"),t.find(".preview").html(r),e.fire("action:composer.preview"),o())}))},matchScroll:function(e){if(e.find(".preview-container").is(":visible")){var t=e.find("textarea"),o=e.find(".preview");if(t.length&&o.length){var n=t[0].scrollHeight-t.height();if(0===n)return;var r=t.scrollTop()/n;o.scrollTop(Math.max(o[0].scrollHeight-o.height(),0)*r)}}},handleToggler:function(e){t.env=utils.findBootstrapEnvironment();var o=e.find(".write-container .toggle-preview"),n=e.find(".preview-container .toggle-preview"),r=$(".preview-container"),a=$(".write-container");function i(){c(!1),"xs"!==t.env&&"sm"!==t.env&&localStorage.setItem("composer:previewToggled",!0)}function s(){c(!0),"xs"!==t.env&&"sm"!==t.env&&localStorage.removeItem("composer:previewToggled")}function c(n){"xs"===t.env||"sm"===t.env?(r.toggleClass("hide",!1),a.toggleClass("maximized",!1),o.toggleClass("hide",!0),r.toggleClass("hidden-xs hidden-sm",!n),a.toggleClass("hidden-xs hidden-sm",n),n&&t.render(e)):(r.toggleClass("hide",!n),a.toggleClass("maximized",!n),o.toggleClass("hide",n)),t.matchScroll(e)}t.toggle=c,n.on("click",(function(){i(),e.find(".write").focus()})),o.on("click",(function(){s(),e.find(".write").focus()})),localStorage.getItem("composer:previewToggled")||"xs"===t.env||"sm"===t.env?i():s()}};return t}.apply(t,n))||(e.exports=r)},57667:(e,t,o)=>{var n,r;n=[o(7237),o(2585),o(74344),o(7927),o(33371)],void 0===(r=function(e,t,o,n,r){return{init:function(){var a=e.get("topic/quickreply/text"),i={element:a,strategies:[],options:{style:{"z-index":100}}};$(window).trigger("composer:autocomplete:init",i),t._active.persona_qr=t.setup(i),r.init({dragDropAreaEl:$('[component="topic/quickreply/container"] .quickreply-message'),pasteEl:a,uploadFormEl:$('[component="topic/quickreply/upload"]'),inputEl:a,route:"/api/post/upload",callback:function(e){let t=a.val();e.forEach((e=>{t=t+(t?"\n":"")+(e.isImage?"!":"")+`[${e.filename}](${e.url})`})),a.val(t)}});var s=!0;e.get("topic/quickreply/button").on("click",(function(r){if(r.preventDefault(),s){var a=e.get("topic/quickreply/text").val(),i={tid:ajaxify.data.tid,handle:void 0,content:a};s=!1,o.post(`/topics/${ajaxify.data.tid}`,i,(function(o,r){if(s=!0,o)return n.error(o);r&&r.queued&&n.alert({type:"success",title:"[[global:alert.success]]",message:r.message,timeout:1e4,clickfn:function(){ajaxify.go(`/post-queue/${r.id}`)}}),e.get("topic/quickreply/text").val(""),t._active.persona_qr.hide()}))}}))}}}.apply(t,n))||(e.exports=r)},33371:(e,t,o)=>{var n,r;n=[o(7927)],void 0===(r=function(e){const t={init:function(e){const o=e.uploadFormEl;o.length&&(o.attr("action",config.relative_path+e.route),e.dragDropAreaEl&&t.handleDragDrop({container:e.dragDropAreaEl,callback:function(n){t.ajaxSubmit({uploadForm:o,upload:n,callback:e.callback})}}),e.pasteEl&&t.handlePaste({container:e.pasteEl,callback:function(n){t.ajaxSubmit({uploadForm:o,upload:n,callback:e.callback})}}))},handleDragDrop:function(e){let t=!1;const o=e.container,n=e.container.find(".imagedrop");function r(e){return e.preventDefault(),!1}o.on("dragenter",(function(){t||(n.css("top","0px"),n.css("height",o.height()+"px"),n.css("line-height",o.height()+"px"),n.show(),n.on("dragleave",(function(){n.hide(),n.off("dragleave")})))})),n.on("drop",(function(t){t.preventDefault();const o=t.originalEvent.dataTransfer.files;if(o.length){let t;if(window.FormData){t=new FormData;for(var r=0;r<o.length;++r)t.append("files[]",o[r],o[r].name)}e.callback({files:o,formData:t})}return n.hide(),!1})),$(document).off("dragstart").on("dragstart",(function(){t=!0})).off("dragend").on("dragend, mouseup",(function(){t=!1})),n.on("dragover",r),n.on("dragenter",r)},handlePaste:function(e){e.container.on("paste",(function(t){const o=(t.clipboardData||t.originalEvent.clipboardData||{}).items,n=[],r=[];let a=null;window.FormData&&(a=new FormData),[].forEach.call(o,(function(e){const t=e.getAsFile();if(t){const e=utils.generateUUID()+"-"+t.name;a&&a.append("files[]",t,e),n.push(t),r.push(e)}})),n.length&&e.callback({files:n,fileNames:r,formData:a})}))},ajaxSubmit:function(t){const o=[...t.upload.files];for(let n=0;n<o.length;++n){const r=o[n].type.match(/image./);if(r&&!app.user.privileges["upload:post:image"]||!r&&!app.user.privileges["upload:post:file"])return e.error("[[error:no-privileges]]");if(o[n].size>1024*parseInt(config.maximumFileSize,10))return t.uploadForm[0].reset(),e.error("[[error:file-too-big, "+config.maximumFileSize+"]]")}const n=Date.now();t.uploadForm.off("submit").on("submit",(function(){return $(this).ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},resetForm:!0,clearForm:!0,formData:t.upload.formData,error:function(t){let o=t.responseJSON&&(t.responseJSON.error||t.responseJSON.status&&t.responseJSON.status.message)||"[[error:parse-error]]";t&&413===t.status&&(o=t.statusText||"Request Entity Too Large"),e.error(o),e.remove(n)},uploadProgress:function(t,o,r,a){e.alert({alert_id:n,message:"[[modules:composer.uploading, "+a+"%]]"})},success:function(e){const n=e.response.images;if(n&&n.length)for(var r=0;r<n.length;++r)n[r].filename=o[r].name,n[r].isImage=/image./.test(o[r].type);t.callback(n)},complete:function(){t.uploadForm[0].reset(),setTimeout(e.remove,100,n)}}),!1})),t.uploadForm.submit()}};return t}.apply(t,n))||(e.exports=r)}}]);