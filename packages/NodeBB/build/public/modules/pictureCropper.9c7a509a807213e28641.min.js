"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[2550,7214,6503,71,7927],{7927:(t,e,o)=>{var n,a;n=[o(32230),o(7237),o(85233)],a=function(t,e,o){const n={};function a(t,e){t.find("strong").translateHtml(e.title),t.find("p").translateHtml(e.message),t.attr("class","alert alert-dismissable alert-"+e.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),e.timeout&&r(t,e),o.fire("action:alert.update",{alert:t,params:e}),t.off("click").removeClass("pointer"),"function"==typeof e.clickfn&&t.addClass("pointer").on("click",(function(o){$(o.target).is(".close")||e.clickfn(),i(t)}))}function i(t){t.fadeOut(500,(function(){$(this).remove()}))}function r(t,e){const n=e.timeout,a=setTimeout((function(){i(t),"function"==typeof e.timeoutfn&&e.timeoutfn(t,e)}),n);t.attr("timeoutId",a),t.css("transition-property","none"),t.removeClass("animate"),setTimeout((function(){t.css("transition-property",""),t.css("transition","width "+(n+450)+"ms linear, background-color "+(n+450)+"ms ease-in"),t.addClass("animate"),o.fire("action:alert.animate",{alert:t,params:e})}),50),t.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return n.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const n=$("#"+t.alert_id);n.length?a(n,t):function(t){app.parseAndTranslate("alert",t,(function(n){let s=$("#"+t.alert_id);if(s.length)return a(s,t);s=n,s.fadeIn(200),e.get("toaster/tray").prepend(s),"function"==typeof t.closefn&&s.find("button").on("click",(function(){return t.closefn(),i(s),!1})),t.timeout&&r(s,t),"function"==typeof t.clickfn&&s.addClass("pointer").on("click",(function(e){$(e.target).is(".close")||t.clickfn(s,t),i(s)})),o.fire("action:alert.new",{alert:s,params:t})}))}(t)},n.success=function(t,e){n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:e||5e3})},n.error=function(t,e){if("[[error:revalidate-failure]]"===(t=t&&t.message||t))return socket.disconnect(),void app.reconnect();n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:e||1e4})},n.remove=function(t){$("#alert_button_"+t).remove()},n}.apply(e,n),void 0===a||(t.exports=a)},7237:(t,e,o)=>{var n;void 0===(n=function(){const t={};return t.core={"topic/teaser":function(t){return t?$('[component="category/topic"][data-tid="'+t+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(t,e){return $('[component="topic"][data-'+t+'="'+e+'"]')},post:function(t,e){return $('[component="post"][data-'+t+'="'+e+'"]')},"post/content":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/content"]')},"post/header":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/header"]')},"post/anchor":function(t){return $('[component="post"][data-index="'+t+'"] [component="post/anchor"]')},"post/vote-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/vote-count"]')},"post/bookmark-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/bookmark-count"]')},"user/postcount":function(t){return $('[component="user/postcount"][data-uid="'+t+'"]')},"user/reputation":function(t){return $('[component="user/reputation"][data-uid="'+t+'"]')},"category/topic":function(t,e){return $('[component="category/topic"][data-'+t+'="'+e+'"]')},"categories/category":function(t,e){return $('[component="categories/category"][data-'+t+'="'+e+'"]')},"chat/message":function(t){return $('[component="chat/message"][data-mid="'+t+'"]')},"chat/message/body":function(t){return $('[component="chat/message"][data-mid="'+t+'"] [component="chat/message/body"]')},"chat/recent/room":function(t){return $('[component="chat/recent/room"][data-roomid="'+t+'"]')}},t.get=function(){const e=Array.prototype.slice.call(arguments,1);return t.core[arguments[0]]&&e.length?t.core[arguments[0]].apply(this,e):$('[component="'+arguments[0]+'"]')},t}.call(e,o,e,t))||(t.exports=n)},98192:(t,e,o)=>{var n,a;n=[o(7927)],a=function(t){const e={};function n(e,o){let n;try{n=o.imageType?e.getCroppedCanvas().toDataURL(o.imageType):e.getCroppedCanvas().toDataURL()}catch(e){return void(-1!==["The operation is insecure.","Failed to execute 'toDataURL' on 'HTMLCanvasElement': Tainted canvases may not be exported."].indexOf(e.message)?t.error("[[error:cors-error]]"):t.error(e.message))}return n}return e.show=function(t,n){const a=!(!t.hasOwnProperty("fileSize")||void 0===t.fileSize)&&parseInt(t.fileSize,10);app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:!t.hasOwnProperty("showHelp")||void 0===t.showHelp||t.showHelp,fileSize:a,title:t.title||"[[global:upload_file]]",description:t.description||"",button:t.button||"[[global:upload]]",accept:t.accept?t.accept.replace(/,/g,"&#44; "):""},(function(a){a.modal("show"),a.on("hidden.bs.modal",(function(){a.remove()}));const i=a.find("#uploadForm");t.route&&i.attr("action",t.route),a.find("#fileUploadSubmitBtn").on("click",(function(){return $(this).addClass("disabled"),t.uploadModal=a,function(t,n){function a(e,o){"error"===e&&t.uploadModal.find("#fileUploadSubmitBtn").removeClass("disabled"),t.uploadModal.find("#alert-"+e).translateText(o).removeClass("hide")}const i=t.uploadModal.find("#fileInput");if(!i.val())return a("error","[[uploads:select-file-to-upload]]");const r=i[0].files[0],s=!(!t.hasOwnProperty("fileSize")||void 0===t.fileSize)&&parseInt(t.fileSize,10);if(s&&r.size>1024*s)return a("error","[[error:file-too-big, "+s+"]]");if(r.name.endsWith(".gif"))return void o.e(3564).then((function(){var e=[o(50431)];(function(e){e.ajaxSubmit(t.uploadModal,n)}).apply(null,e)})).catch(o.oe);const c=new FileReader;c.addEventListener("load",(function(){const o=c.result;t.uploadModal.modal("hide"),e.handleImageCrop({url:o,imageType:r.type,socketMethod:t.socketMethod,aspectRatio:t.aspectRatio,allowSkippingCrop:t.allowSkippingCrop,restrictImageDimension:t.restrictImageDimension,imageDimension:t.imageDimension,paramName:t.paramName,paramValue:t.paramValue},n)}),!1),r&&c.readAsDataURL(r)}(t,n),!1}))}))},e.handleImageCrop=function(e,a){$("#crop-picture-modal").remove(),app.parseAndTranslate("modals/crop_picture",{url:utils.escapeHTML(e.url)},(async function(i){i.modal({backdrop:"static"}).modal("show");const r=parseInt($(window).height()/2,10),s=document.getElementById("cropped-image");$(s).css("max-height",r);let c=new(0,(await o.e(1649).then(o.t.bind(o,33129,23))).default)(s,{aspectRatio:e.aspectRatio,autoCropArea:1,viewMode:1,checkCrossOrigin:!0,cropmove:function(){e.restrictImageDimension&&(c.cropBoxData.width>e.imageDimension&&c.setCropBoxData({width:e.imageDimension}),c.cropBoxData.height>e.imageDimension&&c.setCropBoxData({height:e.imageDimension}))},ready:function(){if(!n(c,e))return i.modal("hide");if(e.restrictImageDimension){const t=s.width<s.height?s.width:s.height,o=t>e.imageDimension?e.imageDimension:t;c.setCropBoxData({width:o,height:o})}i.find(".rotate").on("click",(function(){const t=this.getAttribute("data-degrees");c.rotate(t)})),i.find(".flip").on("click",(function(){const t=this.getAttribute("data-option");"scaleX"===this.getAttribute("data-method")?c.scaleX(t):c.scaleY(t),this.setAttribute("data-option",-1*t)})),i.find(".reset").on("click",(function(){c.reset()})),i.find(".crop-btn").on("click",(function(){$(this).addClass("disabled");const o=n(c,e);o&&(i.find("#upload-progress-bar").css("width","0%"),i.find("#upload-progress-box").show().removeClass("hide"),function(e,o){const n={};n[e.data.paramName]=e.data.paramValue,n.method=e.data.socketMethod,n.size=e.imageData.length,n.progress=0;const a=1e5;!function i(){const r=e.imageData.slice(n.progress,n.progress+a);socket.emit("uploads.upload",{chunk:r,params:n},(function(s,c){return s?t.error(s):n.progress+a<n.size?(n.progress+=r.length,e.progressBarEl.css("width",(n.progress/n.size*100).toFixed(2)+"%"),setTimeout(i,100)):(e.progressBarEl.css("width","100%"),void o(null,c))}))}()}({data:e,imageData:o,progressBarEl:i.find("#upload-progress-bar")},(function(e,o){if(e)return i.find("#upload-progress-box").hide(),i.find(".upload-btn").removeClass("disabled"),i.find(".crop-btn").removeClass("disabled"),t.error(e);a(o.url),i.modal("hide")})))})),i.find(".upload-btn").on("click",(async function(){$(this).addClass("disabled"),c.destroy();const t=(await o.e(1649).then(o.t.bind(o,33129,23))).default;c=new t(s,{viewMode:1,autoCropArea:1,ready:function(){i.find(".crop-btn").trigger("click")}})}))}})}))},e}.apply(e,n),void 0===a||(t.exports=a)}}]);