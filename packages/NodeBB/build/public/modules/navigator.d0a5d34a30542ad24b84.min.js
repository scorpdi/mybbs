"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[8786,7214,6503,2344,71,7927],{78989:(t,o,n)=>{var e,i;e=[n(31369)],void 0===(i=function(t){const o={init:function(){$("body").on("click",'[component="pagination/select-page"]',(function(){return t.prompt("[[global:enter_page_number]]",(function(t){o.loadPage(t)})),!1}))},loadPage:function(t,o){if(o=o||function(){},t=parseInt(t,10),!utils.isNumber(t)||t<1||t>ajaxify.data.pagination.pageCount)return;const n=utils.params();n.page=t;const e=window.location.pathname+"?"+$.param(n);ajaxify.go(e,o)},nextPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage+1,t)},previousPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage-1,t)}};return o}.apply(o,e))||(t.exports=i)},7927:(t,o,n)=>{var e,i;e=[n(32230),n(7237),n(85233)],i=function(t,o,n){const e={};function i(t,o){t.find("strong").translateHtml(o.title),t.find("p").translateHtml(o.message),t.attr("class","alert alert-dismissable alert-"+o.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),o.timeout&&c(t,o),n.fire("action:alert.update",{alert:t,params:o}),t.off("click").removeClass("pointer"),"function"==typeof o.clickfn&&t.addClass("pointer").on("click",(function(n){$(n.target).is(".close")||o.clickfn(),a(t)}))}function a(t){t.fadeOut(500,(function(){$(this).remove()}))}function c(t,o){const e=o.timeout,i=setTimeout((function(){a(t),"function"==typeof o.timeoutfn&&o.timeoutfn(t,o)}),e);t.attr("timeoutId",i),t.css("transition-property","none"),t.removeClass("animate"),setTimeout((function(){t.css("transition-property",""),t.css("transition","width "+(e+450)+"ms linear, background-color "+(e+450)+"ms ease-in"),t.addClass("animate"),n.fire("action:alert.animate",{alert:t,params:o})}),50),t.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return e.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const e=$("#"+t.alert_id);e.length?i(e,t):function(t){app.parseAndTranslate("alert",t,(function(e){let r=$("#"+t.alert_id);if(r.length)return i(r,t);r=e,r.fadeIn(200),o.get("toaster/tray").prepend(r),"function"==typeof t.closefn&&r.find("button").on("click",(function(){return t.closefn(),a(r),!1})),t.timeout&&c(r,t),"function"==typeof t.clickfn&&r.addClass("pointer").on("click",(function(o){$(o.target).is(".close")||t.clickfn(r,t),a(r)})),n.fire("action:alert.new",{alert:r,params:t})}))}(t)},e.success=function(t,o){e.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:o||5e3})},e.error=function(t,o){if("[[error:revalidate-failure]]"===(t=t&&t.message||t))return socket.disconnect(),void app.reconnect();e.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:o||1e4})},e.remove=function(t){$("#alert_button_"+t).remove()},e}.apply(o,e),void 0===i||(t.exports=i)},7237:(t,o,n)=>{var e;void 0===(e=function(){const t={};return t.core={"topic/teaser":function(t){return t?$('[component="category/topic"][data-tid="'+t+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(t,o){return $('[component="topic"][data-'+t+'="'+o+'"]')},post:function(t,o){return $('[component="post"][data-'+t+'="'+o+'"]')},"post/content":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/content"]')},"post/header":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/header"]')},"post/anchor":function(t){return $('[component="post"][data-index="'+t+'"] [component="post/anchor"]')},"post/vote-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/vote-count"]')},"post/bookmark-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/bookmark-count"]')},"user/postcount":function(t){return $('[component="user/postcount"][data-uid="'+t+'"]')},"user/reputation":function(t){return $('[component="user/reputation"][data-uid="'+t+'"]')},"category/topic":function(t,o){return $('[component="category/topic"][data-'+t+'="'+o+'"]')},"categories/category":function(t,o){return $('[component="categories/category"][data-'+t+'="'+o+'"]')},"chat/message":function(t){return $('[component="chat/message"][data-mid="'+t+'"]')},"chat/message/body":function(t){return $('[component="chat/message"][data-mid="'+t+'"] [component="chat/message/body"]')},"chat/recent/room":function(t){return $('[component="chat/recent/room"][data-roomid="'+t+'"]')}},t.get=function(){const o=Array.prototype.slice.call(arguments,1);return t.core[arguments[0]]&&o.length?t.core[arguments[0]].apply(this,o):$('[component="'+arguments[0]+'"]')},t}.call(o,n,o,t))||(t.exports=e)},42840:(t,o,n)=>{var e,i;e=[n(78989),n(7237),n(85233),n(7927)],void 0===(i=function(t,o,n,e){const i={};let a,c,r,s,l,p=0,f=0,u=!1,d=!0;i.scrollActive=!1;let g,m,h,w,y,x=$(".pagination-block"),b=x.find(".pagination-text"),v=x.find("meter"),T=x.find(".progress-bar");$(window).on("action:ajaxify.start",(function(){$(window).off("keydown",A)})),i.init=function(t,o,e,a,f){p=0,i.selector=t,i.callback=f,i.toTop=e||function(){},i.toBottom=a||function(){},x=$(".pagination-block"),b=x.find(".pagination-text"),v=x.find("meter"),T=x.find(".progress-bar"),h=$(".scroller-thumb-icon"),w=h.height(),y=w/2,g=$(".scroller-thumb"),m=g.find(".thumb-text"),$(window).off("scroll",i.delayedUpdate).on("scroll",i.delayedUpdate),x.find(".dropdown-menu").off("click").on("click",(function(t){t.stopPropagation()})),x.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",(function(){setTimeout((async function(){"lg"===utils.findBootstrapEnvironment()&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&x.find("#myNextPostBtn").removeAttr("disabled")}),100)})),x.find(".pageup").off("click").on("click",i.scrollUp),x.find(".pagedown").off("click").on("click",i.scrollDown),x.find(".pagetop").off("click").on("click",i.toTop),x.find(".pagebottom").off("click").on("click",i.toBottom),x.find("#myNextPostBtn").off("click").on("click",P),x.find("input").on("keydown",(function(t){if(13===t.which){const t=$(this);if(!utils.isNumber(t.val()))return void t.val("");const o=B(parseInt(t.val(),10));t.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(o)}})),ajaxify.data.template.topic&&function(){if(!g.length)return;const t=g.parent();function o(o){const n=(I(o-y)-t.offset().top)/(t.height()-w);return p=Math.max(1,Math.ceil(ajaxify.data.postcount*n)),p>ajaxify.data.postcount?ajaxify.data.count:p}t.on("click",(function(t){if($(t.target).hasClass("scroller-container")){const n=o(t.pageY);return i.scrollToIndex(n-1,!0,0),!1}}));let e=!1;function a(){$(window).off("mousemove",f),e&&(i.scrollToIndex(p-1,!0,0),x.find('[data-toggle="dropdown"]').trigger("click")),M(),e=!1,d=!1}function f(t){const n=I(t.pageY-y);g.offset({top:n,left:g.offset().left});const e=o(t.pageY);return i.updateTextAndProgressBar(),m.text(e+"/"+ajaxify.data.postcount),d&&h(),d=!1,t.stopPropagation(),!1}function h(){M(),c=setInterval((function(){C(p)}),250)}n.on("action:ajaxify.end",(function(){l=null})),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",(function(){j(p)})),g.on("mousedown",(function(){e=!0,$(window).on("mousemove",f),d=!0})),$(window).off("mousemove",f),$(window).off("mouseup",a).on("mouseup",a),g.on("touchstart",(function(t){u=!0,r=Math.min($(window).width(),Math.max(0,t.touches[0].clientX)),s=Math.min($(window).height(),Math.max(0,t.touches[0].clientY)),d=!0})),g.on("touchmove",(function(t){const n=$(window).width(),e=$(window).height(),a=Math.abs(r-Math.min(n,Math.max(0,t.touches[0].clientX))),c=Math.abs(s-Math.min(e,Math.max(0,t.touches[0].clientY)));if(r=Math.min(n,Math.max(0,t.touches[0].clientX)),s=Math.min(e,Math.max(0,t.touches[0].clientY)),c>=a&&d&&(u=!0,h()),u&&t.cancelable){t.preventDefault(),t.stopPropagation();const n=I(s+$(window).scrollTop()-y);g.offset({top:n,left:g.offset().left});const e=o(s+$(window).scrollTop());i.updateTextAndProgressBar(),m.text(e+"/"+ajaxify.data.postcount),d&&C(e)}d=!1})),g.on("touchend",(function(){M(),u&&(i.scrollToIndex(p-1,!0,0),u=!1,x.find('[data-toggle="dropdown"]').trigger("click"))}))}(),config.usePagination||$(window).off("keydown",A).on("keydown",A),i.setCount(o),i.update(0)};let k=0;async function P(){async function t(t){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,t),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let o=await t(p);k===o&&(o=await t(o)),o&&p!==o+1?(k=o,$(window).one("action:ajaxify.end",(function(){x.find(".dropdown-menu").is(":hidden")&&x.find(".dropdown-toggle").dropdown("toggle")})),i.scrollToIndex(o,!0,0)):(e.alert({message:"[[topic:no-more-next-post]]",type:"info"}),k=1)}}function I(t){const o=g.parent(),n=o.offset();return t<n.top?t=n.top:t>n.top+o.height()-w&&(t=n.top+o.height()-w),t}function j(t){if(!g.length||g.is(":hidden"))return;const o=g.parent(),n=o.offset();let e=(t-1)/ajaxify.data.postcount;t===f&&(e=1);const i={top:I(n.top+(o.height()-w)*e),left:g.offset().left};g.offset(i),m.text(t+"/"+ajaxify.data.postcount),C(t)}function M(){c&&(clearInterval(c),c=0)}function C(t,o){o=o||function(){},l===t||x.find(".post-content").is(":hidden")||(l=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},(function(t,n){if(t)return e.error(t);app.parseAndTranslate("partials/topic/navigation-post",{post:n},(function(t){x.find(".post-content").html(t).find(".timeago").timeago()})),o()})))}function A(t){if("BODY"===t.target.nodeName){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(36===t.which&&i.toTop)return i.toTop(),!1;if(35===t.which&&i.toBottom)return i.toBottom(),!1}}function B(t){const o=window.location.pathname.replace(config.relative_path,"").split("/");return o[1]+"/"+o[2]+"/"+o[3]+(t?"/"+t:"")}function _(t){const o=ajaxify.removeRelativePath(window.location.pathname.slice(1));(!t||o.startsWith("topic")||o.startsWith("category"))&&x.toggleClass("ready",t)}return i.setCount=function(t){(t=parseInt(t,10))!==f&&(f=t,i.updateTextAndProgressBar())},i.show=function(){_(!0)},i.disable=function(){f=0,p=1,i.callback=null,i.selector=null,$(window).off("scroll",i.delayedUpdate),_(!1)},i.delayedUpdate=function(){a||(a=setTimeout((function(){i.update(),a=void 0}),100))},i.update=function(t){t="number"==typeof t?t:void 0;let n=p;const e=$(i.selector);e.length&&(n=parseInt(e.first().attr("data-index"),10)+1);const a=$(window).scrollTop(),c=$(window).height(),r=$(document).height(),s=a+c/2;let l=Number.MAX_VALUE;e.each((function(){const t=$(this),o=parseInt(t.attr("data-index"),10);if(o>=0){const e=Math.abs(s-(t.offset().top+t.outerHeight(!0)/2));if(e>l)return!1;e<l&&(n=o+1,l=e)}}));const u=0===a&&0===parseInt(e.first().attr("data-index"),10),d=a+c>r-100&&parseInt(e.last().attr("data-index"),10)===f-1;if(u?n=1:d&&(n=f),void 0===t&&ajaxify.data.template.topic)if(u)t=0;else{const n=o.get("post/anchor",p-1);n.length&&(t=n.get(0).getBoundingClientRect().top)}"function"==typeof i.callback&&i.callback(n,f,t),n!==p&&(p=n,i.updateTextAndProgressBar(),j(p)),_(!!f)},i.updateTextAndProgressBar=function(){if(!utils.isNumber(p))return;p=p>f?f:p,b.translateHtml("[[global:pagination.out_of, "+p+", "+f+"]]");const t=(p-1)/(f-1||1);v.val(t),T.width(100*t+"%")},i.scrollUp=function(){const o=$(window);if(config.usePagination&&o.scrollTop()<=0)return t.previousPage((function(){$("body,html").scrollTop($(document).height()-o.height())}));$("body,html").animate({scrollTop:o.scrollTop()-o.height()})},i.scrollDown=function(){const o=$(window);if(config.usePagination&&o.scrollTop()>=$(document).height()-o.height())return t.nextPage();$("body,html").animate({scrollTop:o.scrollTop()+o.height()})},i.scrollTop=function(t){$(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):ajaxify.go(B())},i.scrollBottom=function(t){parseInt(t,10)<0||($(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(B(t))))},i.scrollToIndex=function(n,e,a){const c=!!o.get("topic").length,r=!!o.get("category").length;if(!utils.isNumber(n)||!c&&!r)return;if(a=void 0!==a?a:400,i.scrollActive=!0,c&&o.get("post/anchor",n).length)return i.scrollToPostIndex(n,e,a);if(r&&$('[component="category/topic"][data-index="'+n+'"]').length)return i.scrollToTopicIndex(n,e,a);if(!config.usePagination)return i.scrollActive=!1,n=parseInt(n,10)+1,void ajaxify.go(B(n));const s=c?i.scrollToPostIndex:i.scrollToTopicIndex,l=1+Math.floor(n/config.postsPerPage);parseInt(l,10)!==ajaxify.data.pagination.currentPage?t.loadPage(l,(function(){s(n,e,a)})):s(n,e,a)},i.scrollToPostIndex=function(t,n,e){const a=o.get("post","index",t);i.scrollToElement(a,n,e)},i.scrollToTopicIndex=function(t,o,n){const e=$('[component="category/topic"][data-index="'+t+'"]');i.scrollToElement(e,o,n)},i.scrollToElement=function(t,n,e){if(!t.length)return void(i.scrollActive=!1);const a=t.outerHeight(!0),c=o.get("navbar").outerHeight(!0),r=$(".topic-header").outerHeight(!0)||0,s=$(window).height();$(window).off("scroll",i.delayedUpdate),e=void 0!==e?e:400,i.scrollActive=!0;let l=!1;!function(){function o(){$(window).on("scroll",i.delayedUpdate);const o=t.get(0).getBoundingClientRect();i.update(o.top)}function p(){l?o():(l=!0,i.scrollActive=!1,n&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout((function(){t.removeClass("highlight")}),1e4)),$("body").scrollTop($("body").scrollTop()-1),$("html").scrollTop($("html").scrollTop()-1))}let f=0;if(f=a<s-c-r?t.offset().top-s/2+a/2:t.offset().top-c-r,0===e)return $(window).scrollTop(f),p(),void o();$("html, body").animate({scrollTop:f+"px"},e,p)}()},i}.apply(o,e))||(t.exports=i)}}]);