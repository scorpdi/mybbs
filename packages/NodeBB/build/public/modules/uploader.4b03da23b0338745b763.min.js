"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[3564],{50431:(e,o,r)=>{var s,t;s=[r(86569)],t=function(){const e={};function o(o,r,s){e.hideAlerts(o),"error"===r&&o.find("#fileUploadSubmitBtn").removeClass("disabled"),o.find("#alert-"+r).translateText(s).removeClass("hide")}function r(e){if("string"==typeof e)try{return $.parseJSON(e)}catch(e){return{error:"[[error:parse-error]]"}}return e}return e.show=function(r,s){const t=!(!r.hasOwnProperty("fileSize")||void 0===r.fileSize)&&parseInt(r.fileSize,10);app.parseAndTranslate("partials/modals/upload_file_modal",{showHelp:!r.hasOwnProperty("showHelp")||void 0===r.showHelp||r.showHelp,fileSize:t,title:r.title||"[[global:upload_file]]",description:r.description||"",button:r.button||"[[global:upload]]",accept:r.accept?r.accept.replace(/,/g,"&#44; "):""},(function(i){i.modal("show"),i.on("hidden.bs.modal",(function(){i.remove()}));const a=i.find("#uploadForm");a.attr("action",r.route),a.find("#params").val(JSON.stringify(r.params)),i.find("#fileUploadSubmitBtn").on("click",(function(){$(this).addClass("disabled"),a.submit()})),a.submit((function(){return function(r,s,t){o(r,"status","[[uploads:uploading-file]]"),r.find("#upload-progress-bar").css("width","0%"),r.find("#upload-progress-box").show().removeClass("hide");const i=r.find("#fileInput");return i.val()?(a=i[0],n=s,!window.FileReader||!n||a.files[0].size<=1e3*n?void e.ajaxSubmit(r,t):o(r,"error","[[error:file-too-big, "+s+"]]")):o(r,"error","[[uploads:select-file-to-upload]]");var a,n}(i,t,s),!1}))}))},e.hideAlerts=function(e){$(e).find("#alert-status, #alert-success, #alert-error, #upload-progress-box").addClass("hide")},e.ajaxSubmit=function(s,t){s.find("#uploadForm").ajaxSubmit({headers:{"x-csrf-token":config.csrf_token},error:function(e){e=r(e),o(s,"error",e.responseJSON?e.responseJSON.error||e.statusText:"error uploading, code : "+e.status)},uploadProgress:function(e,o,r,t){s.find("#upload-progress-bar").css("width",t+"%")},success:function(i){let a=r(i);i.hasOwnProperty("response")&&i.hasOwnProperty("status")&&"ok"===i.status.code&&(a=i.response.images),t(a[0].url),o(s,"success","[[uploads:upload-success]]"),setTimeout((function(){e.hideAlerts(s),s.modal("hide")}),750)}})},e}.apply(o,s),void 0===t||(e.exports=t)}}]);