"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[3892,7214,6503,2344,8786,71,8306,7927],{78989:(t,o,e)=>{var n,i;n=[e(31369)],void 0===(i=function(t){const o={init:function(){$("body").on("click",'[component="pagination/select-page"]',(function(){return t.prompt("[[global:enter_page_number]]",(function(t){o.loadPage(t)})),!1}))},loadPage:function(t,o){if(o=o||function(){},t=parseInt(t,10),!utils.isNumber(t)||t<1||t>ajaxify.data.pagination.pageCount)return;const e=utils.params();e.page=t;const n=window.location.pathname+"?"+$.param(e);ajaxify.go(n,o)},nextPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage+1,t)},previousPage:function(t){o.loadPage(ajaxify.data.pagination.currentPage-1,t)}};return o}.apply(o,n))||(t.exports=i)},7927:(t,o,e)=>{var n,i;n=[e(32230),e(7237),e(85233)],i=function(t,o,e){const n={};function i(t,o){t.find("strong").translateHtml(o.title),t.find("p").translateHtml(o.message),t.attr("class","alert alert-dismissable alert-"+o.type+" clearfix"),clearTimeout(parseInt(t.attr("timeoutId"),10)),o.timeout&&c(t,o),e.fire("action:alert.update",{alert:t,params:o}),t.off("click").removeClass("pointer"),"function"==typeof o.clickfn&&t.addClass("pointer").on("click",(function(e){$(e.target).is(".close")||o.clickfn(),a(t)}))}function a(t){t.fadeOut(500,(function(){$(this).remove()}))}function c(t,o){const n=o.timeout,i=setTimeout((function(){a(t),"function"==typeof o.timeoutfn&&o.timeoutfn(t,o)}),n);t.attr("timeoutId",i),t.css("transition-property","none"),t.removeClass("animate"),setTimeout((function(){t.css("transition-property",""),t.css("transition","width "+(n+450)+"ms linear, background-color "+(n+450)+"ms ease-in"),t.addClass("animate"),e.fire("action:alert.animate",{alert:t,params:o})}),50),t.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return n.alert=function(t){t.alert_id="alert_button_"+(t.alert_id?t.alert_id:(new Date).getTime()),t.title=t.title&&t.title.trim()||"",t.message=t.message?t.message.trim():"",t.type=t.type||"info";const n=$("#"+t.alert_id);n.length?i(n,t):function(t){app.parseAndTranslate("alert",t,(function(n){let r=$("#"+t.alert_id);if(r.length)return i(r,t);r=n,r.fadeIn(200),o.get("toaster/tray").prepend(r),"function"==typeof t.closefn&&r.find("button").on("click",(function(){return t.closefn(),a(r),!1})),t.timeout&&c(r,t),"function"==typeof t.clickfn&&r.addClass("pointer").on("click",(function(o){$(o.target).is(".close")||t.clickfn(r,t),a(r)})),e.fire("action:alert.new",{alert:r,params:t})}))}(t)},n.success=function(t,o){n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:t,type:"success",timeout:o||5e3})},n.error=function(t,o){if("[[error:revalidate-failure]]"===(t=t&&t.message||t))return socket.disconnect(),void app.reconnect();n.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:t,type:"danger",timeout:o||1e4})},n.remove=function(t){$("#alert_button_"+t).remove()},n}.apply(o,n),void 0===i||(t.exports=i)},7237:(t,o,e)=>{var n;void 0===(n=function(){const t={};return t.core={"topic/teaser":function(t){return t?$('[component="category/topic"][data-tid="'+t+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(t,o){return $('[component="topic"][data-'+t+'="'+o+'"]')},post:function(t,o){return $('[component="post"][data-'+t+'="'+o+'"]')},"post/content":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/content"]')},"post/header":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/header"]')},"post/anchor":function(t){return $('[component="post"][data-index="'+t+'"] [component="post/anchor"]')},"post/vote-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/vote-count"]')},"post/bookmark-count":function(t){return $('[component="post"][data-pid="'+t+'"] [component="post/bookmark-count"]')},"user/postcount":function(t){return $('[component="user/postcount"][data-uid="'+t+'"]')},"user/reputation":function(t){return $('[component="user/reputation"][data-uid="'+t+'"]')},"category/topic":function(t,o){return $('[component="category/topic"][data-'+t+'="'+o+'"]')},"categories/category":function(t,o){return $('[component="categories/category"][data-'+t+'="'+o+'"]')},"chat/message":function(t){return $('[component="chat/message"][data-mid="'+t+'"]')},"chat/message/body":function(t){return $('[component="chat/message"][data-mid="'+t+'"] [component="chat/message/body"]')},"chat/recent/room":function(t){return $('[component="chat/recent/room"][data-roomid="'+t+'"]')}},t.get=function(){const o=Array.prototype.slice.call(arguments,1);return t.core[arguments[0]]&&o.length?t.core[arguments[0]].apply(this,o):$('[component="'+arguments[0]+'"]')},t}.call(o,e,o,t))||(t.exports=n)},66044:(t,o,e)=>{var n,i;n=[e(7237),e(66603),e(42840),e(78989)],void 0===(i=function(t,o,e,n){const i={};let a;function c(t){const e=t&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||e){let t=o.getItem("category:bookmark"),e=o.getItem("category:bookmark:clicked");if(o.removeItem("category:bookmark"),o.removeItem("category:bookmark:clicked"),!utils.isNumber(t))return;if(t=Math.max(0,parseInt(t,10)||0),e=Math.max(0,parseInt(e,10)||0),config.usePagination){const o=Math.ceil((parseInt(t,10)+1)/config.topicsPerPage);parseInt(o,10)!==ajaxify.data.pagination.currentPage?n.loadPage(o,(function(){i.scrollToTopic(t,e)})):i.scrollToTopic(t,e)}else{if(0===t)return void i.scrollToTopic(t,e);$('[component="category"]').empty(),a(Math.max(0,t-1)+1,(function(){i.scrollToTopic(t,e)}))}}}return i.init=function(t){a=t,$('[component="category"]').on("click",'[component="topic/header"]',(function(){const t=$(this).parents("[data-index]").attr("data-index"),e=$(window).scrollTop();$('[component="category/topic"]').each((function(n,i){if($(i).offset().top-e>0)return o.setItem("category:bookmark",$(i).attr("data-index")),o.setItem("category:bookmark:clicked",t),o.setItem("category:bookmark:offset",$(i).offset().top-e),!1}))})),$(window).off("action:popstate",c).on("action:popstate",c)},i.onBackClicked=c,i.highlightTopic=function(o){const e=t.get("category/topic","index",o);e.length&&!e.hasClass("highlight")&&(e.addClass("highlight"),setTimeout((function(){e.removeClass("highlight")}),5e3))},i.scrollToTopic=function(n,a){if(!utils.isNumber(n))return;const c=t.get("category/topic","index",n);if(c.length){const t=o.getItem("category:bookmark:offset");o.removeItem("category:bookmark:offset"),$(window).scrollTop(c.offset().top-t),i.highlightTopic(a),e.update()}},i}.apply(o,n))||(t.exports=i)},42840:(t,o,e)=>{var n,i;n=[e(78989),e(7237),e(85233),e(7927)],void 0===(i=function(t,o,e,n){const i={};let a,c,r,s,l,p=0,f=0,u=!1,d=!0;i.scrollActive=!1;let g,m,h,y,w,x=$(".pagination-block"),k=x.find(".pagination-text"),b=x.find("meter"),T=x.find(".progress-bar");$(window).on("action:ajaxify.start",(function(){$(window).off("keydown",C)})),i.init=function(t,o,n,a,f){p=0,i.selector=t,i.callback=f,i.toTop=n||function(){},i.toBottom=a||function(){},x=$(".pagination-block"),k=x.find(".pagination-text"),b=x.find("meter"),T=x.find(".progress-bar"),h=$(".scroller-thumb-icon"),y=h.height(),w=y/2,g=$(".scroller-thumb"),m=g.find(".thumb-text"),$(window).off("scroll",i.delayedUpdate).on("scroll",i.delayedUpdate),x.find(".dropdown-menu").off("click").on("click",(function(t){t.stopPropagation()})),x.off("shown.bs.dropdown",".wrapper").on("shown.bs.dropdown",".wrapper",(function(){setTimeout((async function(){"lg"===utils.findBootstrapEnvironment()&&$(".pagination-block input").focus(),await socket.emit("topics.getPostCountInTopic",ajaxify.data.tid)>0&&x.find("#myNextPostBtn").removeAttr("disabled")}),100)})),x.find(".pageup").off("click").on("click",i.scrollUp),x.find(".pagedown").off("click").on("click",i.scrollDown),x.find(".pagetop").off("click").on("click",i.toTop),x.find(".pagebottom").off("click").on("click",i.toBottom),x.find("#myNextPostBtn").off("click").on("click",I),x.find("input").on("keydown",(function(t){if(13===t.which){const t=$(this);if(!utils.isNumber(t.val()))return void t.val("");const o=B(parseInt(t.val(),10));t.val(""),$(".pagination-block .dropdown-toggle").trigger("click"),ajaxify.go(o)}})),ajaxify.data.template.topic&&function(){if(!g.length)return;const t=g.parent();function o(o){const e=(P(o-w)-t.offset().top)/(t.height()-y);return p=Math.max(1,Math.ceil(ajaxify.data.postcount*e)),p>ajaxify.data.postcount?ajaxify.data.count:p}t.on("click",(function(t){if($(t.target).hasClass("scroller-container")){const e=o(t.pageY);return i.scrollToIndex(e-1,!0,0),!1}}));let n=!1;function a(){$(window).off("mousemove",f),n&&(i.scrollToIndex(p-1,!0,0),x.find('[data-toggle="dropdown"]').trigger("click")),_(),n=!1,d=!1}function f(t){const e=P(t.pageY-w);g.offset({top:e,left:g.offset().left});const n=o(t.pageY);return i.updateTextAndProgressBar(),m.text(n+"/"+ajaxify.data.postcount),d&&h(),d=!1,t.stopPropagation(),!1}function h(){_(),c=setInterval((function(){M(p)}),250)}e.on("action:ajaxify.end",(function(){l=null})),$(".pagination-block .dropdown-menu").parent().on("shown.bs.dropdown",(function(){j(p)})),g.on("mousedown",(function(){n=!0,$(window).on("mousemove",f),d=!0})),$(window).off("mousemove",f),$(window).off("mouseup",a).on("mouseup",a),g.on("touchstart",(function(t){u=!0,r=Math.min($(window).width(),Math.max(0,t.touches[0].clientX)),s=Math.min($(window).height(),Math.max(0,t.touches[0].clientY)),d=!0})),g.on("touchmove",(function(t){const e=$(window).width(),n=$(window).height(),a=Math.abs(r-Math.min(e,Math.max(0,t.touches[0].clientX))),c=Math.abs(s-Math.min(n,Math.max(0,t.touches[0].clientY)));if(r=Math.min(e,Math.max(0,t.touches[0].clientX)),s=Math.min(n,Math.max(0,t.touches[0].clientY)),c>=a&&d&&(u=!0,h()),u&&t.cancelable){t.preventDefault(),t.stopPropagation();const e=P(s+$(window).scrollTop()-w);g.offset({top:e,left:g.offset().left});const n=o(s+$(window).scrollTop());i.updateTextAndProgressBar(),m.text(n+"/"+ajaxify.data.postcount),d&&M(n)}d=!1})),g.on("touchend",(function(){_(),u&&(i.scrollToIndex(p-1,!0,0),u=!1,x.find('[data-toggle="dropdown"]').trigger("click"))}))}(),config.usePagination||$(window).off("keydown",C).on("keydown",C),i.setCount(o),i.update(0)};let v=0;async function I(){async function t(t){return await socket.emit("topics.getMyNextPostIndex",{tid:ajaxify.data.tid,index:Math.max(1,t),sort:config.topicPostSort})}if(ajaxify.data.template.topic){let o=await t(p);v===o&&(o=await t(o)),o&&p!==o+1?(v=o,$(window).one("action:ajaxify.end",(function(){x.find(".dropdown-menu").is(":hidden")&&x.find(".dropdown-toggle").dropdown("toggle")})),i.scrollToIndex(o,!0,0)):(n.alert({message:"[[topic:no-more-next-post]]",type:"info"}),v=1)}}function P(t){const o=g.parent(),e=o.offset();return t<e.top?t=e.top:t>e.top+o.height()-y&&(t=e.top+o.height()-y),t}function j(t){if(!g.length||g.is(":hidden"))return;const o=g.parent(),e=o.offset();let n=(t-1)/ajaxify.data.postcount;t===f&&(n=1);const i={top:P(e.top+(o.height()-y)*n),left:g.offset().left};g.offset(i),m.text(t+"/"+ajaxify.data.postcount),M(t)}function _(){c&&(clearInterval(c),c=0)}function M(t,o){o=o||function(){},l===t||x.find(".post-content").is(":hidden")||(l=t,socket.emit("posts.getPostSummaryByIndex",{tid:ajaxify.data.tid,index:t-1},(function(t,e){if(t)return n.error(t);app.parseAndTranslate("partials/topic/navigation-post",{post:e},(function(t){x.find(".post-content").html(t).find(".timeago").timeago()})),o()})))}function C(t){if("BODY"===t.target.nodeName){if(t.shiftKey||t.ctrlKey||t.altKey)return;if(36===t.which&&i.toTop)return i.toTop(),!1;if(35===t.which&&i.toBottom)return i.toBottom(),!1}}function B(t){const o=window.location.pathname.replace(config.relative_path,"").split("/");return o[1]+"/"+o[2]+"/"+o[3]+(t?"/"+t:"")}function A(t){const o=ajaxify.removeRelativePath(window.location.pathname.slice(1));(!t||o.startsWith("topic")||o.startsWith("category"))&&x.toggleClass("ready",t)}return i.setCount=function(t){(t=parseInt(t,10))!==f&&(f=t,i.updateTextAndProgressBar())},i.show=function(){A(!0)},i.disable=function(){f=0,p=1,i.callback=null,i.selector=null,$(window).off("scroll",i.delayedUpdate),A(!1)},i.delayedUpdate=function(){a||(a=setTimeout((function(){i.update(),a=void 0}),100))},i.update=function(t){t="number"==typeof t?t:void 0;let e=p;const n=$(i.selector);n.length&&(e=parseInt(n.first().attr("data-index"),10)+1);const a=$(window).scrollTop(),c=$(window).height(),r=$(document).height(),s=a+c/2;let l=Number.MAX_VALUE;n.each((function(){const t=$(this),o=parseInt(t.attr("data-index"),10);if(o>=0){const n=Math.abs(s-(t.offset().top+t.outerHeight(!0)/2));if(n>l)return!1;n<l&&(e=o+1,l=n)}}));const u=0===a&&0===parseInt(n.first().attr("data-index"),10),d=a+c>r-100&&parseInt(n.last().attr("data-index"),10)===f-1;if(u?e=1:d&&(e=f),void 0===t&&ajaxify.data.template.topic)if(u)t=0;else{const e=o.get("post/anchor",p-1);e.length&&(t=e.get(0).getBoundingClientRect().top)}"function"==typeof i.callback&&i.callback(e,f,t),e!==p&&(p=e,i.updateTextAndProgressBar(),j(p)),A(!!f)},i.updateTextAndProgressBar=function(){if(!utils.isNumber(p))return;p=p>f?f:p,k.translateHtml("[[global:pagination.out_of, "+p+", "+f+"]]");const t=(p-1)/(f-1||1);b.val(t),T.width(100*t+"%")},i.scrollUp=function(){const o=$(window);if(config.usePagination&&o.scrollTop()<=0)return t.previousPage((function(){$("body,html").scrollTop($(document).height()-o.height())}));$("body,html").animate({scrollTop:o.scrollTop()-o.height()})},i.scrollDown=function(){const o=$(window);if(config.usePagination&&o.scrollTop()>=$(document).height()-o.height())return t.nextPage();$("body,html").animate({scrollTop:o.scrollTop()+o.height()})},i.scrollTop=function(t){$(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):ajaxify.go(B())},i.scrollBottom=function(t){parseInt(t,10)<0||($(i.selector+'[data-index="'+t+'"]').length?i.scrollToIndex(t,!0):(t=parseInt(t,10)+1,ajaxify.go(B(t))))},i.scrollToIndex=function(e,n,a){const c=!!o.get("topic").length,r=!!o.get("category").length;if(!utils.isNumber(e)||!c&&!r)return;if(a=void 0!==a?a:400,i.scrollActive=!0,c&&o.get("post/anchor",e).length)return i.scrollToPostIndex(e,n,a);if(r&&$('[component="category/topic"][data-index="'+e+'"]').length)return i.scrollToTopicIndex(e,n,a);if(!config.usePagination)return i.scrollActive=!1,e=parseInt(e,10)+1,void ajaxify.go(B(e));const s=c?i.scrollToPostIndex:i.scrollToTopicIndex,l=1+Math.floor(e/config.postsPerPage);parseInt(l,10)!==ajaxify.data.pagination.currentPage?t.loadPage(l,(function(){s(e,n,a)})):s(e,n,a)},i.scrollToPostIndex=function(t,e,n){const a=o.get("post","index",t);i.scrollToElement(a,e,n)},i.scrollToTopicIndex=function(t,o,e){const n=$('[component="category/topic"][data-index="'+t+'"]');i.scrollToElement(n,o,e)},i.scrollToElement=function(t,e,n){if(!t.length)return void(i.scrollActive=!1);const a=t.outerHeight(!0),c=o.get("navbar").outerHeight(!0),r=$(".topic-header").outerHeight(!0)||0,s=$(window).height();$(window).off("scroll",i.delayedUpdate),n=void 0!==n?n:400,i.scrollActive=!0;let l=!1;!function(){function o(){$(window).on("scroll",i.delayedUpdate);const o=t.get(0).getBoundingClientRect();i.update(o.top)}function p(){l?o():(l=!0,i.scrollActive=!1,e&&($('[component="post"],[component="category/topic"]').removeClass("highlight"),t.addClass("highlight"),setTimeout((function(){t.removeClass("highlight")}),1e4)),$("body").scrollTop($("body").scrollTop()-1),$("html").scrollTop($("html").scrollTop()-1))}let f=0;if(f=a<s-c-r?t.offset().top-s/2+a/2:t.offset().top-c-r,0===n)return $(window).scrollTop(f),p(),void o();$("html, body").animate({scrollTop:f+"px"},n,p)}()},i}.apply(o,n))||(t.exports=i)},66603:(t,o,e)=>{var n;void 0===(n=function(){function t(){this._store={},this._keys=[]}let o;t.prototype.isMock=!0,t.prototype.setItem=function(t,o){t=String(t),-1===this._keys.indexOf(t)&&this._keys.push(t),this._store[t]=o},t.prototype.getItem=function(t){return t=String(t),-1===this._keys.indexOf(t)?null:this._store[t]},t.prototype.removeItem=function(t){t=String(t),this._keys=this._keys.filter((function(o){return o!==t})),this._store[t]=null},t.prototype.clear=function(){this._keys=[],this._store={}},t.prototype.key=function(t){return t=parseInt(t,10)||0,this._keys[t]},Object.defineProperty&&Object.defineProperty(t.prototype,"length",{get:function(){return this._keys.length}});const e=Date.now().toString();try{if(o=window.localStorage,o.setItem(e,e),o.getItem(e)!==e)throw Error("localStorage behaved unexpectedly");return o.removeItem(e),o}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(o=window.sessionStorage,o.setItem(e,e),o.getItem(e)!==e)throw Error("sessionStorage behaved unexpectedly");return o.removeItem(e),o}catch(o){return console.warn(o),console.warn("sessionStorage failed, falling back on memory storage"),new t}}}.call(o,e,o,t))||(t.exports=n)}}]);