"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[4222,7214,6503,6721,3014,8253,71,8306,831,7927,6193,7073],{68118:(e,t,n)=>{var s,r;s=[n(7073),n(86193),n(66603),n(85233),n(7927)],void 0===(r=function(e,t,n,s,r){const o={};function a(){const e=$("#advanced-search"),t={in:$("#search-in").val()};return t.term=$("#search-input").val(),"posts"!==t.in&&"titlesposts"!==t.in&&"titles"!==t.in||(t.matchWords=e.find("#match-words-filter").val(),t.by=e.find("#posted-by-user").tagsinput("items"),t.categories=e.find("#posted-in-categories").val(),t.searchChildren=e.find("#search-children").is(":checked"),t.hasTags=e.find("#has-tags").tagsinput("items"),t.replies=e.find("#reply-count").val(),t.repliesFilter=e.find("#reply-count-filter").val(),t.timeFilter=e.find("#post-time-filter").val(),t.timeRange=e.find("#post-time-range").val(),t.sortBy=e.find("#post-sort-by").val(),t.sortDirection=e.find("#post-sort-direction").val(),t.showAs=e.find("#show-as-topics").is(":checked")?"topics":"posts"),s.fire("action:search.getSearchDataFromDOM",{form:e,data:t}),t}function i(e){const t=-1===e.indexOf("posts")&&-1===e.indexOf("titles");$(".post-search-item").toggleClass("hide",t)}return o.init=function(){const o=$("#results").attr("data-search-query"),c=$("#search-in");c.on("change",(function(){i(c.val())})),e.highlightMatches(o,$(".search-result-text p, .search-result-text.search-result-title a")),$("#advanced-search").off("submit").on("submit",(function(t){return t.preventDefault(),e.query(a(),(function(){$("#search-input").val("")})),!1})),$("#save-preferences").on("click",(function(){return n.setItem("search-preferences",JSON.stringify(a())),r.success("[[search:search-preferences-saved]]"),!1})),$("#clear-preferences").on("click",(function(){n.removeItem("search-preferences");const e=$("#search-input").val();return $("#advanced-search")[0].reset(),$("#search-input").val(e),r.success("[[search:search-preferences-cleared]]"),!1})),function(){const e=$("#posted-by-user");e.tagsinput({confirmKeys:[13,44],trimValue:!0}),app.user.privileges["search:users"]&&t.user(e.siblings(".bootstrap-tagsinput").find("input"));const n=$("#has-tags");n.tagsinput({confirmKeys:[13,44],trimValue:!0}),app.user.privileges["search:tags"]&&t.tag(n.siblings(".bootstrap-tagsinput").find("input"))}(),function(){const t=utils.params({disableToType:!0}),n=e.getSearchPreferences(),r=utils.merge(n,t);if(r){if(ajaxify.data.term&&$("#search-input").val(ajaxify.data.term),r.in=r.in||ajaxify.data.searchDefaultIn,$("#search-in").val(r.in),i(r.in),r.matchWords&&$("#match-words-filter").val(r.matchWords),r.by&&(r.by=Array.isArray(r.by)?r.by:[r.by],r.by.forEach((function(e){$("#posted-by-user").tagsinput("add",e)}))),r.categories&&$("#posted-in-categories").val(r.categories),r.searchChildren&&$("#search-children").prop("checked",!0),r.hasTags&&(r.hasTags=Array.isArray(r.hasTags)?r.hasTags:[r.hasTags],r.hasTags.forEach((function(e){$("#has-tags").tagsinput("add",e)}))),r.replies&&($("#reply-count").val(r.replies),$("#reply-count-filter").val(r.repliesFilter)),r.timeRange&&($("#post-time-range").val(r.timeRange),$("#post-time-filter").val(r.timeFilter)),(r.sortBy||ajaxify.data.searchDefaultSortBy)&&$("#post-sort-by").val(r.sortBy||ajaxify.data.searchDefaultSortBy),$("#post-sort-direction").val(r.sortDirection||"desc"),r.showAs){const e="topics"===r.showAs,t="posts"===r.showAs;$("#show-as-topics").prop("checked",e).parent().toggleClass("active",e),$("#show-as-posts").prop("checked",t).parent().toggleClass("active",t)}s.fire("action:search.fillOutForm",{form:r})}}()},o}.apply(t,s))||(e.exports=r)},7927:(e,t,n)=>{var s,r;s=[n(32230),n(7237),n(85233)],r=function(e,t,n){const s={};function r(e,t){e.find("strong").translateHtml(t.title),e.find("p").translateHtml(t.message),e.attr("class","alert alert-dismissable alert-"+t.type+" clearfix"),clearTimeout(parseInt(e.attr("timeoutId"),10)),t.timeout&&a(e,t),n.fire("action:alert.update",{alert:e,params:t}),e.off("click").removeClass("pointer"),"function"==typeof t.clickfn&&e.addClass("pointer").on("click",(function(n){$(n.target).is(".close")||t.clickfn(),o(e)}))}function o(e){e.fadeOut(500,(function(){$(this).remove()}))}function a(e,t){const s=t.timeout,r=setTimeout((function(){o(e),"function"==typeof t.timeoutfn&&t.timeoutfn(e,t)}),s);e.attr("timeoutId",r),e.css("transition-property","none"),e.removeClass("animate"),setTimeout((function(){e.css("transition-property",""),e.css("transition","width "+(s+450)+"ms linear, background-color "+(s+450)+"ms ease-in"),e.addClass("animate"),n.fire("action:alert.animate",{alert:e,params:t})}),50),e.on("mouseenter",(function(){$(this).css("transition-duration",0)}))}return s.alert=function(e){e.alert_id="alert_button_"+(e.alert_id?e.alert_id:(new Date).getTime()),e.title=e.title&&e.title.trim()||"",e.message=e.message?e.message.trim():"",e.type=e.type||"info";const s=$("#"+e.alert_id);s.length?r(s,e):function(e){app.parseAndTranslate("alert",e,(function(s){let i=$("#"+e.alert_id);if(i.length)return r(i,e);i=s,i.fadeIn(200),t.get("toaster/tray").prepend(i),"function"==typeof e.closefn&&i.find("button").on("click",(function(){return e.closefn(),o(i),!1})),e.timeout&&a(i,e),"function"==typeof e.clickfn&&i.addClass("pointer").on("click",(function(t){$(t.target).is(".close")||e.clickfn(i,e),o(i)})),n.fire("action:alert.new",{alert:i,params:e})}))}(e)},s.success=function(e,t){s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.success]]",message:e,type:"success",timeout:t||5e3})},s.error=function(e,t){if("[[error:revalidate-failure]]"===(e=e&&e.message||e))return socket.disconnect(),void app.reconnect();s.alert({alert_id:utils.generateUUID(),title:"[[global:alert.error]]",message:e,type:"danger",timeout:t||1e4})},s.remove=function(e){$("#alert_button_"+e).remove()},s}.apply(t,s),void 0===r||(e.exports=r)},74344:(e,t,n)=>{var s,r;s=[n(85233)],void 0===(r=(e=>{const t={},n=config.relative_path+"/api/v3";function s(t,s){async function r(n){({options:t}=await e.fire("filter:api.options",{options:t})),$.ajax(t).done((e=>{n(null,e&&e.hasOwnProperty("status")&&e.hasOwnProperty("response")?e.response:e||{})})).fail((e=>{let t;e.responseJSON&&(t=e.responseJSON.status&&e.responseJSON.status.message?e.responseJSON.status.message:e.responseJSON.error),n(new Error(t||e.statusText))}))}if(t.url=t.url.startsWith("/api")?config.relative_path+t.url:n+t.url,"function"!=typeof s)return new Promise(((e,t)=>{r((function(n,s){n?t(n):e(s)}))}));r(s)}return t.get=(e,t,n)=>s({url:e+(t&&Object.keys(t).length?"?"+$.param(t):"")},n),t.head=(e,t,n)=>s({url:e+(t&&Object.keys(t).length?"?"+$.param(t):""),method:"head"},n),t.post=(e,t,n)=>s({url:e,method:"post",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.patch=(e,t,n)=>s({url:e,method:"patch",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.put=(e,t,n)=>s({url:e,method:"put",data:JSON.stringify(t||{}),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.del=(e,t,n)=>s({url:e,method:"delete",data:JSON.stringify(t),contentType:"application/json; charset=utf-8",headers:{"x-csrf-token":config.csrf_token}},n),t.delete=t.del,t}).apply(t,s))||(e.exports=r)},86193:(e,t,n)=>{var s,r;s=[n(74344),n(7927)],r=function(e,t){const n={},s={delay:200};return n.init=e=>{const{input:t,source:n,onSelect:r,delay:o}={...s,...e};app.loadJQueryUI((function(){t.autocomplete({delay:o,open:function(){$(this).autocomplete("widget").css("z-index",100005)},select:function(e,n){!function(e,t,n,s){t=t||function(){};const r=jQuery.Event("keypress");r.which=13,r.keyCode=13,setTimeout((function(){e.trigger(r)}),100),t(n,s)}(t,r,e,n)},source:n})}))},n.user=function(s,r,o){"function"==typeof r&&(o=r,r={}),r=r||{},n.init({input:s,onSelect:o,source:(n,s)=>{r.query=n.term,e.get("/api/users",r,(function(e,n){if(e)return t.error(e);if(n&&n.users){const e=n.users.map((function(e){const t=$("<div></div>").html(e.username).text();return e&&{label:t,value:t,user:{uid:e.uid,name:e.username,slug:e.userslug,username:e.username,userslug:e.userslug,picture:e.picture,banned:e.banned,"icon:text":e["icon:text"],"icon:bgColor":e["icon:bgColor"]}}}));s(e)}$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n.group=function(e,s){n.init({input:e,onSelect:s,source:(e,n)=>{socket.emit("groups.search",{query:e.term},(function(e,s){if(e)return t.error(e);if(s&&s.length){const e=s.map((function(e){return e&&{label:e.name,value:e.name,group:e}}));n(e)}$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n.tag=function(e,s){n.init({input:e,onSelect:s,delay:100,source:(e,n)=>{socket.emit("topics.autocompleteTags",{query:e.term,cid:ajaxify.data.cid||0},(function(e,s){if(e)return t.error(e);s&&n(s),$(".ui-autocomplete a").attr("data-ajaxify","false")}))}})},n}.apply(t,s),void 0===r||(e.exports=r)},7237:(e,t,n)=>{var s;void 0===(s=function(){const e={};return e.core={"topic/teaser":function(e){return e?$('[component="category/topic"][data-tid="'+e+'"] [component="topic/teaser"]'):$('[component="topic/teaser"]')},topic:function(e,t){return $('[component="topic"][data-'+e+'="'+t+'"]')},post:function(e,t){return $('[component="post"][data-'+e+'="'+t+'"]')},"post/content":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/content"]')},"post/header":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/header"]')},"post/anchor":function(e){return $('[component="post"][data-index="'+e+'"] [component="post/anchor"]')},"post/vote-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/vote-count"]')},"post/bookmark-count":function(e){return $('[component="post"][data-pid="'+e+'"] [component="post/bookmark-count"]')},"user/postcount":function(e){return $('[component="user/postcount"][data-uid="'+e+'"]')},"user/reputation":function(e){return $('[component="user/reputation"][data-uid="'+e+'"]')},"category/topic":function(e,t){return $('[component="category/topic"][data-'+e+'="'+t+'"]')},"categories/category":function(e,t){return $('[component="categories/category"][data-'+e+'="'+t+'"]')},"chat/message":function(e){return $('[component="chat/message"][data-mid="'+e+'"]')},"chat/message/body":function(e){return $('[component="chat/message"][data-mid="'+e+'"] [component="chat/message/body"]')},"chat/recent/room":function(e){return $('[component="chat/recent/room"][data-roomid="'+e+'"]')}},e.get=function(){const t=Array.prototype.slice.call(arguments,1);return e.core[arguments[0]]&&t.length?e.core[arguments[0]].apply(this,t):$('[component="'+arguments[0]+'"]')},e}.call(t,n,t,e))||(e.exports=s)},7073:(e,t,n)=>{var s,r;s=[n(32230),n(66603),n(85233),n(7927)],void 0===(r=function(e,t,n,s){const r={current:{}};function o(e){const t=e.in||"titles",r=e.by||"";let o=e.term.replace(/^[ ?#]*/,"");try{o=encodeURIComponent(o)}catch(e){return s.error("[[error:invalid-search-term]]")}const a={term:o,in:t};return e.matchWords&&(a.matchWords=e.matchWords),r&&r.length&&("posts"===t||"titles"===t||"titlesposts"===t)&&(a.by=r),e.categories&&e.categories.length&&(a.categories=e.categories,e.searchChildren&&(a.searchChildren=e.searchChildren)),e.hasTags&&e.hasTags.length&&(a.hasTags=e.hasTags),parseInt(e.replies,10)>0&&(a.replies=e.replies,a.repliesFilter=e.repliesFilter||"atleast"),e.timeRange&&(a.timeRange=e.timeRange,a.timeFilter=e.timeFilter||"newer"),e.sortBy&&(a.sortBy=e.sortBy,a.sortDirection=e.sortDirection),e.showAs&&(a.showAs=e.showAs),e.searchOnly&&(a.searchOnly=e.searchOnly),n.fire("action:search.createQueryString",{query:a,data:e}),decodeURIComponent($.param(a))}return r.init=function(e){if(!config.searchEnabled)return;e=e||{in:config.searchDefaultInQuick||"titles"};const t=$("#search-button"),o=$("#search-fields"),a=$("#search-fields input"),i=$("#quick-search-container");$("#search-form .advanced-search-link").off("mousedown").on("mousedown",(function(){ajaxify.go("/search")})),$("#search-form").off("submit").on("submit",(function(){a.blur()})),a.off("blur").on("blur",(function(){setTimeout((function(){a.is(":focus")||(o.addClass("hidden"),t.removeClass("hidden"))}),200)})),a.off("focus");const c={inputEl:a,resultEl:i};r.enableQuickSearch({searchOptions:e,searchElements:c}),t.off("click").on("click",(function(e){return config.loggedIn||app.user.privileges["search:content"]?(e.stopPropagation(),r.showAndFocusInput(),!1):(s.alert({message:"[[error:search-requires-login]]",timeout:3e3}),ajaxify.go("login"),!1)})),$("#search-form").off("submit").on("submit",(function(){const t=$(this).find("input"),s=r.getSearchPreferences();return s.term=t.val(),s.in=e.in,n.fire("action:search.submit",{searchOptions:s,searchElements:c}),r.query(s,(function(){t.val("")})),!1}))},r.enableQuickSearch=function(t){if(!config.searchEnabled||!app.user.privileges["search:content"])return;const s=Object.assign({in:config.searchDefaultInQuick||"titles"},t.searchOptions),o=t.searchElements.resultEl,a=t.searchElements.inputEl;let i=a.val();const c=o.find(".filter-category");function u(){ajaxify.data.template.category&&e.translate("[[search:search-in-category, "+ajaxify.data.name+"]]",(function(e){const t=$("<div></div>").html(e).text();c.find(".name").text(t)})),c.toggleClass("hidden",!ajaxify.data.template.category)}function l(){t.searchOptions=Object.assign({},s),t.searchOptions.term=a.val(),u(),ajaxify.data.template.category&&c.find('input[type="checkbox"]').is(":checked")&&(t.searchOptions.categories=[ajaxify.data.cid],t.searchOptions.searchChildren=!0),o.removeClass("hidden").find(".quick-search-results-container").html(""),o.find(".loading-indicator").removeClass("hidden"),n.fire("action:search.quick.start",t),t.searchOptions.searchOnly=1,r.api(t.searchOptions,(function(e){if(o.find(".loading-indicator").addClass("hidden"),!e.posts||t.hideOnNoMatches&&!e.posts.length)return o.addClass("hidden").find(".quick-search-results-container").html("");e.posts.forEach((function(e){const t=$("<div>"+e.content+"</div>").text(),n=a.val().toLowerCase().replace(/^in:topic-\d+/,""),s=Math.max(0,t.toLowerCase().indexOf(n)-40);e.snippet=utils.escapeHTML((s>0?"...":"")+t.slice(s,s+80)+(t.length-s>80?"...":""))})),app.parseAndTranslate("partials/quick-search-results",e,(function(s){s.length&&s.find(".timeago").timeago(),o.toggleClass("hidden",!s.length||!a.is(":focus")).find(".quick-search-results-container").html(s.length?s:"");const i=o.find(".quick-search-results .quick-search-title, .quick-search-results .snippet");r.highlightMatches(t.searchOptions.term,i),n.fire("action:search.quick.complete",{data:e,options:t})}))}))}o.find('.filter-category input[type="checkbox"]').on("change",(function(){a.focus(),l()})),a.off("keyup").on("keyup",utils.debounce((function(){if(a.val().length<3)return o.addClass("hidden"),void(i=a.val());if(a.val()!==i){if(i=a.val(),!a.is(":focus"))return o.addClass("hidden");l()}}),500));let p=!1;o.on("mousedown",(function(){$(window).one("mouseup",(function(){o.addClass("hidden")})),p=!0})),a.on("blur",(function(){a.is(":focus")||p||o.hasClass("hidden")||o.addClass("hidden")}));let f=!1;n.on("action:ajaxify.end",(function(){ajaxify.isCold()||(f=!0)})),a.on("focus",(function(){p=!1;const e=a.val();i=e,e&&o.find("#quick-search-results").children().length&&(u(),f?(l(),f=!1):o.removeClass("hidden"),a[0].setSelectionRange(e.startsWith("in:topic")?e.indexOf(" ")+1:0,e.length))})),a.off("refresh").on("refresh",(function(){l()}))},r.showAndFocusInput=function(){$("#search-fields").removeClass("hidden"),$("#search-button").addClass("hidden"),$("#search-fields input").focus()},r.query=function(e,t){t=t||function(){},ajaxify.go("search?"+o(e)),t()},r.api=function(e,t){const n=config.relative_path+"/api/search?"+o(e);e.searchOnly=void 0;const s=config.relative_path+"/search?"+o(e);$.get(n,(function(e){e.url=s,t(e)}))},r.getSearchPreferences=function(){try{return JSON.parse(t.getItem("search-preferences")||"{}")}catch(e){return{}}},r.highlightMatches=function(e,t){if(!e||!t.length)return;const n=(e=utils.escapeHTML(e.replace(/^"/,"").replace(/"$/,"").trim())).split(" ").map((function(e){return utils.escapeRegexChars(e)})).join("|"),s=new RegExp("("+n+")","gi");t.each((function(){const e=$(this),t=[];e.find("*").each((function(){$(this).after("\x3c!-- "+t.length+" --\x3e"),t.push($("<div></div>").append($(this)))})),e.html(e.html().replace(s,(function(e,t){return'<strong class="search-match">'+t+"</strong>"}))),t.forEach((function(t,n){e.html(e.html().replace("\x3c!-- "+n+" --\x3e",(function(){return t.html()})))}))})),$(".search-result-text").find("img:not(.not-responsive)").addClass("img-responsive")},r}.apply(t,s))||(e.exports=r)},66603:(e,t,n)=>{var s;void 0===(s=function(){function e(){this._store={},this._keys=[]}let t;e.prototype.isMock=!0,e.prototype.setItem=function(e,t){e=String(e),-1===this._keys.indexOf(e)&&this._keys.push(e),this._store[e]=t},e.prototype.getItem=function(e){return e=String(e),-1===this._keys.indexOf(e)?null:this._store[e]},e.prototype.removeItem=function(e){e=String(e),this._keys=this._keys.filter((function(t){return t!==e})),this._store[e]=null},e.prototype.clear=function(){this._keys=[],this._store={}},e.prototype.key=function(e){return e=parseInt(e,10)||0,this._keys[e]},Object.defineProperty&&Object.defineProperty(e.prototype,"length",{get:function(){return this._keys.length}});const n=Date.now().toString();try{if(t=window.localStorage,t.setItem(n,n),t.getItem(n)!==n)throw Error("localStorage behaved unexpectedly");return t.removeItem(n),t}catch(s){console.warn(s),console.warn("localStorage failed, falling back on sessionStorage");try{if(t=window.sessionStorage,t.setItem(n,n),t.getItem(n)!==n)throw Error("sessionStorage behaved unexpectedly");return t.removeItem(n),t}catch(t){return console.warn(t),console.warn("sessionStorage failed, falling back on memory storage"),new e}}}.call(t,n,t,e))||(e.exports=s)}}]);