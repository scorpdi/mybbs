"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6880,8704],{66531:(e,t,n)=>{var i,o;i=[n(14745)],void 0===(o=function(e){return{init:function(){app.enterRoom("popular_topics"),e.init("popular")}}}.apply(t,i))||(e.exports=o)},39941:(e,t,n)=>{var i,o;i=[n(22905),n(74344),n(85233)],void 0===(o=function(e,t,n){const i={init:function(i,o){if(!i||!i.length)return;(o=o||{}).states=o.states||["watching","notwatching","ignoring"],o.template="partials/category-filter",n.fire("action:category.filter.options",{el:i,options:o}),e.init(i,o);let a=[],c=[];Array.isArray(o.selectedCids)?a=o.selectedCids.map((e=>parseInt(e,10))):Array.isArray(ajaxify.data.selectedCids)&&(a=ajaxify.data.selectedCids.map((e=>parseInt(e,10)))),c=a.slice(),i.on("hidden.bs.dropdown",(function(){let e=c.length!==a.length;if(c.forEach((function(t,n){t!==a[n]&&(e=!0)})),e&&function(e,n){function i(t){app.parseAndTranslate("partials/category-filter-content",{selectedCategory:t},(function(t){e.find("button").replaceWith($("<div/>").html(t).find("button"))}))}n.length>1?i({icon:"fa-plus",name:"[[unread:multiple-categories-selected]]",bgColor:"#ddd"}):1===n.length?t.get(`/categories/${n[0]}`,{}).then(i):i()}(i,a),o.onHidden)o.onHidden({changed:e,selectedCids:a.slice()});else if(e){let e=window.location.pathname;const t=utils.params();a.length&&(t.cid=a,e+="?"+decodeURIComponent($.param(t))),ajaxify.go(e)}})),i.on("click",'[component="category/list"] [data-cid]',(function(){const e=i.find('[component="category/list"]'),t=$(this),n=t.find("a").attr("href");if(n&&"#"!==n&&n.length)return;const c=parseInt(t.attr("data-cid"),10),s=t.find('[component="category/select/icon"]');return a.includes(c)?a.splice(a.indexOf(c),1):a.push(c),a.sort((function(e,t){return e-t})),o.selectedCids=a,s.toggleClass("invisible"),e.find('li[data-all="all"] i').toggleClass("invisible",!!a.length),o.onSelect&&o.onSelect({cid:c,selectedCids:a.slice()}),!1}))}};return i}.apply(t,i))||(e.exports=o)},22905:(e,t,n)=>{var i,o;i=[n(7927)],void 0===(o=function(e){const t={init:function(t,n){let i=null;(n=n||{}).privilege=n.privilege||"topics:read",n.states=n.states||["watching","notwatching","ignoring"];let o=[];Array.isArray(n.localCategories)&&(o=n.localCategories.map((e=>({...e})))),n.selectedCids=n.selectedCids||ajaxify.data.selectedCids||[];const a=t.find('[component="category-selector-search"]');if(!a.length)return;const c=a.parent('[component="category/dropdown"]').length>0||a.parent('[component="category-selector"]').length>0;function s(e){app.parseAndTranslate(n.template,{categoryItems:e.slice(0,200),selectedCategory:ajaxify.data.selectedCategory,allCategoriesUrl:ajaxify.data.allCategoriesUrl},(function(n){t.find('[component="category/list"]').replaceWith(n.find('[component="category/list"]')),t.find('[component="category/list"] [component="category/no-matches"]').toggleClass("hidden",!!e.length)}))}t.on("show.bs.dropdown",(function(){function r(){const t=a.find("input").val();var c,r;t.length>1||!t&&!i?(c=t,r=function(e){i=i||e,s(e)},socket.emit("categories.categorySearch",{search:c,query:utils.params(),parentCid:n.parentCid||0,selectedCids:n.selectedCids,privilege:n.privilege,states:n.states,showLinks:n.showLinks},(function(t,n){if(t)return e.error(t);r(o.concat(n))}))):!t&&i&&(i.forEach((function(e){e.selected=n.selectedCids.includes(e.cid)})),s(i))}c&&(t.find(".dropdown-toggle").addClass("hidden"),a.removeClass("hidden")),a.on("click",(function(e){e.preventDefault(),e.stopPropagation()})),a.find("input").val("").on("keyup",utils.debounce(r,300)),r()})),t.on("shown.bs.dropdown",(function(){a.find("input").focus()})),t.on("hide.bs.dropdown",(function(){c&&(t.find(".dropdown-toggle").removeClass("hidden"),a.addClass("hidden")),a.off("click"),a.find("input").off("keyup")}))}};return t}.apply(t,i))||(e.exports=o)},14745:(e,t,n)=>{var i,o;i=[n(25142),n(66044),n(69941),n(39941),n(29412),n(85233)],void 0===(o=function(e,t,n,i,o,a){const c={};let s,r,l="",d=0,p=0;const f=[];function g(e){const t=ajaxify.data,n=t.selectedCids&&t.selectedCids.length&&-1===t.selectedCids.indexOf(parseInt(e.cid,10)),i=t.selectedFilter&&"watched"===t.selectedFilter.filter,o=t.template.category&&parseInt(t.cid,10)!==parseInt(e.cid,10),c=!!(n||i||o||f.includes(e.tid));a.fire("filter:topicList.onNewTopic",{topic:e,preventAlert:c}).then((t=>{t.preventAlert||(e.scheduled&&e.tid&&f.push(e.tid),d+=1,u())}))}function h(e){const t=e.posts[0];if(!t||!t.topic||t.topic.isFollowing)return;const n=ajaxify.data,i=parseInt(t.topic.mainPid,10)===parseInt(t.pid,10),o=n.selectedCids&&n.selectedCids.length&&-1===n.selectedCids.indexOf(parseInt(t.topic.cid,10)),c=n.selectedFilter&&"new"===n.selectedFilter.filter,s=n.selectedFilter&&"watched"===n.selectedFilter.filter&&!t.topic.isFollowing,r=n.template.category&&parseInt(n.cid,10)!==parseInt(t.topic.cid,10),l=!!(i||o||c||s||r);a.fire("filter:topicList.onNewPost",{post:t,preventAlert:l}).then((e=>{e.preventAlert||(p+=1,u())}))}function u(){let e="";0===d?1===p?e="[[recent:there-is-a-new-post]]":p>1&&(e="[[recent:there-are-new-posts, "+p+"]]"):1===d?0===p?e="[[recent:there-is-a-new-topic]]":1===p?e="[[recent:there-is-a-new-topic-and-a-new-post]]":p>1&&(e="[[recent:there-is-a-new-topic-and-new-posts, "+p+"]]"):d>1&&(0===p?e="[[recent:there-are-new-topics, "+d+"]]":1===p?e="[[recent:there-are-new-topics-and-a-new-post, "+d+"]]":p>1&&(e="[[recent:there-are-new-topics-and-new-posts, "+d+", "+p+"]]")),e+=" [[recent:click-here-to-reload]]",$("#new-topics-alert").translateText(e).removeClass("hide").fadeIn("slow"),$("#category-no-topics").addClass("hide")}function m(t,n,i){i=i||function(){};const o=utils.params();o.page=function(e,t){return Math.floor(e/config.topicsPerPage)+(t>0?1:0)}(t,n),e.loadMoreXhr(o,i)}function w(t,i,o,c,s){if(!i||!i.length)return $("#load-more-btn").hide(),s();if(!(i=function(e){return e.filter((function(e){return!r.find('[component="category/topic"][data-tid="'+e.tid+'"]').length}))}(i)).length)return $("#load-more-btn").hide(),s();let l,d;const p=r.find('[component="category/topic"]');c>0&&i.length?l=p.last():c<0&&i.length&&(d=p.first());const f={topics:i,showSelect:o,template:{name:t}};f.template[t]=!0,a.fire("action:topics.loading",{topics:i,after:l,before:d}),app.parseAndTranslate(t,"topics",f,(function(o){if(r.removeClass("hidden"),$("#category-no-topics").remove(),l&&l.length)o.insertAfter(l);else if(d&&d.length){const e=$(document).height(),t=$(window).scrollTop();o.insertBefore(d),$(window).scrollTop(t+($(document).height()-e))}else r.append(o);n.getSelectedTids().length||e.removeExtra(r.find('[component="category/topic"]'),c,Math.max(60,3*config.topicsPerPage)),o.find(".timeago").timeago(),app.createUserTooltips(o),utils.makeNumbersHumanReadable(o.find(".human-readable-number")),a.fire("action:topics.loaded",{topics:i,template:t}),s()}))}return $(window).on("action:ajaxify.start",(function(){c.removeListeners(),o.removeListeners()})),c.init=function(n,d){r=$('[component="category"]').filter((function(e,t){return!$(t).parents("[widget-area],[data-widget-area]").length})),l=n,s=d||m,o.init(),c.watchForNewPosts();const p=["watching"];ajaxify.data.selectedFilter&&"watched"===ajaxify.data.selectedFilter.filter?p.push("notwatching","ignoring"):"unread"!==n&&p.push("notwatching"),i.init($('[component="category/dropdown"]'),{states:p}),config.usePagination||e.init(c.loadMoreTopics),t.init((function(e,t){s(e,1,(function(e,n){w(l,e.topics,ajaxify.data.showSelect,1,(function(){t(),n()}))}))})),$("body").height()<=$(window).height()&&r.children().length>=20&&$("#load-more-btn").show(),$("#load-more-btn").on("click",(function(){c.loadMoreTopics(1)})),a.fire("action:topics.loaded",{topics:ajaxify.data.topics})},c.watchForNewPosts=function(){$("#new-topics-alert").on("click",(function(){$(this).addClass("hide")})),p=0,d=0,c.removeListeners(),socket.on("event:new_topic",g),socket.on("event:new_post",h)},c.removeListeners=function(){socket.removeListener("event:new_topic",g),socket.removeListener("event:new_post",h)},c.loadMoreTopics=function(e){if(!r.length||!r.children().length)return;const t=r.find('[component="category/topic"]'),n=e>0?t.last():t.first(),i=(parseInt(n.attr("data-index"),10)||0)+(e>0?1:0);!utils.isNumber(i)||0===i&&r.find('[component="category/topic"][data-index="0"]').length||s(i,e,(function(t,n){w(l,t.topics,ajaxify.data.showSelect,e,n)}))},c}.apply(t,i))||(e.exports=o)}}]);