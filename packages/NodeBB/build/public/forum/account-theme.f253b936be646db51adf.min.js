"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[1480,8306],{5750:(e,t,n)=>{var s,i;s=[n(59494),n(66603),n(18340),n(7927)],void 0===(i=function(e,t,n,s){const i={init:()=>{e.init(),i.setupForm()},setupForm:()=>{const e=document.getElementById("save"),i=document.getElementById("theme-settings"),[o,a]=[!!t.getItem("persona:menus:legacy-layout"),t.getItem("persona:navbar:autohide")];document.getElementById("persona:menus:legacy-layout").checked=o;try{(JSON.parse(a)||["xs","sm"]).forEach((e=>{document.getElementById("persona:navbar:autohide").querySelector(`option[value="${e}"]`).selected=!0}))}catch(e){console.warn(e)}e&&e.addEventListener("click",(()=>{const e=n.helper.serializeForm($(i));Object.keys(e).forEach((n=>{"persona:menus:legacy-layout"!==n?t.setItem(n,e[n]):"on"===e[n]?t.setItem("persona:menus:legacy-layout","true"):t.removeItem("persona:menus:legacy-layout")})),s.success("[[success:settings-saved]]")}))}};return i}.apply(t,s))||(e.exports=i)},18340:(e,t,n)=>{var s,i;s=[n(85233),n(7927)],void 0===(i=function(e,t){let s,i,o=[],a=0;function l(e,t){"string"!=typeof e&&(e=(e=$(e)).data("type")||e.attr("type")||e.prop("tagName"));const n=s.plugins[e.toLowerCase()];if(null==n)return;const i=n[t];return"function"==typeof i?i:null}return i={deepClone:function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e},createElement:function(e,t,n){const s=document.createElement(e);for(const e in t)t.hasOwnProperty(e)&&s.setAttribute(e,t[e]);return n&&s.appendChild(document.createTextNode(n)),s},initElement:function(e){const t=l(e,"init");null!=t&&t.call(s,$(e))},destructElement:function(e){const t=l(e,"destruct");null!=t&&t.call(s,$(e))},createElementOfType:function(e,t,n){let o;const a=l(e,"create");return null!=a?o=$(a.call(s,e,t,n)):(null==n&&(n={}),null!=e&&(n.type=e),o=$(i.createElement(t||"input",n))),o.data("type",e),i.initElement(o),o},cleanArray:function(e,t,n){const s=[];if(!t&&n)return e;for(let i=0;i<e.length;i+=1){let o=e[i];t&&(o===!!o?o=+o:o&&"function"==typeof o.trim&&(o=o.trim())),(n||null!=o&&o.length)&&s.push(o)}return s},isTrue:function(e){return"true"===e||1==+e},isFalse:function(e){return"false"===e||0==+e},readValue:function(e){let t=!i.isFalse(e.data("empty"));const n=!i.isFalse(e.data("trim")),o=e.data("split"),a=l(e,"get");let r;if(null!=a)return a.call(s,e,n,t);if(null!=o){t=i.isTrue(e.data("empty")),r=e.val();const s=null!=r&&r.split(o||",")||[];return i.cleanArray(s,n,t)}return r=e.val(),n&&null!=r&&"function"==typeof r.trim&&(r=r.trim()),t||void 0!==r&&(null==r||0!==r.length)?r:void 0},fillField:function(e,t){const n=l(e,"set");let i=e.data("trim");if(i="false"!==i&&0!=+i,null!=n)return n.call(s,e,t,i);t instanceof Array&&(t=t.join(e.data("split")||(i?", ":","))),i&&t&&"function"==typeof t.trim?"function"==typeof(t=t.trim()).toString&&(t=t.toString()):null!=t?("function"==typeof t.toString&&(t=t.toString()),i&&(t=t.trim())):t="",void 0!==t&&e.val(t)},initFields:function(e){$("[data-key]",e).each((function(e,t){const n=l(t=$(t),"init"),o=t.data("key").split(".");let a=s.get();null!=n&&n.call(s,t);for(let e=0;e<o.length;e+=1){const t=o[e];t&&null!=a&&(a=a[t])}i.fillField(t,a)}))},registerReadyJobs:function(e){return a+=e,a},beforeReadyJobsDecreased:function(e){if(null==e&&(e=1),a>0&&(a-=e,a<=0)){for(let e=0;e<o.length;e+=1)o[e]();o=[]}},whenReady:function(e){a<=0?e():o.push(e)},serializeForm:function(e){const t=e.serializeObject();return e.find('input[type="checkbox"]').each((function(e,n){(n=$(n)).is(":checked")||(t[n.attr("name")]="off")})),e.find("select[multiple]").each((function(e,n){n=$(n),t[n.attr("name")]=JSON.stringify(n.val())})),t},persistSettings:function(e,n,s,o){null!=n&&null!=n._&&"string"!=typeof n._&&((n=i.deepClone(n))._=JSON.stringify(n._)),socket.emit("admin.settings.set",{hash:e,values:n},(function(e){s&&(e?t.alert({title:"[[admin/admin:changes-not-saved]]",type:"danger",message:`[[admin/admin/changes-not-saved-message, ${e.message}]]`,timeout:5e3}):t.alert({title:"[[admin/admin:changes-saved]]",type:"success",message:"[[admin/admin:changes-saved-message]]",timeout:2500})),"function"==typeof o&&o(e)}))},use:function(e){try{e._=JSON.parse(e._)}catch(e){}s.cfg=e}},s={helper:i,plugins:{},cfg:{},get:function(){return null!=s.cfg&&void 0!==s.cfg._?s.cfg._:s.cfg},registerPlugin:function(e,t){null==t?t=e.types:e.types=t,"function"==typeof e.use&&e.use.call(s);for(let n=0;n<t.length;n+=1){const i=t[n].toLowerCase();null==s.plugins[i]&&(s.plugins[i]=e)}},set:function(e,t,n,s,o){null==o&&(o=!0),i.whenReady((function(){i.use(t),i.initFields(n||"form"),i.persistSettings(e,t,o,s)}))},sync:function(e,t,n){socket.emit("admin.settings.get",{hash:e},(function(e,s){e?"function"==typeof n&&n(e):i.whenReady((function(){i.use(s),i.initFields(t||"form"),"function"==typeof n&&n()}))}))},persist:function(e,n,o,a){const l=[],r=$("[data-key]",n||"form").toArray();null==a&&(a=!0);for(let e=0;e<r.length;e+=1){const t=$(r[e]),n=i.readValue(t);let o=s.get();const a=t.data("key").split("."),c=a[a.length-1];if(a.length>1)for(let e=0;e<a.length-1;e+=1){const t=a[e];t&&null!=o&&(o=o[t])}null!=o?null!=n?o[c]=n:delete o[c]:l.push(t.data("key"))}l.length&&t.alert({title:"Attributes Not Saved",message:"'"+l.join(", ")+"' could not be saved. Please contact the plugin-author!",type:"danger",timeout:5e3}),i.persistSettings(e,s.cfg,a,o)},load:function(t,o,a){a=a||function(){};const r=o.attr("data-socket-get");socket.emit(r||"admin.settings.get",{hash:t},(function(c,u){if(c)return a(c);$(o).find("select[multiple]").each((function(e,t){const n=$(t).attr("name");if(n&&u.hasOwnProperty(n))try{u[n]=JSON.parse(u[n])}catch(e){}})),ajaxify.data[r?t:"settings"]=u,i.whenReady((function(){$(o).find("[data-sorted-list]").each((function(e,n){l(n,"get").call(s,$(n),t)}))})),$(o).deserialize(u),$(o).find('input[type="checkbox"]').each((function(){$(this).parents(".mdl-switch").toggleClass("is-checked",$(this).is(":checked"))})),e.fire("action:admin.settingsLoaded"),$(o).on("change","input, select, textarea",(function(){app.flags=app.flags||{},app.flags._unsaved=!0}));const f=document.getElementById("save");f&&n.e(2441).then((function(){var e=[n(42441)];(function(e){e.bind("ctrl+s",(function(e){f.click(),e.preventDefault()}))}).apply(null,e)})).catch(n.oe),a(null,u)}))},save:function(e,n,o){if((n=$(n)).length){const a=i.serializeForm(n);i.whenReady((function(){const e=n.find("[data-sorted-list]");e.length&&e.each(((e,t)=>{l(t,"set").call(s,$(t),a)}))}));const r=n.attr("data-socket-set");socket.emit(r||"admin.settings.set",{hash:e,values:a},(function(n){app.flags._unsaved=!1,ajaxify.data[r?e:"settings"]=a,"function"==typeof o?o(n):n?t.alert({title:"[[admin/admin:changes-not-saved]]",message:`[[admin/admin:changes-not-saved-message, ${n.message}]]`,type:"error",timeout:2500}):t.alert({title:"[[admin/admin:changes-saved]]",type:"success",timeout:2500})}))}}},i.registerReadyJobs(1),Promise.all([n.e(6177),n.e(2526),n.e(6069)]).then((function(){var e=[n(16631),n(73143),n(7448),n(15101),n(846),n(88839),n(53411),n(66370)];(function(){for(let e=0;e<arguments.length;e+=1)s.registerPlugin(arguments[e]);i.beforeReadyJobsDecreased()}).apply(null,e)})).catch(n.oe),s}.apply(t,s))||(e.exports=i)},66603:(e,t,n)=>{var s;void 0===(s=function(){function e(){this._store={},this._keys=[]}let t;e.prototype.isMock=!0,e.prototype.setItem=function(e,t){e=String(e),-1===this._keys.indexOf(e)&&this._keys.push(e),this._store[e]=t},e.prototype.getItem=function(e){return e=String(e),-1===this._keys.indexOf(e)?null:this._store[e]},e.prototype.removeItem=function(e){e=String(e),this._keys=this._keys.filter((function(t){return t!==e})),this._store[e]=null},e.prototype.clear=function(){this._keys=[],this._store={}},e.prototype.key=function(e){return e=parseInt(e,10)||0,this._keys[e]},Object.defineProperty&&Object.defineProperty(e.prototype,"length",{get:function(){return this._keys.length}});const n=Date.now().toString();try{if(t=window.localStorage,t.setItem(n,n),t.getItem(n)!==n)throw Error("localStorage behaved unexpectedly");return t.removeItem(n),t}catch(s){console.warn(s),console.warn("localStorage failed, falling back on sessionStorage");try{if(t=window.sessionStorage,t.setItem(n,n),t.getItem(n)!==n)throw Error("sessionStorage behaved unexpectedly");return t.removeItem(n),t}catch(t){return console.warn(t),console.warn("sessionStorage failed, falling back on memory storage"),new e}}}.call(t,n,t,e))||(e.exports=s)}}]);