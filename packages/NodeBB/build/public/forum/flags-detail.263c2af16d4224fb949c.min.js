"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[6753],{45561:(e,t,a)=>{var s,n;s=[a(7237),a(32230),a(59006),a(59494),a(997),a(74344),a(31369),a(7927)],void 0===(n=function(e,t,s,n,o,r,i,c){const d={};function l(e,a,s){t.translate("[[topic:post_"+e+"_confirm]]",(function(e){i.confirm(e,(function(e){e&&a(s).then(ajaxify.refresh).catch(c.error)}))}))}return d.init=function(){$("#state").val(ajaxify.data.state).removeAttr("disabled"),$("#assignee").val(ajaxify.data.assignee).removeAttr("disabled"),$("#content > div").on("click","[data-action]",(function(){const e=this.getAttribute("data-action"),t=$(this).parents("[data-uid]").attr("data-uid"),s=document.getElementById("note");switch(e){case"assign":$("#assignee").val(app.user.uid);case"update":{const e=$("#attributes").serializeArray().reduce(((e,t)=>(e[t.name]=t.value,e)),{});r.put(`/flags/${ajaxify.data.flagId}`,e).then((e=>{c.success("[[flags:updated]]"),d.reloadHistory(e)})).catch(c.error);break}case"appendNote":r.post(`/flags/${ajaxify.data.flagId}/notes`,{note:s.value,datetime:parseInt(s.getAttribute("data-datetime"),10)}).then((e=>{c.success("[[flags:note-added]]"),d.reloadNotes(e.notes),d.reloadHistory(e.history),s.removeAttribute("data-datetime")})).catch(c.error);break;case"delete-note":{const e=parseInt(this.closest("[data-datetime]").getAttribute("data-datetime"),10);i.confirm("[[flags:delete-note-confirm]]",(function(t){t&&r.delete(`/flags/${ajaxify.data.flagId}/notes/${e}`,{}).then((e=>{c.success("[[flags:note-deleted]]"),d.reloadNotes(e.notes),d.reloadHistory(e.history)})).catch(c.error)}));break}case"chat":a.e(4337).then((function(){var e=[a(93216)];(function(e){e.newChat(t)}).apply(null,e)})).catch(a.oe);break;case"ban":n.banAccount(t,ajaxify.refresh);break;case"unban":n.unbanAccount(t);break;case"mute":n.muteAccount(t,ajaxify.refresh);break;case"unmute":n.unmuteAccount(t);break;case"delete-account":o.account(t,ajaxify.refresh);break;case"delete-content":o.content(t,ajaxify.refresh);break;case"delete-all":o.purge(t,ajaxify.refresh);break;case"delete-post":l("delete",r.del,`/posts/${ajaxify.data.target.pid}/state`);break;case"purge-post":l("purge",r.del,`/posts/${ajaxify.data.target.pid}`);break;case"restore-post":l("restore",r.put,`/posts/${ajaxify.data.target.pid}/state`);break;case"prepare-edit":{const e=this.closest("[data-index]"),t=e.getAttribute("data-index"),a=document.getElementById("note");a.value=ajaxify.data.notes[t].content,a.setAttribute("data-datetime",ajaxify.data.notes[t].datetime);const s=e.parentElement.children;for(const e in s)s.hasOwnProperty(e)&&s[e].classList.remove("editing");e.classList.add("editing"),a.focus();break}case"delete-flag":i.confirm("[[flags:delete-flag-confirm]]",(function(e){e&&r.delete(`/flags/${ajaxify.data.flagId}`,{}).then((()=>{c.success("[[flags:flag-deleted]]"),ajaxify.go("flags")})).catch(c.error)}))}}))},d.reloadNotes=function(t){ajaxify.data.notes=t,s.render("flags/detail",{notes:t},"notes").then((function(t){const a=e.get("flag/notes");a.empty(),a.html(t),a.find("span.timeago").timeago(),document.getElementById("note").value=""}))},d.reloadHistory=function(t){app.parseAndTranslate("flags/detail","history",{history:t},(function(t){const a=e.get("flag/history");a.empty(),a.html(t),a.find("span.timeago").timeago()}))},d}.apply(t,s))||(e.exports=n)}}]);