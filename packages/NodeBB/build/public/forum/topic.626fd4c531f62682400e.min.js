"use strict";(self.webpackChunknodebb=self.webpackChunknodebb||[]).push([[9285,4781,1375,8306],{64451:(t,o,e)=>{var n,i;n=[e(25142),e(60392),e(54939),e(91748),e(60447),e(42840),e(69241),e(7237),e(66603),e(85233),e(74344),e(7927)],void 0===(i=function(t,o,n,i,a,s,c,p,r,l,d,u){const f={};let g=0,m="";function h(){const t=p.get("navbar/title").find("span");$(window).scrollTop()>50&&t.hasClass("hidden")?t.html(ajaxify.data.title).removeClass("hidden"):$(window).scrollTop()<=50&&!t.hasClass("hidden")&&t.html("").addClass("hidden"),$(window).scrollTop()>300&&u.remove("bookmark")}return $(window).on("action:ajaxify.start",(function(t,o){i.removeListeners(),String(o.url).startsWith("topic/")||(s.disable(),p.get("navbar/title").find("span").text("").hide(),u.remove("bookmark"))})),f.init=function(){const k=!g||parseInt(g,10)!==parseInt(ajaxify.data.tid,10);g=ajaxify.data.tid,m=ajaxify.currentPage,l.fire("action:topic.loading"),app.enterRoom("topic_"+g),k&&(a.signaturesShown={}),a.onTopicPageLoad(p.get("post")),s.init('[component="post"]',ajaxify.data.postcount,f.toTop,f.toBottom,utils.debounce(f.navigatorCallback,500)),n.init(g),o.init(g,$(".topic")),i.init(),c.handleSort("topicPostSort","topic/"+ajaxify.data.slug),config.usePagination||t.init($('[component="topic"]'),a.loadMorePosts),p.get("topic").on("click","blockquote .toggle",(function(){const t=$(this).parent("blockquote"),o=$(this);t.toggleClass("uncollapsed");const e=!t.hasClass("uncollapsed");o.toggleClass("fa-angle-down",e).toggleClass("fa-angle-up",!e)})),p.get("topic").on("click",'[component="post/parent"]',(function(t){const o=$(this).attr("data-topid"),e=$('[component="topic"]>[component="post"][data-pid="'+o+'"]');if(e.length)return t.preventDefault(),s.scrollToIndex(e.attr("data-index"),!0),!1})),function(){const t=$("#content .dropdown-menu").parent();$(t).on("shown.bs.dropdown",(function(){this.querySelector(".dropdown-menu").innerHTML&&f.applyDropup.call(this)})),l.onPage("action:topic.tools.load",(({element:t})=>{f.applyDropup.call(t.get(0).parentNode)})),l.onPage("action:post.tools.load",(({element:t})=>{f.applyDropup.call(t.get(0).parentNode)}))}(),$('[component="topic"]').on("click",'[component="post/reply-count"]',(function(){const t=$(this);e.e(1352).then((function(){var o=[e(21352)];(function(o){o.init(t)}).apply(null,o)})).catch(e.oe)})),function(){if(!ajaxify.data.showPostPreviewsOnHover||utils.isMobile())return;let t=0;const o={};$(window).one("action:ajaxify.start",(function(){clearTimeout(t),$("#post-tooltip").remove()})),$('[component="topic"]').on("mouseenter",'[component="post"] a, [component="topic/event"] a',(async function(){const e=$(this);async function n(t){const n=o[t]||await socket.emit("posts.getPostSummaryByPid",{pid:t});if($("#post-tooltip").remove(),n&&ajaxify.data.template.topic){o[t]=n;const i=await app.parseAndTranslate("partials/topic/post-preview",{post:n});i.hide().find(".timeago").timeago(),i.appendTo($("body")).fadeIn(300);const a=e.parents('[component="topic"]').find('[component="post/content"]').first(),s=a.offset(),c=a.width(),p=e.offset();i.css({top:p.top+30,left:s.left,width:c})}}const i=e.attr("href"),a=utils.urlToLocation(i),s=a.pathname,c=i&&"#"!==i&&window.location.hostname===a.hostname;$("#post-tooltip").remove();const p=c&&s&&s.match(/\/post\/([\d]+)/),r=c&&s&&s.match(/\/topic\/([\d]+)/);if(p){const o=p[1];if(parseInt(e.parents('[component="post"]').attr("data-pid"),10)===parseInt(o,10))return;t=setTimeout((async()=>{n(o)}),300)}else r&&(t=setTimeout((async()=>{const t=r[1];n((await d.get("/topics/"+t,{})).mainPid)}),300))})).on("mouseleave",'[component="post"] a, [component="topic/event"] a',(function(){clearTimeout(t),$("#post-tooltip").remove()}))}(),function(t){if(window.location.hash){const t=$(utils.escapeHTML(window.location.hash));if(t.length)return s.scrollToElement(t,!0,0)}const o=ajaxify.data.bookmark||r.getItem("topic:"+t+":bookmark"),e=ajaxify.data.postIndex;e>1?p.get("post/anchor",e-1).length&&s.scrollToPostIndex(e-1,!0,0):o&&(!config.usePagination||config.usePagination&&1===ajaxify.data.pagination.currentPage)&&ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(u.alert({alert_id:"bookmark",message:"[[topic:bookmark_instructions]]",timeout:0,type:"info",clickfn:function(){s.scrollToIndex(parseInt(o,10),!0)},closefn:function(){r.removeItem("topic:"+t+":bookmark")}}),setTimeout((function(){u.remove("bookmark")}),1e4))}(g),$(window).on("scroll",utils.debounce(h,250)),config.topicSearchEnabled&&Promise.all([e.e(2441),e.e(7073)]).then((function(){var t=[e(42441),e(7073)];(function(t,o){t.bind(["command+f","ctrl+f"],(function(t){ajaxify.data.template.topic&&(t.preventDefault(),$("#search-fields input").val("in:topic-"+ajaxify.data.tid+" "),o.showAndFocusInput())}))}).apply(null,t)})).catch(e.oe),l.fire("action:topic.loaded",ajaxify.data)},f.toTop=function(){s.scrollTop(0)},f.toBottom=function(){socket.emit("topics.postcount",ajaxify.data.tid,(function(t,o){if(t)return u.error(t);s.scrollBottom(o-1)}))},f.applyDropup=function(){const t=this.getBoundingClientRect(),o=this.querySelector(".dropdown-menu"),e=window.getComputedStyle(o).getPropertyValue("height").slice(0,-2),n=document.documentElement.style.getPropertyValue("--panel-offset").slice(0,-2),i=t.top+t.height-e-n>0;this.classList.toggle("dropup",i)},f.navigatorCallback=function(t,o){if(!ajaxify.data.template.topic||s.scrollActive)return;const e="topic/"+ajaxify.data.slug+(t>1?"/"+t:"");if(e!==m&&(m=e,t>=o&&app.user.uid&&socket.emit("topics.markAsRead",[ajaxify.data.tid]),function(t){const o="topic:"+ajaxify.data.tid+":bookmark",e=ajaxify.data.bookmark||r.getItem(o);"newest_to_oldest"===config.topicPostSort&&(t=Math.max(1,ajaxify.data.postcount-t+2)),ajaxify.data.postcount>ajaxify.data.bookmarkThreshold&&(!e||parseInt(t,10)>parseInt(e,10)||ajaxify.data.postcount<parseInt(e,10))&&(app.user.uid?socket.emit("topics.bookmark",{tid:ajaxify.data.tid,index:t},(function(o){if(o)return u.error(o);ajaxify.data.bookmark=t+1})):r.setItem(o,t)),(!e||parseInt(t,10)>=parseInt(e,10))&&u.remove("bookmark")}(t),f.replaceURLTimeout=0,ajaxify.data.updateUrlWithPostIndex&&history.replaceState)){let t=window.location.search||"";config.usePagination||(t=t&&!/^\?page=\d+$/.test(t)?t:""),history.replaceState({url:e+t},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+e+t)}},f}.apply(o,n))||(t.exports=i)},91748:(t,o,e)=>{var n,i;n=[e(54939),e(60392),e(60447),e(47720),e(7237),e(32230),e(59006),e(85233)],void 0===(i=function(t,o,n,i,a,s,c,p){const r={},l={"event:user_status_change":function(t){app.updateUserStatus($('[data-uid="'+t.uid+'"] [component="user/status"]'),t.status)},"event:voted":function(t){const o=$('[data-pid="'+t.post.pid+'"] [component="post/vote-count"]').filter((function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)})),e=$('.reputation[data-uid="'+t.post.uid+'"]');o.html(t.post.votes).attr("data-votes",t.post.votes),e.html(t.user.reputation).attr("data-reputation",t.user.reputation)},"event:bookmarked":function(t){$('[data-pid="'+t.post.pid+'"] .bookmarkCount').filter((function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)})).html(t.post.bookmarks).attr("data-bookmarks",t.post.bookmarks)},"event:topic_deleted":o.setDeleteState,"event:topic_restored":o.setDeleteState,"event:topic_purged":function(t){ajaxify.data.category&&ajaxify.data.category.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("category/"+ajaxify.data.category.slug,null,!0)},"event:topic_locked":o.setLockedState,"event:topic_unlocked":o.setLockedState,"event:topic_pinned":o.setPinnedState,"event:topic_unpinned":o.setPinnedState,"event:topic_moved":function(t){t&&t.slug&&parseInt(t.tid,10)===parseInt(ajaxify.data.tid,10)&&ajaxify.go("topic/"+t.slug,null,!0)},"event:post_edited":function(o){if(!o||!o.post||parseInt(o.post.tid,10)!==parseInt(ajaxify.data.tid,10))return;const e=a.get("post/content",o.post.pid).filter((function(t,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)})),r=$('[data-pid="'+o.post.pid+'"] [component="post/editor"]').filter((function(t,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(o.post.pid,10)})),l=a.get("topic/title"),d=a.get("navbar/title").find("span"),u=a.get("breadcrumb/current");if(o.topic.rescheduled)return ajaxify.go("topic/"+o.topic.slug,null,!0);if(l.length&&o.topic.title&&o.topic.renamed){ajaxify.data.title=o.topic.title;const t="topic/"+o.topic.slug+(window.location.search?window.location.search:"");history.replaceState({url:t},null,window.location.protocol+"//"+window.location.host+config.relative_path+"/"+t),l.fadeOut(250,(function(){l.html(o.topic.title).fadeIn(250)})),u.fadeOut(250,(function(){u.html(o.topic.title).fadeIn(250)})),d.fadeOut(250,(function(){d.html(o.topic.title).fadeIn(250)}))}o.post.changed?e.fadeOut(250,(function(){e.html(s.unescape(o.post.content)),e.find("img:not(.not-responsive)").addClass("img-responsive"),i.wrapImagesInLinks(e.parent()),n.addBlockquoteEllipses(e.parent()),e.fadeIn(250);const t={editor:o.editor,editedISO:utils.toISOString(o.post.edited)};app.parseAndTranslate("partials/topic/post-editor",t,(function(t){r.replaceWith(t),$('[data-pid="'+o.post.pid+'"] [component="post/editor"] .timeago').timeago(),p.fire("action:posts.edited",o)}))})):p.fire("action:posts.edited",o),o.topic.tags&&o.topic.tagsupdated&&c.render("partials/topic/tags",{tags:o.topic.tags}).then((function(t){const o=$(".tags");o.fadeOut(250,(function(){o.html(t).fadeIn(250)}))})),t.removeMenu(a.get("post","pid",o.post.pid))},"event:post_purged":function(o){o&&parseInt(o.tid,10)===parseInt(ajaxify.data.tid,10)&&(a.get("post","pid",o.pid).fadeOut(500,(function(){$(this).remove(),n.showBottomPostBar()})),ajaxify.data.postcount-=1,t.updatePostCount(ajaxify.data.postcount),e.e(1352).then((function(){var t=[e(21352)];(function(t){t.onPostPurged(o)}).apply(null,t)})).catch(e.oe))},"event:post_deleted":d,"event:post_restored":d,"posts.bookmark":u,"posts.unbookmark":u,"posts.upvote":f,"posts.downvote":f,"posts.unvote":f,"event:new_notification":function(t){const o=ajaxify.data.tid;t&&t.tid&&parseInt(t.tid,10)===parseInt(o,10)&&socket.emit("topics.markTopicNotificationsRead",[o])},"event:new_post":n.onNewPost};function d(o){const e=a.get("post","pid",o.pid);if(!e.length)return;e.toggleClass("deleted");const n=e.hasClass("deleted");t.toggle(o.pid,n),ajaxify.data.privileges.isAdminOrMod||parseInt(o.uid,10)===parseInt(app.user.uid,10)||(e.find('[component="post/tools"]').toggleClass("hidden",n),n?e.find('[component="post/content"]').translateHtml("[[topic:post_is_deleted]]"):e.find('[component="post/content"]').html(s.unescape(o.content)))}function u(t){const o=$('[data-pid="'+t.post.pid+'"] [component="post/bookmark"]').filter((function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)}));o.length&&(o.attr("data-bookmarked",t.isBookmarked),o.find('[component="post/bookmark/on"]').toggleClass("hidden",!t.isBookmarked),o.find('[component="post/bookmark/off"]').toggleClass("hidden",t.isBookmarked))}function f(t){const o=$('[data-pid="'+t.post.pid+'"]');o.find('[component="post/upvote"]').filter((function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)})).toggleClass("upvoted",t.upvote),o.find('[component="post/downvote"]').filter((function(o,e){return parseInt($(e).closest("[data-pid]").attr("data-pid"),10)===parseInt(t.post.pid,10)})).toggleClass("downvoted",t.downvote)}return r.init=function(){r.removeListeners();for(const t in l)l.hasOwnProperty(t)&&socket.on(t,l[t])},r.removeListeners=function(){for(const t in l)l.hasOwnProperty(t)&&socket.removeListener(t,l[t])},r}.apply(o,n))||(t.exports=i)},60392:(t,o,e)=>{var n,i;n=[e(7237),e(32230),e(66044),e(60447),e(74344),e(85233),e(31369),e(7927)],void 0===(i=function(t,o,n,i,a,s,c,p){const r={};function l(t,o,e,n){n||(n=function(){});const i=ajaxify.data.tid,s={},l=function(e){e&&a[t](`/topics/${i}${o}`,s).then(n).catch(p.error)};switch(e){case"delete":case"restore":case"purge":c.confirm(`[[topic:thread_tools.${e}_confirm]]`,l);break;case"pin":r.requestPinExpiry(s,l.bind(null,!0));break;default:l(!0)}}return r.init=function(i,r){function d(e,n=1){return a[n?"put":"del"](`/topics/${i}/${e}`,{},(()=>{let a="";"follow"===e?a=n?"[[topic:following_topic.message]]":"[[topic:not_following_topic.message]]":"ignore"===e&&(a=n?"[[topic:ignoring_topic.message]]":"[[topic:not_following_topic.message]]"),n||(e="unfollow"),function(e){o.translate({follow:"[[topic:watching]]",unfollow:"[[topic:not-watching]]",ignore:"[[topic:ignoring]]"}[e],(function(t){$('[component="topic/watch"] button').attr("title",t).tooltip("fixTitle")}));let n=t.get("topic/following/menu");n.toggleClass("hidden","follow"!==e),t.get("topic/following/check").toggleClass("fa-check","follow"===e),n=t.get("topic/not-following/menu"),n.toggleClass("hidden","unfollow"!==e),t.get("topic/not-following/check").toggleClass("fa-check","unfollow"===e),n=t.get("topic/ignoring/menu"),n.toggleClass("hidden","ignore"!==e),t.get("topic/ignoring/check").toggleClass("fa-check","ignore"===e)}(e),p.alert({alert_id:"follow_thread",message:a,type:"success",timeout:5e3}),s.fire("action:topics.changeWatching",{tid:i,type:e})}),(()=>{p.alert({type:"danger",alert_id:"topic_follow",title:"[[global:please_log_in]]",message:"[[topic:login_to_subscribe]]",timeout:5e3})})),!1}r.on("show.bs.dropdown",".thread-tools",(function(){const t=$(this).find(".dropdown-menu");t.html()||(t.toggleClass("hidden",!0),socket.emit("topics.loadTopicTools",{tid:ajaxify.data.tid,cid:ajaxify.data.cid},(function(o,e){if(o)return p.error(o);app.parseAndTranslate("partials/topic/topic-menu-list",e,(function(o){t.html(o),t.toggleClass("hidden",!1),s.fire("action:topic.tools.load",{element:t})}))})))})),r.on("click",'[component="topic/delete"]',(function(){return l("del","/state","delete"),!1})),r.on("click",'[component="topic/restore"]',(function(){return l("put","/state","restore"),!1})),r.on("click",'[component="topic/purge"]',(function(){return l("del","","purge"),!1})),r.on("click",'[component="topic/lock"]',(function(){return l("put","/lock","lock"),!1})),r.on("click",'[component="topic/unlock"]',(function(){return l("del","/lock","unlock"),!1})),r.on("click",'[component="topic/pin"]',(function(){return l("put","/pin","pin"),!1})),r.on("click",'[component="topic/unpin"]',(function(){return l("del","/pin","unpin"),!1})),r.on("click",'[component="topic/event/delete"]',(function(){const t=$(this).attr("data-topic-event-id"),o=$(this).parents('[component="topic/event"]');c.confirm("[[topic:delete-event-confirm]]",(e=>{e&&a.del(`/topics/${i}/events/${t}`,{}).then((function(){o.remove()})).catch(p.error)}))})),r.on("click",'[component="topic/mark-unread"]',(function(){return socket.emit("topics.markUnread",i,(function(t){if(t)return p.error(t);app.previousUrl&&!app.previousUrl.match("^/topic")?ajaxify.go(app.previousUrl,(function(){n.onBackClicked(!0)})):ajaxify.data.category&&ajaxify.go("category/"+ajaxify.data.category.slug,n.onBackClicked),p.success("[[topic:mark_unread.success]]")})),!1})),r.on("click",'[component="topic/mark-unread-for-all"]',(function(){const t=$(this);return socket.emit("topics.markAsUnreadForAll",[i],(function(o){if(o)return p.error(o);p.success("[[topic:markAsUnreadForAll.success]]"),t.parents(".thread-tools.open").find(".dropdown-toggle").trigger("click")})),!1})),r.on("click",'[component="topic/move"]',(function(){return e.e(7378).then((function(){var t=[e(57378)];(function(t){t.init([i],ajaxify.data.cid)}).apply(null,t)})).catch(e.oe),!1})),r.on("click",'[component="topic/delete/posts"]',(function(){e.e(5253).then((function(){var t=[e(55253)];(function(t){t.init()}).apply(null,t)})).catch(e.oe)})),r.on("click",'[component="topic/fork"]',(function(){e.e(5636).then((function(){var t=[e(25636)];(function(t){t.init()}).apply(null,t)})).catch(e.oe)})),r.on("click",'[component="topic/move-posts"]',(function(){e.e(3094).then((function(){var t=[e(53094)];(function(t){t.init()}).apply(null,t)})).catch(e.oe)})),r.on("click",'[component="topic/following"]',(function(){d("follow")})),r.on("click",'[component="topic/not-following"]',(function(){d("follow",0)})),r.on("click",'[component="topic/ignoring"]',(function(){d("ignore")}))},r.requestPinExpiry=function(t,o){app.parseAndTranslate("modals/set-pin-expiry",{},(function(e){const n=c.dialog({title:"[[topic:thread_tools.pin]]",message:e,onEscape:!0,size:"small",buttons:{cancel:{label:"[[modules:bootbox.cancel]]",className:"btn-link"},save:{label:"[[global:save]]",className:"btn-primary",callback:function(){let e=n.get(0).querySelector("#expiry").value;if(""===e)return o();e=new Date(e),e&&e.getTime()>Date.now()?(t.expiry=e.getTime(),o()):p.error("[[error:invalid-date]]")}}}})}))},r.setLockedState=function(o){const e=t.get("topic");if(parseInt(o.tid,10)!==parseInt(e.attr("data-tid"),10))return;const n=o.isLocked&&!ajaxify.data.privileges.isAdminOrMod;t.get("topic/lock").toggleClass("hidden",o.isLocked).parent().attr("hidden",o.isLocked?"":null),t.get("topic/unlock").toggleClass("hidden",!o.isLocked).parent().attr("hidden",o.isLocked?null:"");const a=!(!o.isLocked&&!ajaxify.data.deleted||ajaxify.data.privileges.isAdminOrMod);t.get("topic/reply/container").toggleClass("hidden",a),t.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!o.isLocked||ajaxify.data.deleted),e.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",a),e.find('[component="post/edit"], [component="post/delete"]').toggleClass("hidden",n),e.find('[component="post"][data-uid="'+app.user.uid+'"].deleted [component="post/tools"]').toggleClass("hidden",n),$('[component="topic/labels"] [component="topic/locked"]').toggleClass("hidden",!o.isLocked),$('[component="post/tools"] .dropdown-menu').html(""),ajaxify.data.locked=o.isLocked,i.addTopicEvents(o.events)},r.setDeleteState=function(o){const e=t.get("topic");if(parseInt(o.tid,10)!==parseInt(e.attr("data-tid"),10))return;t.get("topic/delete").toggleClass("hidden",o.isDelete).parent().attr("hidden",o.isDelete?"":null),t.get("topic/restore").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),t.get("topic/purge").toggleClass("hidden",!o.isDelete).parent().attr("hidden",o.isDelete?null:""),t.get("topic/deleted/message").toggleClass("hidden",!o.isDelete),o.isDelete&&app.parseAndTranslate("partials/topic/deleted-message",{deleter:o.user,deleted:!0,deletedTimestampISO:utils.toISOString(Date.now())},(function(o){t.get("topic/deleted/message").replaceWith(o),o.find(".timeago").timeago()}));const n=o.isDelete&&!ajaxify.data.privileges.isAdminOrMod;t.get("topic/reply/container").toggleClass("hidden",n),t.get("topic/reply/locked").toggleClass("hidden",ajaxify.data.privileges.isAdminOrMod||!ajaxify.data.locked||o.isDelete),e.find('[component="post"]:not(.deleted) [component="post/reply"], [component="post"]:not(.deleted) [component="post/quote"]').toggleClass("hidden",n),e.toggleClass("deleted",o.isDelete),ajaxify.data.deleted=o.isDelete?1:0,i.addTopicEvents(o.events)},r.setPinnedState=function(o){const e=t.get("topic");if(parseInt(o.tid,10)!==parseInt(e.attr("data-tid"),10))return;t.get("topic/pin").toggleClass("hidden",o.pinned).parent().attr("hidden",o.pinned?"":null),t.get("topic/unpin").toggleClass("hidden",!o.pinned).parent().attr("hidden",o.pinned?null:"");const n=$('[component="topic/labels"] [component="topic/pinned"]');n.toggleClass("hidden",!o.pinned),o.pinned&&n.translateAttr("title",o.pinExpiry&&o.pinExpiryISO?"[[topic:pinned-with-expiry, "+o.pinExpiryISO+"]]":"[[topic:pinned]]"),ajaxify.data.pinned=o.pinned,i.addTopicEvents(o.events)},r}.apply(o,n))||(t.exports=i)},66044:(t,o,e)=>{var n,i;n=[e(7237),e(66603),e(42840),e(78989)],void 0===(i=function(t,o,e,n){const i={};let a;function s(t){const e=t&&ajaxify.data.template.unread;if(ajaxify.data.template.category||ajaxify.data.template.recent||ajaxify.data.template.popular||e){let t=o.getItem("category:bookmark"),e=o.getItem("category:bookmark:clicked");if(o.removeItem("category:bookmark"),o.removeItem("category:bookmark:clicked"),!utils.isNumber(t))return;if(t=Math.max(0,parseInt(t,10)||0),e=Math.max(0,parseInt(e,10)||0),config.usePagination){const o=Math.ceil((parseInt(t,10)+1)/config.topicsPerPage);parseInt(o,10)!==ajaxify.data.pagination.currentPage?n.loadPage(o,(function(){i.scrollToTopic(t,e)})):i.scrollToTopic(t,e)}else{if(0===t)return void i.scrollToTopic(t,e);$('[component="category"]').empty(),a(Math.max(0,t-1)+1,(function(){i.scrollToTopic(t,e)}))}}}return i.init=function(t){a=t,$('[component="category"]').on("click",'[component="topic/header"]',(function(){const t=$(this).parents("[data-index]").attr("data-index"),e=$(window).scrollTop();$('[component="category/topic"]').each((function(n,i){if($(i).offset().top-e>0)return o.setItem("category:bookmark",$(i).attr("data-index")),o.setItem("category:bookmark:clicked",t),o.setItem("category:bookmark:offset",$(i).offset().top-e),!1}))})),$(window).off("action:popstate",s).on("action:popstate",s)},i.onBackClicked=s,i.highlightTopic=function(o){const e=t.get("category/topic","index",o);e.length&&!e.hasClass("highlight")&&(e.addClass("highlight"),setTimeout((function(){e.removeClass("highlight")}),5e3))},i.scrollToTopic=function(n,a){if(!utils.isNumber(n))return;const s=t.get("category/topic","index",n);if(s.length){const t=o.getItem("category:bookmark:offset");o.removeItem("category:bookmark:offset"),$(window).scrollTop(s.offset().top-t),i.highlightTopic(a),e.update()}},i}.apply(o,n))||(t.exports=i)},69241:(t,o,e)=>{var n,i;n=[e(7237),e(74344)],void 0===(i=function(t,o){return{handleSort:function(e,n){const i=t.get("thread/sort");i.find("i").removeClass("fa-check"),i.find('a[data-sort="'+config[e]+'"]').find("i").addClass("fa-check"),$("body").off("click",'[component="thread/sort"] a').on("click",'[component="thread/sort"] a',(function(){function t(t,o){config[e]=t;const i=decodeURIComponent($.param(o));ajaxify.go(n+(i?"?"+i:""))}const i=$(this).attr("data-sort");if(app.user.uid){const n={settings:{}};n.settings[e]=i,o.put(`/users/${app.user.uid}/settings`,n).then((()=>{t(i,utils.params())}))}else{const o=utils.params();o.sort=i,t(i,o)}}))}}}.apply(o,n))||(t.exports=i)},66603:(t,o,e)=>{var n;void 0===(n=function(){function t(){this._store={},this._keys=[]}let o;t.prototype.isMock=!0,t.prototype.setItem=function(t,o){t=String(t),-1===this._keys.indexOf(t)&&this._keys.push(t),this._store[t]=o},t.prototype.getItem=function(t){return t=String(t),-1===this._keys.indexOf(t)?null:this._store[t]},t.prototype.removeItem=function(t){t=String(t),this._keys=this._keys.filter((function(o){return o!==t})),this._store[t]=null},t.prototype.clear=function(){this._keys=[],this._store={}},t.prototype.key=function(t){return t=parseInt(t,10)||0,this._keys[t]},Object.defineProperty&&Object.defineProperty(t.prototype,"length",{get:function(){return this._keys.length}});const e=Date.now().toString();try{if(o=window.localStorage,o.setItem(e,e),o.getItem(e)!==e)throw Error("localStorage behaved unexpectedly");return o.removeItem(e),o}catch(n){console.warn(n),console.warn("localStorage failed, falling back on sessionStorage");try{if(o=window.sessionStorage,o.setItem(e,e),o.getItem(e)!==e)throw Error("sessionStorage behaved unexpectedly");return o.removeItem(e),o}catch(o){return console.warn(o),console.warn("sessionStorage failed, falling back on memory storage"),new t}}}.call(o,e,o,t))||(t.exports=n)}}]);